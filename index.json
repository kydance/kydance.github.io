[{"categories":["VSCode","Vim","æ•ˆç‡","æœ€ä½³å®è·µ"],"content":" å¯¼è¯­ åœ¨ Visual Studio Code ä¸­å¼•å…¥ Vim æ¨¡å¼ï¼Œæ— ç–‘å¯ä»¥æå¤§ç¨‹åº¦ä¸Šæé«˜ä¸ªäººçš„ç¼–ç æ•ˆç‡ã€‚ ","date":"2024-08-25","objectID":"/posts/vscode-vim/:0:0","tags":["VSCode","Vim","æ•ˆç‡","æœ€ä½³å®è·µ"],"title":"ã€æœ€ä½³å®è·µã€‘VSCode + Vim = æ•ˆç‡ä¹‹ç¥","uri":"/posts/vscode-vim/"},{"categories":["VSCode","Vim","æ•ˆç‡","æœ€ä½³å®è·µ"],"content":"I. VSCodeVim VSCodeVim æ˜¯ä¸€æ¬¾ vim æ¨¡æ‹Ÿå™¨ï¼Œå®ƒå°† vim çš„å¤§éƒ¨åˆ†åŠŸèƒ½éƒ½é›†æˆåœ¨äº† VSCode ä¸­ï¼Œå³ä¸€ä¸ªåµŒå…¥åœ¨ VSCode ä¸­çš„ vimã€‚ æ­£æ˜¯ç”±äº VSCodeVim æœ¬è´¨ä¸Šåªæ˜¯ä¸€ä¸ª Vim æ¨¡æ‹Ÿå™¨ï¼Œè€ŒéçœŸæ­£çš„ Vimï¼Œå¯¼è‡´åŸç”Ÿ Vim ä¸­çš„æœ‰äº›åŠŸèƒ½å¹¶ä¸æ”¯æŒï¼Œå…·ä½“æ”¯æŒæƒ…å†µè§ roadmapã€‚ å°½ç®¡å®ƒç°åœ¨è¿˜æ— æ³•å®Œå…¨æ¨¡æ‹Ÿ Vimï¼Œä½†è¿™ä¾ç„¶ä¸å¦¨ç¢å®ƒçš„ä¼˜ç§€ã€‚ Status Command âœ… Normal Mode âœ… Insert Mode âœ… Visual Mode âœ… Visual Line Mode âœ… Number Prefixes âœ… . Operator âœ… Searching with / and ? âœ… Correct Undo/Redo âš  Command Remapping âš ï¸ Marks âœ… Text Objects âœ… Visual Block Mode âœ… Replace Mode âœ… Multiple Select Mode âš  Macros âš  Buffer/Window/Tab âœ… - command done âš ï¸ - some variations of the command are not supported ","date":"2024-08-25","objectID":"/posts/vscode-vim/:1:0","tags":["VSCode","Vim","æ•ˆç‡","æœ€ä½³å®è·µ"],"title":"ã€æœ€ä½³å®è·µã€‘VSCode + Vim = æ•ˆç‡ä¹‹ç¥","uri":"/posts/vscode-vim/"},{"categories":["VSCode","Vim","æ•ˆç‡","æœ€ä½³å®è·µ"],"content":"II. å®‰è£… åªéœ€åœ¨ VSCode çš„æ’ä»¶å•†åº—æœç´¢ vim å°±èƒ½æ‰¾åˆ°è¯¥æ’ä»¶. å…³é—­ Mac çš„é‡å¤é”® å½“ä½¿ç”¨ Mac æ—¶ï¼Œéœ€è¦è¾“å…¥ä»¥ä¸‹ä»£ç ï¼Œç”¨ä»¥å…³é—­ Mac çš„é‡å¤é”® # For VS Code $ defaults write com.microsoft.VSCode ApplePressAndHoldEnabled -bool false # For VS Codium $ defaults write com.vscodium ApplePressAndHoldEnabled -bool false # If necessary, reset global default $ defaults delete -g ApplePressAndHoldEnabled ","date":"2024-08-25","objectID":"/posts/vscode-vim/:2:0","tags":["VSCode","Vim","æ•ˆç‡","æœ€ä½³å®è·µ"],"title":"ã€æœ€ä½³å®è·µã€‘VSCode + Vim = æ•ˆç‡ä¹‹ç¥","uri":"/posts/vscode-vim/"},{"categories":["VSCode","Vim","æ•ˆç‡","æœ€ä½³å®è·µ"],"content":"III. æ–‡ä»¶é…ç½®è¯¦è§£ VSCodeVim çš„ç›¸å…³é…ç½®æ–‡ä»¶æ˜¯æ”¾åœ¨ settings.json ä¸­ï¼Œè€Œä¸æ˜¯ vimrc æ–‡ä»¶. å¯¹äºéä»£ç ç¼–è¾‘åŒºçš„çƒ­é”®å°†å…¶å®šä¹‰åœ¨ keybindings.json ä¸­ å¯¹äºä»£ç ç¼–è¾‘åŒºä¸”å±äº vim çš„çƒ­é”®å°†å…¶å®šä¹‰åœ¨ settings.json æ–‡ä»¶ä¸­ ä¸ªäººé…ç½®å‚è€ƒ ä¸ªäºº vscode é…ç½®æ–‡ä»¶å‚è€ƒï¼šhttps://github.com/kydance/dotfiles ","date":"2024-08-25","objectID":"/posts/vscode-vim/:3:0","tags":["VSCode","Vim","æ•ˆç‡","æœ€ä½³å®è·µ"],"title":"ã€æœ€ä½³å®è·µã€‘VSCode + Vim = æ•ˆç‡ä¹‹ç¥","uri":"/posts/vscode-vim/"},{"categories":["VSCode","Vim","æ•ˆç‡","æœ€ä½³å®è·µ"],"content":"1. åŸºç¡€é…ç½® // leader - prefix key \"vim.leader\": \"\u003cspace\u003e\", // To improve performance \"extensions.experimental.affinity\": { \"vscodevim.vim\": 1 }, // Easy motion \"vim.easymotion\": true, // Use system clipboard \"vim.useSystemClipboard\": true, // ç”±vimæ¥ç®¡ctrl+anyçš„æŒ‰é”®ï¼Œè€Œä¸æ˜¯vscode \"vim.useCtrlKeys\": true, \"vim.replaceWithRegister\": true, // å¿½ç•¥å¤§å°å†™ \"vim.ignorecase\": true, \"vim.smartcase\": true, // æ™ºèƒ½è¡Œå· \"vim.smartRelativeLine\": true, \"vim.foldfix\": true, // Highlight search \"vim.hlsearch\": true, \"vim.highlightedyank.enable\": true, \"vim.highlightedyank.duration\": 500, // ç”±vscodeè¿›è¡Œå¤„ç†ï¼Œè€Œä¸æ˜¯vscode-vimæ’ä»¶ \"vim.handleKeys\": { \"\u003cC-d\u003e\": true, // å‘ä¸‹æ»šåŠ¨åŠé¡µ \"\u003cC-f\u003e\": true, // å‘ä¸‹æ»šåŠ¨ä¸€é¡µ \"\u003cC-e\u003e\": true, // å‘ä¸‹æ»šåŠ¨ä¸€è¡Œ \"\u003cC-s\u003e\": true, \"\u003cC-z\u003e\": false, \"\u003cC-a\u003e\": true, \"\u003cC-c\u003e\": true, \"\u003cC-v\u003e\": true, \"\u003cC-x\u003e\": true, }, ","date":"2024-08-25","objectID":"/posts/vscode-vim/:3:1","tags":["VSCode","Vim","æ•ˆç‡","æœ€ä½³å®è·µ"],"title":"ã€æœ€ä½³å®è·µã€‘VSCode + Vim = æ•ˆç‡ä¹‹ç¥","uri":"/posts/vscode-vim/"},{"categories":["VSCode","Vim","æ•ˆç‡","æœ€ä½³å®è·µ"],"content":"2. å¿«æ·é”®é…ç½® NORMAL Mode \"vim.normalModeKeyBindingsNonRecursive\": [ { // èšé›† terminal \"before\": [\"\u003cC-j\u003e\"], \"commands\": [\"workbench.action.terminal.focus\"] }, { // è¯­ä¹‰çº§ é‡å‘½å \"before\": [\"leader\", \"r\"], \"commands\": [ \"editor.action.rename\"] }, { // \"before\": [\"g\", \"h\"], \"commands\": [ \"editor.action.showHover\"] }, { \"before\": [\"g\", \"d\"], \"commands\": [\"editor.action.revealDefinition\"] }, { \"before\": [\"g\", \"r\"], \"commands\": [\"editor.action.goToReferences\"], }, { \"before\": [\"g\", \"i\"], \"commands\": [\"editor.action.goToImplementation\"], }, { \"before\": [\"g\", \"b\"], \"commands\": [\"workbench.action.navigateBack\"], }, { \"before\": [\"leader\", \"e\", \"f\"], \"commands\": [\"workbench.explorer.fileView.focus\"], }, { \"before\": [ \"leader\", \"leader\", \"e\", \"f\"], \"commands\": [\"workbench.action.toggleActivityBarVisibility\"] }, { \"before\": [\"leader\", \"g\", \"g\"], \"commands\": [\"workbench.action.quickOpen\"], }, { // Global find \"before\": [\"leader\", \"g\", \"f\"], \"commands\": [\"workbench.view.search\"], }, { \"before\": [\"g\", \"[\",], \"commands\": [\"editor.action.marker.prevInFiles\"], }, { \"before\": [\"g\", \"]\",], \"commands\": [\"editor.action.marker.nextInFiles\"], }, { // Source Control Git \"before\": [ \"leader\", \"g\", \"i\", \"t\" ], \"commands\": [\"workbench.scm.focus\"] }, { // Start to debug \"before\": [ \"leader\", \"d\" ], \"commands\": [\"workbench.action.debug.start\"] }, { \"before\": [\"leader\",\"w\"], \"commands\": [\":w!\" ] }, { \"before\": [\"leader\",\"q\"], \"commands\": [\":q\" ] }, { // No highlight \"before\": [\"leader\", \"n\", \"h\"], \"commands\": [\":nohl\"] }, { \"before\": [\"H\"], \"after\": [\"^\"] }, { \"before\": [\"L\"], \"after\": [\"$\"] }, { // Blockwise visual mode \"before\": [\"\\\\\"], \"commands\": [\"extension.vim_ctrl+v\"] }, { \"before\": [\"leader\", \"t\"], \"commands\": [\":terminal\"] }, { \"before\": [\"g\", \"t\"], \"commands\": [\":tabnext\"] }, { \"before\": [\"g\", \"T\"], \"commands\": [\":tabprev\"] }, { // project-manager \"before\": [\"leader\", \"p\", \"m\"], \"commands\": [{ \"command\":\"workbench.view.extension.project-manager\", \"when\":\"viewContainer.workbench.view.extension.project-manager.enabled\" }] }, ], INSERT Mode \"vim.insertModeKeyBindings\": [ { \"before\": [\"j\", \"k\"], \"after\": [\"\u003cEsc\u003e\"] }, ], VISUAL Mode \"vim.visualModeKeyBindings\": [ { \"before\": [\"H\"], \"after\": [\"^\"] }, { \"before\": [\"L\"], \"after\": [\"$\"] }, { \"before\": [\"\u003e\"], \"commands\": [ \"editor.action.indentLines\"] }, { \"before\": [\"\u003c\"], \"commands\": [ \"editor.action.outdentLines\"] }, ], COMMAND LINE Mode \"vim.commandLineModeKeyBindingsNonRecursive\": [ ], `leader` é”®æ³¨æ„äº‹é¡¹ leader é”®åªåœ¨ä»£ç ç¼–è¾‘åŒºåŸŸç”Ÿæ•ˆï¼Œå®ƒæ— æ³•åšåˆ°å…¨ VSCode ç”Ÿæ•ˆ ","date":"2024-08-25","objectID":"/posts/vscode-vim/:3:2","tags":["VSCode","Vim","æ•ˆç‡","æœ€ä½³å®è·µ"],"title":"ã€æœ€ä½³å®è·µã€‘VSCode + Vim = æ•ˆç‡ä¹‹ç¥","uri":"/posts/vscode-vim/"},{"categories":["VSCode","Vim","æ•ˆç‡","æœ€ä½³å®è·µ"],"content":"3. èµ„æºç®¡ç†é…ç½® keybindings.json å®šä¹‰å¯¹äºéä»£ç ç¼–è¾‘åŒºçš„çƒ­é”®. [ { \"key\": \"cmd+h\", \"command\": \"workbench.action.focusLeftGroup\" }, { \"key\": \"cmd+l\", \"command\": \"workbench.action.focusRightGroup\" }, { // Rename file \"key\": \"r\", \"command\": \"renameFile\", \"when\": \"explorerViewletVisible \u0026\u0026 filesExplorerFocus \u0026\u0026 !explorerResourceIsRoot \u0026\u0026 !explorerResourceReadonly \u0026\u0026 !inputFocus\" }, { // New file \"key\": \"a\", \"command\": \"explorer.newFile\", \"when\": \"explorerViewletVisible \u0026\u0026 filesExplorerFocus \u0026\u0026 !explorerResourceIsRoot \u0026\u0026 !explorerResourceReadonly \u0026\u0026 !inputFocus\" }, { // New folder \"key\": \"shift+a\", \"command\": \"explorer.newFolder\", \"when\": \"explorerViewletVisible \u0026\u0026 filesExplorerFocus \u0026\u0026 !explorerResourceIsRoot \u0026\u0026 !explorerResourceReadonly \u0026\u0026 !inputFocus\" }, { // Delete file \"key\": \"d\", \"command\": \"deleteFile\", \"when\": \"explorerViewletVisible \u0026\u0026 filesExplorerFocus \u0026\u0026 !explorerResourceIsRoot \u0026\u0026 !explorerResourceReadonly \u0026\u0026 !inputFocus\" }, { // Copy \"key\": \"y\", \"command\": \"filesExplorer.copy\", \"when\": \"explorerViewletVisible \u0026\u0026 filesExplorerFocus \u0026\u0026 !explorerResourceIsRoot \u0026\u0026 !explorerResourceReadonly \u0026\u0026 !inputFocus\" }, { // Cut \"key\": \"x\", \"command\": \"filesExplorer.cut\", \"when\": \"explorerViewletVisible \u0026\u0026 filesExplorerFocus \u0026\u0026 !explorerResourceIsRoot \u0026\u0026 !explorerResourceReadonly \u0026\u0026 !inputFocus\" }, { // Paste \"key\": \"p\", \"command\": \"filesExplorer.paste\", \"when\": \"explorerViewletVisible \u0026\u0026 filesExplorerFocus \u0026\u0026 !explorerResourceIsRoot \u0026\u0026 !explorerResourceReadonly \u0026\u0026 !inputFocus\" }, { // å…¨å±€æœç´¢åï¼Œåœ¨è¾“å…¥æ¡†æŒ‰å›è½¦ï¼Œå³å¯èšç„¦åˆ°æœç´¢ç»“æœåˆ—è¡¨ \"key\": \"enter\", \"command\": \"search.action.focusSearchList\", \"when\": \"inSearchEditor \u0026\u0026 inputBoxFocus \u0026\u0026 hasSearchResult || inputBoxFocus \u0026\u0026 searchViewletVisible \u0026\u0026 hasSearchResult\" }, { // åœ¨æœç´¢ç»“æœåˆ—è¡¨ï¼Œåªéœ€æŒ‰ escï¼Œå°±å¯å›åˆ°æœç´¢è¾“å…¥æ¡† \"key\": \"escape\", \"command\": \"workbench.action.findInFiles\", \"when\": \"searchViewletVisible \u0026\u0026 hasSearchResult \u0026\u0026 searchViewletFocus\" }, { // åœ¨æœç´¢è¾“å…¥æ¡†ï¼Œåªéœ€æŒ‰ escï¼Œå°±å¯å›åˆ°ç¼–è¾‘å™¨ \"key\": \"escape\", \"command\": \"workbench.action.focusFirstEditorGroup\", \"when\": \"inSearchEditor \u0026\u0026 inputBoxFocus|| inputBoxFocus \u0026\u0026 searchViewletVisible\" }, { // åœ¨æ–‡ä»¶æµè§ˆç•Œé¢ï¼Œåªéœ€æŒ‰ escï¼Œå°±å¯å›åˆ°ç¼–è¾‘å™¨ \"key\": \"escape\", \"command\": \"workbench.action.focusFirstEditorGroup\", \"when\": \"explorerViewletVisible \u0026\u0026 filesExplorerFocus \u0026\u0026 !inputFocus\" }, { \"key\": \"tab\", \"command\": \"acceptSelectedSuggestion\", \"when\": \"suggestWidgetVisible \u0026\u0026 textInputFocus\" }, { // Next Suggestion \"key\": \"tab\", \"command\": \"selectNextSuggestion\", \"when\": \"editorTextFocus \u0026\u0026 suggestWidgetMultipleSuggestions \u0026\u0026 suggestWidgetVisible\" }, { // Prev Suggestion \"key\": \"shift+tab\", \"command\": \"selectPrevSuggestion\", \"when\": \"editorTextFocus \u0026\u0026 suggestWidgetMultipleSuggestions \u0026\u0026 suggestWidgetVisible\" }, { \"key\": \"cmd+k\", \"command\": \"workbench.action.focusActiveEditorGroup\", \"when\": \"terminalFocus\" } ] ","date":"2024-08-25","objectID":"/posts/vscode-vim/:3:3","tags":["VSCode","Vim","æ•ˆç‡","æœ€ä½³å®è·µ"],"title":"ã€æœ€ä½³å®è·µã€‘VSCode + Vim = æ•ˆç‡ä¹‹ç¥","uri":"/posts/vscode-vim/"},{"categories":["VSCode","Vim","æ•ˆç‡","æœ€ä½³å®è·µ"],"content":"Reference Visual Studio Code VSCodeVim ","date":"2024-08-25","objectID":"/posts/vscode-vim/:4:0","tags":["VSCode","Vim","æ•ˆç‡","æœ€ä½³å®è·µ"],"title":"ã€æœ€ä½³å®è·µã€‘VSCode + Vim = æ•ˆç‡ä¹‹ç¥","uri":"/posts/vscode-vim/"},{"categories":["Golang","effective go"],"content":" å¯¼è¯­ å¦‚ä½•ç¼–å†™æ¸…æ™°ã€åœ°é“çš„ Go ä»£ç  ","date":"2024-08-15","objectID":"/posts/effective-go/:0:0","tags":["Golang","effective go"],"title":"Effective Go","uri":"/posts/effective-go/"},{"categories":["Golang","effective go"],"content":"Formatting æ ¼å¼åŒ– åœ¨ Golang ä¸­ï¼Œgofmt ä»¥åŒ…æœªå¤„ç†å¯¹è±¡è€Œéæºæ–‡ä»¶ï¼Œå®ƒå°† Go ç¨‹åºæŒ‰ç…§æ ‡å‡†é£æ ¼ç¼©è¿›ã€å¯¹é½ï¼Œä¿ç•™æ³¨é‡Šå¹¶åœ¨éœ€è¦æ—¶é‡æ–°æ ¼å¼åŒ–ã€‚ Indentation ç¼©è¿›ï¼šä½¿ç”¨ åˆ¶è¡¨ç¬¦ Tab ç¼©è¿›ï¼Œgofmt é»˜è®¤ä½¿ç”¨ Line length è¡Œé•¿åº¦ï¼šGo å¯¹è¡Œçš„é•¿åº¦æ²¡æœ‰é™åˆ¶ Parentheses æ‹¬å·ï¼šæ§åˆ¶ç»“æ„ï¼ˆif, for, switchï¼‰åœ¨è¯­æ³•ä¸Šå¹¶ä¸éœ€è¦åœ†æ‹¬å· ","date":"2024-08-15","objectID":"/posts/effective-go/:1:0","tags":["Golang","effective go"],"title":"Effective Go","uri":"/posts/effective-go/"},{"categories":["Golang","effective go"],"content":"Commentary æ³¨é‡Š Go æ”¯æŒ C é£æ ¼çš„å—æ³¨é‡Š /* */ å’Œ C++ é£æ ¼çš„å•è¡Œæ³¨é‡Š //ï¼Œå…¶ä¸­ï¼Œ// æ³¨é‡Šæ›´å¸¸ç”¨ï¼Œè€Œ /* */ åˆ™ä¸»è¦ç”¨äºåŒ…çš„æ³¨é‡Š godoc å³ä½¿ä¸€ä¸ªç¨‹åºï¼Œåˆæ˜¯ä¸€ä¸ª Web æœåŠ¡å™¨ï¼Œå®ƒå¯¹ Go çš„æºç è¿›è¡Œå¤„ç†ï¼Œå¹¶æå–åŒ…ä¸­çš„æ–‡æ¡£å†…å®¹ï¼š å‡ºç°åœ¨é¡¶çº§å£°æ˜ä¹‹å‰ï¼Œä¸”ä¸è¯¥å£°æ˜ä¹‹é—´æ²¡æœ‰ç©ºè¡Œçš„æ³¨é‡Šï¼Œå°†ä¸è¯¥å£°æ˜ä¸€èµ·è¢«æå‡ºæ¥ï¼Œä½œä¸ºè¯¥æ¡ç›®çš„è¯´æ˜æ–‡æ¡£ã€‚ æ¯ä¸ªåŒ…éƒ½åº”åŒ…å«ä¸€æ®µåŒ…æ³¨é‡Šï¼Œå³æ”¾ç½®åœ¨åŒ…å­å¥å‰çš„ä¸€ä¸ªå—æ³¨é‡Šã€‚ å¯¹äºåŒ…å«å¤šä¸ªæ–‡ä»¶çš„åŒ…ï¼ŒåŒ…æ³¨é‡Šåªéœ€å‡ºç°åœ¨å…¶ä¸­çš„ä»»ä¸€æ–‡ä»¶ä¸­å³å¯ã€‚ åŒ…æ³¨é‡Šåº”åœ¨æ•´ä½“ä¸Šå¯¹è¯¥åŒ…è¿›è¡Œä»‹ç»ï¼Œå¹¶æä¾›åŒ…çš„ç›¸å…³ä¿¡æ¯ã€‚ å®ƒå°†å‡ºç°åœ¨ godoc é¡µé¢ä¸­çš„æœ€ä¸Šé¢ï¼Œå¹¶ä¸ºç´§éšå…¶åçš„å†…å®¹å»ºç«‹è¯¦ç»†çš„æ–‡æ¡£ã€‚ /* Package regex implements a simple library for regular expressions. The syntax of the regular expressions accepted is: regexp: concatenation { '|' concatenation } concatenation: { closure } closure: term [ '*' | '+' | '?' ] term: '^' '$' '.' character '[' [ '^' ] character-range ']' '(' regexp ')' */ package regex ","date":"2024-08-15","objectID":"/posts/effective-go/:2:0","tags":["Golang","effective go"],"title":"Effective Go","uri":"/posts/effective-go/"},{"categories":["Golang","effective go"],"content":"Names å‘½å ","date":"2024-08-15","objectID":"/posts/effective-go/:3:0","tags":["Golang","effective go"],"title":"Effective Go","uri":"/posts/effective-go/"},{"categories":["Golang","effective go"],"content":"Package names åŒ…å å½“ä¸€ä¸ªåŒ…è¢«å¯¼å…¥åï¼ŒåŒ…åå°±ä¼šæˆä¸ºå†…å®¹çš„è®¿é—®å™¨ import \"bytes\"ï¼ŒæŒ‰ç…§æƒ¯ä¾‹ï¼ŒåŒ…åº”å½“ä»¥æŸä¸ªå°å†™çš„å•ä¸ªå•è¯å‘½åï¼Œä¸”ä¸åº”ä½¿ç”¨ä¸‹åˆ’çº¿æˆ–é©¼å³°è®°æ³•ã€‚ ä¾‹å¦‚ï¼Œerr çš„å‘½åå°±æ˜¯å‡ºäºç®€çŸ­è€ƒè™‘ã€‚ åŒ…åæ˜¯å¯¼å…¥æ—¶æ‰€éœ€çš„å”¯ä¸€é»˜è®¤åç§°ï¼Œå®ƒå¹¶ä¸éœ€è¦åœ¨æ‰€æœ‰æºç ä¸­ä¿æŒå”¯ä¸€ï¼Œå³ä¾¿åœ¨å°‘æ•°å‘ç”Ÿå†²çªçš„æƒ…å†µä¸‹ï¼Œä¹Ÿå¯ä¸ºå¯¼å…¥çš„åŒ…é€‰æ‹©ä¸€ä¸ªåˆ«åæ¥å±€éƒ¨ä½¿ç”¨ã€‚ å¦ä¸€ä¸ªçº¦å®šï¼šåŒ…ååº”ä¸ºå…¶æºç ç›®å½•çš„åŸºæœ¬åç§°ã€‚ä¾‹å¦‚ï¼Œsrc/pkg/encoding/base64 ä¸­çš„åŒ…åº”ä½œä¸º encoding/basee64 å¯¼å…¥ï¼Œå…¶åŒ…ååº”ä¸º base64 è€Œä¸æ˜¯ encoding_base64 / encodingBase64. é•¿å‘½åå¹¶ä¸ä¼šä½¿åŒ…æ›´å…·æœ‰å¯è¯»æ€§ï¼Œåè€Œä¸€ä»½æœ‰ç”¨çš„è¯´æ˜æ–‡æ¡£é€šå¸¸æ¯”é¢å¤–çš„é•¿åæ›´å…·ä»·å€¼ã€‚ ","date":"2024-08-15","objectID":"/posts/effective-go/:3:1","tags":["Golang","effective go"],"title":"Effective Go","uri":"/posts/effective-go/"},{"categories":["Golang","effective go"],"content":"Getter / Setter Go å¹¶ä¸å¯¹ getter å’Œ setter æä¾›è‡ªåŠ¨æ”¯æŒã€‚ å¦‚å°† Get æ”¾å…¥ getter çš„åå­—ä¸­ï¼Œæ—¢ä¸ç¬¦åˆä¹ æƒ¯ï¼Œä¹Ÿæ²¡æœ‰å¿…è¦ï¼Œä½†å¤§å†™å­—æ¯ä½œä¸ºå­—æ®µå¯¼å‡ºçš„ getter æ˜¯ä¸€ä¸ªä¸é”™çš„é€‰æ‹©ï¼Œå¦å¤– Set æ”¾å…¥ setter æ˜¯ä¸ªä¸é”™çš„é€‰æ‹©ã€‚ type Object struct { ower string } func (o *Object) Ower() string { return o.ower } func (o *Object) SetOwer(s string) { o.ower = s } ","date":"2024-08-15","objectID":"/posts/effective-go/:3:2","tags":["Golang","effective go"],"title":"Effective Go","uri":"/posts/effective-go/"},{"categories":["Golang","effective go"],"content":"Interface names æ¥å£å æŒ‰ç…§è§„å®šï¼ŒåªåŒ…å«ä¸€ä¸ªæ–¹æ³•çš„æ¥å£åº”å½“ä»¥è¯¥æ–¹æ³•çš„åç§°åŠ ä¸Š er åç¼€æ¥å‘½åï¼Œå¦‚ Reader / Writer / Formater ç­‰ã€‚ å­—ç¬¦ä¸²è½¬æ¢æ–¹æ³•å‘½ååº”ä¸º String è€Œé ToString ","date":"2024-08-15","objectID":"/posts/effective-go/:3:3","tags":["Golang","effective go"],"title":"Effective Go","uri":"/posts/effective-go/"},{"categories":["Golang","effective go"],"content":"MixedCaps é©¼å³°è®°æ³• Go ä¸­çº¦å®šä½¿ç”¨é©¼å³°è®°æ³• ","date":"2024-08-15","objectID":"/posts/effective-go/:3:4","tags":["Golang","effective go"],"title":"Effective Go","uri":"/posts/effective-go/"},{"categories":["Golang","effective go"],"content":"åˆ†å· å’Œ C ä¸€æ ·ï¼ŒGo çš„æ­£å¼è¯­æ³•ä½¿ç”¨åˆ†å· ; æ¥ç»“æŸè¯­å¥ï¼Œä½† Go çš„åˆ†å·ä¸ä¸€å®šå‡ºç°åœ¨æºç ä¸­ï¼Œè€Œæ˜¯è¯æ³•åˆ†æå™¨ä¼šä½¿ç”¨ä¸€æ¡ç®€å•çš„è§„åˆ™æ¥è‡ªåŠ¨æ’å…¥åˆ†å· è§„åˆ™ï¼šå¦‚åœ¨æ–°è¡Œå‰çš„æœ€åä¸€ä¸ªæ ‡è®°ä¸ºæ ‡è¯†ç¬¦ï¼ˆint/float64ç­‰ï¼‰ã€æ•°å€¼æˆ–å­—ç¬¦ä¸²å¸¸é‡ä¹‹ç±»çš„åŸºæœ¬å­—é¢æˆ–breakã€continueã€fallthroughã€returnã€++ã€--ã€)ã€} ä¹‹ä¸€ï¼Œåˆ™è¯æ³•åˆ†æå™¨å°†å§‹ç»ˆåœ¨è¯¥æ ‡è®°åé¢æ’å…¥åˆ†å·ï¼Œå³å¦‚æœæ–°è¡Œå‰çš„æ ‡è®°ä¸ºè¯­å¥çš„æœ«å°¾ï¼Œåˆ™æ’å…¥åˆ†å·;ã€‚ é€šå¸¸ï¼ŒGo ç¨‹åºåªåœ¨è¯¸å¦‚ for å¾ªç¯å­å¥è¿™æ ·çš„åœ°æ–¹ä½¿ç”¨åˆ†å·ï¼Œæ¥ä»¥æ­¤å°†åˆå§‹åŒ–å™¨ã€æ¡ä»¶åŠå¢é‡å…ƒç´ åˆ†å¼€ï¼› ","date":"2024-08-15","objectID":"/posts/effective-go/:4:0","tags":["Golang","effective go"],"title":"Effective Go","uri":"/posts/effective-go/"},{"categories":["Golang","effective go"],"content":"Control structures æ§åˆ¶ç»“æ„ Go ä¸å†ä½¿ç”¨ do / while å¾ªç¯ï¼Œåªæœ‰ä¸€ä¸ªæ›´ä¸ºé€šç”¨çš„ forï¼Œ // C: for for init; condition; post { } // C: while for condition { } // C: for(;;) for { } // [12]aT, []vT, map[sting]any mT for key, value := range aT/vT/mT { } for key := range aT/vT/mT { } for _, value := range aT/vT/mT { } Go æ²¡æœ‰é€—å·æ“ä½œç¬¦ï¼Œä¸” ++/-- æ˜¯è¯­å¥è€Œéè¡¨è¾¾å¼ for i, j := 0, len(aT) - 1; i \u003c j; i, j = i + 1, j - 1 { // Not: i++, j-- a[i], a[j] = a[j], a[i] } switch æ›´åŠ çµæ´»ï¼Œå…¶è¡¨è¾¾å¼æ— éœ€ä¸ºå¸¸é‡æˆ–æ•´æ•°ï¼Œcase è¯­å¥ä¼šè‡ªä¸Šè€Œä¸‹é€ä¸€è¿›è¡Œæ±‚å€¼ç›´è‡³åŒ¹é…ä¸ºæ­¢ï¼Œå®ƒä¸ä¼šè‡ªåŠ¨ä¸‹æº¯ï¼Œä½† case å¯é€šè¿‡é€—å·åˆ†éš”æ¥åˆ—ä¸¾ç›¸åŒçš„å¤„ç†æ¡ä»¶ break è¯­å¥ä¼šä½¿ switch æå‰ç»ˆæ­¢ func unhex(c byte) byte { switch { case '0' \u003c= c \u0026\u0026 c \u003c= '9': return c - '0' case 'a' \u003c= c \u0026\u0026 c \u003c= 'f': return c - 'a' + 10 case 'A' \u003c= c \u0026\u0026 c \u003c= 'F': return c - 'A' + 10 } return 0 } func shouldEscape(c byte) bool { switch c { case ' ', '?', '\u0026', '=', '#', '+', '%': return true } return false } if å¼ºåˆ¶ä½¿ç”¨å¤§æ‹¬å·ï¼Œå¹¶ä¸”æ¥å—åˆå§‹åŒ–è¯­å¥ if err := file.Chmod(0664); err != nil { return err } ","date":"2024-08-15","objectID":"/posts/effective-go/:5:0","tags":["Golang","effective go"],"title":"Effective Go","uri":"/posts/effective-go/"},{"categories":["Golang","effective go"],"content":"Function å‡½æ•° Go ä¸ä¼—ä¸åŒçš„ç‰¹æ€§ä¹‹ä¸€ï¼Œå°±æ˜¯å‡½æ•°å’Œæ–¹æ³•å¯ä»¥è¿”å›å¤šä¸ªå€¼ï¼Œè¿”å›å€¼æˆ–ç»“æœâ€œå½¢å‚â€å¯è¢«å‘½åï¼Œå¹¶ä½œå¸¸è§„å˜é‡ä½¿ç”¨ã€‚ Go çš„ defer è¯­å¥ç”¨äºé¢„è®¾ä¸€ä¸ªå‡½æ•°è°ƒç”¨ï¼ˆå³å»¶è¿Ÿæ‰§è¡Œå‡½æ•°ï¼‰ï¼Œè¯¥å‡½æ•°ä¼šåœ¨æ‰§è¡Œ defer çš„å‡½æ•°è¿”å›ä¹‹å‰ç«‹å³æ‰§è¡Œã€‚ è¢«æ¨è¿Ÿçš„å¤šä¸ªå‡½æ•°ï¼Œä¼šæŒ‰ç…§åè¿›å…ˆå‡ºï¼ˆLIFOï¼‰çš„é¡ºåºæ‰§è¡Œã€‚ func Contents(filename string) (string, error) { f, err := os.Open(filename) if err != nil { return \"\", err } defer f.Close() var result []byte buf := make([]byte, 100) for { n, err := f.Read(buf[0:]) result = append(result, buf[0:n]...) if err != nil { if err == io.EOF { break } return \"\", err } } return string(result), nil } ","date":"2024-08-15","objectID":"/posts/effective-go/:6:0","tags":["Golang","effective go"],"title":"Effective Go","uri":"/posts/effective-go/"},{"categories":["Golang","effective go"],"content":"Data æ•°æ® new(T) ä¼šä¸ºç±»å‹ä¸º T çš„æ–°é¡¹åˆ†é…å·²ç½®é›¶çš„å†…å­˜ç©ºé—´ï¼Œ å¹¶è¿”å›å®ƒçš„åœ°å€ï¼Œä¹Ÿå°±æ˜¯ä¸€ä¸ªç±»å‹ä¸º *T çš„å€¼(è¿”å›ä¸€ä¸ªæŒ‡é’ˆï¼Œ è¯¥æŒ‡é’ˆæŒ‡å‘æ–°åˆ†é…çš„ï¼Œç±»å‹ä¸º T çš„é›¶å€¼)ã€‚ å†…å»ºå‡½æ•° make(T, args) çš„ç›®çš„ä¸åŒäº new(T)ã€‚å®ƒåªç”¨äºåˆ›å»ºåˆ‡ç‰‡ã€æ˜ å°„å’Œä¿¡é“ï¼Œå¹¶è¿”å›ç±»å‹ä¸º Tï¼ˆè€Œé *T ï¼‰çš„ä¸€ä¸ªå·²åˆå§‹åŒ– ï¼ˆè€Œéç½®é›¶ï¼‰çš„å€¼ã€‚ å‡ºç°è¿™ç§ç”¨å·®å¼‚çš„åŸå› åœ¨äºï¼Œè¿™ä¸‰ç§ç±»å‹æœ¬è´¨ä¸Šä¸ºå¼•ç”¨æ•°æ®ç±»å‹ï¼Œå®ƒä»¬åœ¨ä½¿ç”¨å‰å¿…é¡»åˆå§‹åŒ–ã€‚ // Allocates slice structure; *p == nil; rarely useful var p *[]int = new([]int) // The slice v now refers to a new array of 100 ints var v []int = make([]int, 100) // æƒ¯ç”¨æ³• v := make([]int, 100) ","date":"2024-08-15","objectID":"/posts/effective-go/:7:0","tags":["Golang","effective go"],"title":"Effective Go","uri":"/posts/effective-go/"},{"categories":["Golang","effective go"],"content":"Array æ•°ç»„ æ•°ç»„ä¸»è¦ç”¨ä½œåˆ‡ç‰‡çš„æ„ä»¶ï¼Œä¸»è¦ç‰¹ç‚¹ï¼š æ•°ç»„æ˜¯å€¼ï¼Œè®²ä¸€ä¸ªæ•°ç»„èµ‹å€¼ç»™å¦ä¸€ä¸ªæ•°ç»„ä¼šå¤åˆ¶å…¶æ‰€æœ‰å…ƒç´  å¦‚å°†æ•°ç»„ä½œä¸ºå‚æ•°ä¼ å…¥æŸä¸ªå‡½æ•°ï¼Œåˆ™ä¼šæ”¶åˆ°è¯¥æ•°ç»„çš„ä¸€ä»½å‰¯æœ¬è€ŒéæŒ‡é’ˆ æ•°ç»„çš„å¤§å°æ˜¯å…¶ç±»å‹çš„ä¸€éƒ¨åˆ† func Sum(a *[3]float64) (sum float64) { for _, v := range *a { sum += v } return } aV := [...]float64{1, 2, 0.7} fmt.Println(Sum(\u0026aV)) ","date":"2024-08-15","objectID":"/posts/effective-go/:7:1","tags":["Golang","effective go"],"title":"Effective Go","uri":"/posts/effective-go/"},{"categories":["Golang","effective go"],"content":"Slice åˆ‡ç‰‡ åˆ‡ç‰‡é€šè¿‡å¯¹æ•°ç»„è¿›è¡Œå°è£…ï¼Œä¸ºæ•°æ®åºåˆ—æä¾›äº†æ›´é€šç”¨ã€å¼ºå¤§è€Œæ–¹ä¾¿çš„æ¥å£ã€‚ slice ä¿å­˜äº†å¯¹åº•å±‚æ•°ç»„çš„å¼•ç”¨ï¼Œå¦‚å°†æŸä¸ª slice èµ‹å€¼ç»™å¦ä¸€ä¸ª sliceï¼Œåˆ™ä»–ä»¬ä¼šå¼•ç”¨åŒä¸€ä¸ªæ•°ç»„ã€‚ è‹¥æŸä¸ªå‡½æ•°å°†ä¸€ä¸ªåˆ‡ç‰‡ä½œä¸ºå‚æ•°ä¼ å…¥ï¼Œåˆ™å®ƒå¯¹è¯¥åˆ‡ç‰‡å…ƒç´ çš„ä¿®æ”¹å¯¹è°ƒç”¨è€…è€Œè¨€åŒæ ·å¯è§ï¼Œ è¿™å¯ä»¥ç†è§£ä¸ºä¼ é€’äº†åº•å±‚æ•°ç»„çš„æŒ‡é’ˆ åªè¦åˆ‡ç‰‡ä¸è¶…å‡ºåº•å±‚æ•°ç»„çš„é™åˆ¶ï¼Œå®ƒçš„é•¿åº¦å°±æ˜¯å¯å˜çš„ï¼Œåªéœ€å°†å®ƒèµ‹äºˆå…¶è‡ªèº«çš„åˆ‡ç‰‡å³å¯ã€‚åˆ‡ç‰‡çš„å®¹é‡å¯é€šè¿‡å†…å»ºå‡½æ•° cap è·å¾—ï¼Œå®ƒå°†ç»™å‡ºè¯¥åˆ‡ç‰‡å¯å–å¾—çš„æœ€å¤§é•¿åº¦ã€‚ è‹¥æ•°æ®è¶…å‡ºå…¶å®¹é‡ï¼Œåˆ™ä¼šé‡æ–°åˆ†é…è¯¥åˆ‡ç‰‡ï¼Œè¿”å›å€¼å³ä¸ºæ‰€å¾—çš„åˆ‡ç‰‡ã€‚ å°½ç®¡ Append å¯ä¿®æ”¹ slice çš„å…ƒç´ ï¼Œä½†åˆ‡ç‰‡è‡ªèº«ï¼ˆå…¶è¿è¡Œæ—¶æ•°æ®ç»“æ„åŒ…å«æŒ‡é’ˆã€é•¿åº¦å’Œå®¹é‡ï¼‰æ˜¯é€šè¿‡å€¼ä¼ é€’çš„. äºŒç»´æ•°ç»„ ä¸€ç§æ˜¯ç‹¬ç«‹åœ°åˆ†é…æ¯ä¸€ä¸ªåˆ‡ç‰‡ï¼›è€Œå¦ä¸€ç§å°±æ˜¯åªåˆ†é…ä¸€ä¸ªæ•°ç»„ï¼Œ å°†å„ä¸ªåˆ‡ç‰‡éƒ½æŒ‡å‘å®ƒ // ç‹¬ç«‹åœ°åˆ†é…æ¯ä¸€ä¸ªåˆ‡ç‰‡ pic := make([][]uint8, YSize) for i := range pic { // ä¸€æ¬¡ä¸€è¡Œ pic[i] = make([]uint8, XSize) } // é¡¶å±‚ slice pic := make([][]uint8, YSize) // åˆ†é…ä¸€ä¸ªå¤§çš„åˆ‡ç‰‡æ¥ä¿å­˜æ‰€æœ‰åƒç´  pixels := make([]uint8, XSize*YSize) // éå†è¡Œï¼Œä»å‰©ä½™åƒç´ åˆ‡ç‰‡çš„å‰é¢åˆ‡å‡ºæ¯ä¸€è¡Œ for i := range pic { pic[i], pixels = picxels[:XSize], pixels[XSize:] } ","date":"2024-08-15","objectID":"/posts/effective-go/:7:2","tags":["Golang","effective go"],"title":"Effective Go","uri":"/posts/effective-go/"},{"categories":["Golang","effective go"],"content":"Map å¯ä»¥å…³è”ä¸åŒç±»å‹çš„å€¼ã€‚å…¶é”®å¯ä»¥æ˜¯ä»»ä½•ç›¸ç­‰æ€§æ“ä½œç¬¦æ”¯æŒçš„ç±»å‹ï¼Œ å¦‚æ•´æ•°ã€æµ®ç‚¹æ•°ã€å¤æ•°ã€å­—ç¬¦ä¸²ã€æŒ‡é’ˆã€æ¥å£ï¼ˆåªè¦å…¶åŠ¨æ€ç±»å‹æ”¯æŒç›¸ç­‰æ€§åˆ¤æ–­ï¼‰ã€ç»“æ„ä»¥åŠæ•°ç»„ã€‚ åˆ‡ç‰‡ä¸èƒ½ç”¨ä½œæ˜ å°„é”®ï¼Œå› ä¸ºå®ƒä»¬çš„ç›¸ç­‰æ€§è¿˜æœªå®šä¹‰ã€‚ä¸åˆ‡ç‰‡ä¸€æ ·ï¼Œ æ˜ å°„ä¹Ÿæ˜¯å¼•ç”¨ç±»å‹ã€‚ è‹¥å°†æ˜ å°„ä¼ å…¥å‡½æ•°ä¸­ï¼Œå¹¶æ›´æ”¹äº†è¯¥æ˜ å°„çš„å†…å®¹ï¼Œåˆ™æ­¤ä¿®æ”¹å¯¹è°ƒç”¨è€…åŒæ ·å¯è§ã€‚ è‹¥è¯•å›¾é€šè¿‡æ˜ å°„ä¸­ä¸å­˜åœ¨çš„é”®æ¥å–å€¼ï¼Œå°±ä¼šè¿”å›ä¸è¯¥æ˜ å°„ä¸­é¡¹çš„ç±»å‹å¯¹åº”çš„é›¶å€¼ è¦åˆ é™¤ map ä¸­çš„æŸé¡¹ï¼Œå¯ä½¿ç”¨å†…å»ºå‡½æ•° deleteï¼Œå®ƒä»¥æ˜ å°„åŠè¦è¢«åˆ é™¤çš„é”®ä¸ºå®å‚ã€‚ å³ä¾¿å¯¹åº”çš„é”®ä¸åœ¨è¯¥ map ä¸­ï¼Œæ­¤æ“ä½œä¹Ÿæ˜¯å®‰å…¨çš„ã€‚ ","date":"2024-08-15","objectID":"/posts/effective-go/:7:3","tags":["Golang","effective go"],"title":"Effective Go","uri":"/posts/effective-go/"},{"categories":["Golang","effective go"],"content":"Reference Effective Go ","date":"2024-08-15","objectID":"/posts/effective-go/:8:0","tags":["Golang","effective go"],"title":"Effective Go","uri":"/posts/effective-go/"},{"categories":["Design Patten","Golang","C++","æœ€ä½³å®è·µ"],"content":" å¯¼è¯­ è®¾è®¡æ¨¡å¼: åœ¨ç‰¹å®šç¯å¢ƒä¸‹äººä»¬è§£å†³æŸç±»é‡å¤å‡ºç°çš„ä¸€å¥—æˆåŠŸæˆ–æœ‰æ•ˆçš„è§£å†³æ–¹æ¡ˆ. ","date":"2024-07-28","objectID":"/posts/design-pattern/:0:0","tags":["Design Patten","Golang","C++","æœ€ä½³å®è·µ"],"title":"Design Pattern","uri":"/posts/design-pattern/"},{"categories":["Design Patten","Golang","C++","æœ€ä½³å®è·µ"],"content":"I. å‰è¨€ è½¯ä»¶è®¾è®¡æ¨¡å¼ï¼ˆDesign Patternï¼‰ï¼Œæ˜¯ä¸€å¥—è¢«åå¤ä½¿ç”¨ã€å¤šæ•°äººçŸ¥æ™“çš„ã€ç»è¿‡åˆ†ç±»ç¼–ç›®çš„ã€ä»£ç è®¾è®¡ç»éªŒçš„æ€»ç»“ï¼Œä½¿ç”¨è®¾è®¡æ¨¡å¼æ˜¯ä¸ºäº†å¯é‡ç”¨ä»£ç ã€è®©ä»£ç æ›´å®¹æ˜“è¢«ä»–äººç†è§£å¹¶ä¸”ä¿è¯ä»£ç å¯é æ€§ã€‚ ç®€å•æ¥è¯´ï¼Œè®¾è®¡æ¨¡å¼å°±æ˜¯åœ¨ä¸€å®šç¯å¢ƒä¸‹ï¼Œç”¨å›ºå®šå¥—è·¯è§£å†³é—®é¢˜ã€‚ è®¾è®¡æ¨¡å¼çš„åŸºç¡€ï¼šå¤šæ€ ","date":"2024-07-28","objectID":"/posts/design-pattern/:1:0","tags":["Design Patten","Golang","C++","æœ€ä½³å®è·µ"],"title":"Design Pattern","uri":"/posts/design-pattern/"},{"categories":["Design Patten","Golang","C++","æœ€ä½³å®è·µ"],"content":"é¢å‘å¯¹è±¡è®¾è®¡åŸåˆ™ \u003e ç›®çš„ï¼šé«˜å†…èšã€ä½è€¦åˆ å¦‚ä½•åŒæ—¶æâ¾¼â¼€ä¸ªè½¯ä»¶ç³»ç»Ÿçš„å¯ç»´æŠ¤æ€§å’Œå¯å¤â½¤æ€§æ˜¯â¾¯å‘å¯¹è±¡è®¾è®¡éœ€è¦è§£å†³çš„æ ¸â¼¼é—®é¢˜ä¹‹â¼€ã€‚ â¾¯å‘å¯¹è±¡è®¾è®¡åŸåˆ™ä¸ºâ½€æŒå¯ç»´æŠ¤æ€§å¤â½¤â½½è¯â½£ï¼Œè¿™äº›åŸåˆ™è•´å«åœ¨å¾ˆå¤šè®¾è®¡æ¨¡å¼ä¸­ï¼Œå®ƒä»¬æ˜¯ä»è®¸å¤šè®¾è®¡â½…æ¡ˆä¸­æ€»ç»“å‡ºçš„æŒ‡å¯¼æ€§åŸåˆ™ã€‚ å•ä¸€èŒè´£åŸåˆ™: ç±»çš„èŒè´£å•â¼€ï¼Œå¯¹å¤–åªæä¾›â¼€ç§åŠŸèƒ½ï¼Œâ½½å¼•èµ·ç±»å˜åŒ–çš„åŸå› éƒ½åº”è¯¥åªæœ‰â¼€ä¸ª å¼€é—­åŸåˆ™: ç±»çš„æ”¹åŠ¨æ˜¯é€šè¿‡å¢åŠ ä»£ç è¿›â¾çš„ï¼Œâ½½ä¸æ˜¯ä¿®æ”¹æºä»£ç  é‡Œå¼ä»£æ¢åŸåˆ™: ä»»ä½•æŠ½è±¡ç±»å‡ºç°çš„åœ°â½…éƒ½å¯ä»¥â½¤ä»–çš„å®ç°ç±»è¿›â¾æ›¿æ¢ï¼Œå®é™…å°±æ˜¯è™šæ‹Ÿæœºåˆ¶ï¼Œè¯­â¾”çº§åˆ«å®ç°â¾¯å‘å¯¹è±¡åŠŸèƒ½ ä¾èµ–å€’è½¬åŸåˆ™: ä¾èµ–äºæŠ½è±¡(æ¥â¼)ï¼Œä¸è¦ä¾èµ–å…·ä½“çš„å®ç°(ç±»)ï¼Œä¹Ÿå°±æ˜¯é’ˆå¯¹æ¥â¼ç¼–ç¨‹ æ¥å£éš”ç¦»åŸåˆ™: ä¸åº”è¯¥å¼ºè¿«â½¤æˆ·çš„ç¨‹åºä¾èµ–ä»–ä»¬ä¸éœ€è¦çš„æ¥â¼â½…æ³•ã€‚â¼€ä¸ªæ¥â¼åº”è¯¥åªæä¾›â¼€ç§å¯¹å¤–åŠŸèƒ½ï¼Œä¸åº”è¯¥æŠŠæ‰€æœ‰æ“ä½œéƒ½å°è£…åˆ°â¼€ä¸ªæ¥â¼ä¸­å» åˆæˆå¤ç”¨åŸåˆ™: å¦‚æœä½¿â½¤ç»§æ‰¿ï¼Œä¼šå¯¼è‡´â½—ç±»çš„ä»»ä½•å˜æ¢éƒ½å¯èƒ½å½±å“åˆ°â¼¦ç±»çš„â¾ä¸ºã€‚å¦‚æœä½¿â½¤å¯¹è±¡ç»„åˆï¼Œå°±é™ä½äº†è¿™ç§ä¾èµ–å…³ç³»ã€‚å¯¹äºç»§æ‰¿å’Œç»„åˆï¼Œä¼˜å…ˆä½¿â½¤ç»„åˆ è¿ªç±³ç‰¹æ³•åˆ™: â¼€ä¸ªå¯¹è±¡åº”å½“å¯¹å…¶ä»–å¯¹è±¡å°½å¯èƒ½å°‘çš„äº†è§£ï¼Œä»â½½é™ä½å„ä¸ªå¯¹è±¡ä¹‹é—´çš„è€¦åˆï¼Œæâ¾¼ç³»ç»Ÿçš„å¯ç»´æŠ¤æ€§ ","date":"2024-07-28","objectID":"/posts/design-pattern/:1:1","tags":["Design Patten","Golang","C++","æœ€ä½³å®è·µ"],"title":"Design Pattern","uri":"/posts/design-pattern/"},{"categories":["Design Patten","Golang","C++","æœ€ä½³å®è·µ"],"content":"II. åˆ†ç±» åˆ›å»ºå‹ï¼ˆCreationalï¼‰æ¨¡å¼ï¼šå¦‚ä½•åˆ›å»ºå¯¹è±¡ æ¨¡å¼åç§° ç”¨é€” å•ä¾‹æ¨¡å¼ ğŸŒŸğŸŒŸğŸŒŸğŸŒŸ ä¿è¯ä¸€ä¸ªç±»ä»…æœ‰ä¸€ä¸ªå®ä¾‹ï¼Œå¹¶æä¾›ä¸€ä¸ªè®¿é—®å®ƒçš„å…¨å±€è®¿é—®ç‚¹ ç®€å•å·¥å‚æ–¹æ³• ğŸŒŸğŸŒŸğŸŒŸ é€šè¿‡ä¸“é—¨å®šä¹‰ä¸€ä¸ªç±»æ¥è´Ÿè´£åˆ›å»ºå…¶ä»–ç±»çš„å®ä¾‹ï¼Œè¢«åˆ›å»ºçš„å®ä¾‹é€šå¸¸éƒ½å…·æœ‰å…±åŒçš„åŸºç±» æŠ½è±¡å·¥å‚æ–¹æ³• ğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸ æä¾›ä¸€ä¸ªåˆ›å»ºä¸€ç³»åˆ—ç›¸å…³æˆ–ç›¸äº’ä¾èµ–çš„æ¥å£ï¼Œè€Œæ— éœ€æŒ‡å®šå®ƒä»¬å…·ä½“çš„ç±» åŸå‹æ¨¡å¼ â½¤åŸå‹å®ä¾‹æŒ‡å®šåˆ›å»ºå¯¹è±¡çš„ç§ç±»ï¼Œå¹¶ä¸”é€šè¿‡æ‹·â»‰è¿™äº›åŸå‹åˆ›å»ºæ–°çš„å¯¹è±¡ å»ºé€ è€…æ¨¡å¼ å°†â¼€ä¸ªå¤æ‚çš„æ„å»ºä¸å…¶è¡¨ç¤ºç›¸åˆ†ç¦»ï¼Œä½¿å¾—åŒæ ·çš„æ„å»ºè¿‡ç¨‹å¯ä»¥åˆ›å»ºä¸åŒçš„è¡¨ç¤º ç»“æ„å‹ï¼ˆStructuralï¼‰æ¨¡å¼ï¼šå¦‚ä½•å®ç°ç±»æˆ–å¯¹è±¡çš„ç»„åˆ æ¨¡å¼åç§° ç”¨é€” é€‚é…å™¨æ¨¡å¼ ğŸŒŸğŸŒŸğŸŒŸğŸŒŸ å°†ä¸€ä¸ªç±»çš„æ¥å£è½¬æ¢æˆå®¢æˆ·å¸Œæœ›çš„å¦å¤–ä¸€ä¸ªæ¥å£ï¼Œä½¿å¾—åŸæœ¬ç”±äºæ¥å£ä¸å…¼å®¹è€Œä¸èƒ½ä¸€èµ·å·¥ä½œçš„é‚£äº›ç±»å¯ä»¥ä¸€èµ·å·¥ä½œ æ¡¥æ¥æ¨¡å¼ å°†æŠ½è±¡éƒ¨åˆ†ä¸å®é™…éƒ¨åˆ†åˆ†ç¦»ï¼Œä½¿å®ƒä»¬å¯ä»¥ç‹¬ç«‹çš„å˜åŒ– ç»„åˆæ¨¡å¼ ğŸŒŸğŸŒŸğŸŒŸğŸŒŸ å°†å¯¹è±¡ç»„åˆæˆæ ‘å½¢ç»“æ„ä»¥è¡¨ç¤º â€œéƒ¨åˆ† - æ•´ä½“â€ çš„å±‚æ¬¡ç»“æ„ï¼Œä½¿å¾—ç”¨æˆ·å¯¹å•ä¸ªå¯¹è±¡å’Œç»„åˆå¯¹è±¡çš„ä½¿ç”¨å…·æœ‰ä¸€è‡´æ€§ è£…é¥°æ¨¡å¼ ğŸŒŸğŸŒŸğŸŒŸ åŠ¨æ€åœ°ç»™ä¸€ä¸ªå¯¹è±¡æ·»åŠ ä¸€äº›é¢å¤–çš„èŒè´£ï¼šå°±å¢åŠ åŠŸèƒ½æ¥è¯´ï¼Œæ­¤æ¨¡å¼æ¯”ç”Ÿæˆå­ç±»æ›´åŠ çµæ´» å¤–è§‚æ¨¡å¼ ğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸ ä¸ºå­ç³»ç»Ÿçš„ä¸€ç»„æ¥å£æä¾›ä¸€ä¸ªä¸€è‡´çš„ç•Œé¢ï¼Œæ­¤æ¨¡å¼å®šä¹‰äº†ä¸€ä¸ªé«˜å±‚æ¬¡æ¥å£ï¼Œä½¿å¾—è¿™ä¸€å­ç³»ç»Ÿæ›´å®¹æ˜“ä½¿ç”¨ äº«å…ƒæ¨¡å¼ ä»¥å…±äº«çš„æ–¹å¼é«˜æ•ˆçš„æ”¯æŒå¤§é‡çš„ç»†ç²’åº¦çš„å¯¹è±¡ ä»£ç†æ¨¡å¼ ä¸ºå…¶ä»–å¯¹è±¡æä¾›ä¸€ç§ä»£ç†ä»¥æ§åˆ¶è¿™ä¸ªå¯¹è±¡çš„è®¿é—® è¡Œä¸ºå‹ï¼ˆBehavioralï¼‰æ¨¡å¼ï¼šç±»æˆ–å¯¹è±¡å¦‚ä½•äº¤äº’ä»¥åŠå¦‚ä½•åˆ†é…æŒ‡è´£ ","date":"2024-07-28","objectID":"/posts/design-pattern/:2:0","tags":["Design Patten","Golang","C++","æœ€ä½³å®è·µ"],"title":"Design Pattern","uri":"/posts/design-pattern/"},{"categories":["Design Patten","Golang","C++","æœ€ä½³å®è·µ"],"content":"III. åˆ›å»ºå‹è®¾è®¡æ¨¡å¼ ","date":"2024-07-28","objectID":"/posts/design-pattern/:3:0","tags":["Design Patten","Golang","C++","æœ€ä½³å®è·µ"],"title":"Design Pattern","uri":"/posts/design-pattern/"},{"categories":["Design Patten","Golang","C++","æœ€ä½³å®è·µ"],"content":"1. ç®€å•å·¥å‚æ¨¡å¼ äº¦ç§°ï¼šè™šæ‹Ÿæ„é€ å‡½æ•°ã€Virtual Constructorã€Factory Method æ„å›¾ï¼šå®ƒæ˜¯ä¸€ç§åˆ›å»ºå‹è®¾è®¡æ¨¡å¼ï¼Œå…¶åœ¨çˆ¶ç±»ä¸­æä¾›ä¸€ä¸ªåˆ›å»ºå¯¹è±¡çš„æ–¹æ³•ï¼Œå…è®¸å­ç±»å†³å®šå®ä¾‹åŒ–å¯¹è±¡çš„ç±»å‹ NOTE: ç”±äº Golang ä¸­ç¼ºå°‘ç±»å’Œç»§æ‰¿ç­‰ OOP ç‰¹æ€§ï¼Œå› æ­¤ï¼Œæ— æ³•ä½¿ç”¨ Go æ¥å®ç°ç»å…¸çš„å·¥å‚æ–¹æ³•æ¨¡å¼ï¼Œä½†æˆ‘ä»¬ä»èƒ½å®ç°åŸºç¡€ç‰ˆæœ¬ï¼Œå³ç®€å•å·¥å‚ã€‚ ","date":"2024-07-28","objectID":"/posts/design-pattern/:3:1","tags":["Design Patten","Golang","C++","æœ€ä½³å®è·µ"],"title":"Design Pattern","uri":"/posts/design-pattern/"},{"categories":["Golang","Project Layout","Stardard"],"content":" å¯¼è¯­ Go åº”ç”¨ç¨‹åºé¡¹ç›®çš„åŸºæœ¬å¸ƒå±€ä»‹ç» ","date":"2024-07-13","objectID":"/posts/golang-project-layout/:0:0","tags":["Golang","Project Layout","Stardard"],"title":"Golang Project Stardard Layout","uri":"/posts/golang-project-layout/"},{"categories":["Golang","Project Layout","Stardard"],"content":"Go Module ä» Go 1.14 ç‰ˆæœ¬å¼€å§‹ï¼Œé™¤éå­˜åœ¨ç‰¹å®šä¸ä½¿ç”¨ Go Modules çš„ç†ç”±ï¼Œå¦åˆ™è¯·ä½¿ç”¨ï¼Œå¹¶ä¸”ä¸€æ—¦ä½¿ç”¨ï¼Œå°±æ— éœ€å†æ‹…å¿ƒ $GOPATH ä»¥åŠé¡¹ç›®çš„å­˜æ”¾ä½ç½®ã€‚ ","date":"2024-07-13","objectID":"/posts/golang-project-layout/:1:0","tags":["Golang","Project Layout","Stardard"],"title":"Golang Project Stardard Layout","uri":"/posts/golang-project-layout/"},{"categories":["Golang","Project Layout","Stardard"],"content":"Go ç›®å½• ","date":"2024-07-13","objectID":"/posts/golang-project-layout/:2:0","tags":["Golang","Project Layout","Stardard"],"title":"Golang Project Stardard Layout","uri":"/posts/golang-project-layout/"},{"categories":["Golang","Project Layout","Stardard"],"content":"/cmd /cmdï¼Œæœ¬é¡¹ç›®çš„ä¸»å¹²ï¼Œå…¶ä¸­æ¯ä¸€ä¸ªåº”ç”¨ç¨‹åºçš„ç›®å½•ååº”è¯¥ä¸ä½ æƒ³è¦çš„å¯æ‰§è¡Œç¨‹åºçš„åç§°ç›¸å¯¹åº”ï¼Œä¾‹å¦‚ /cmd/myAppã€‚ åœ¨ /cmd ç›®å½•ä¸‹ï¼Œä¸åº”è¯¥æ”¾ç½®å¤ªå¤šä»£ç ï¼š å¦‚æœè®¤ä¸ºä»£ç å¯ä»¥å¯¼å…¥å¹¶å¯åœ¨å…¶ä»–é¡¹ç›®ä¸­ä½¿ç”¨ï¼Œé‚£ä¹ˆå®ƒåº”è¯¥ä½äº /pkg ç›®å½•ä¸­. å¦‚æœä»£ç ä¸æ˜¯å¯é‡ç”¨çš„ï¼Œæˆ–è€…ä¸å¸Œæœ›å…¶ä»–äººé‡ç”¨å®ƒï¼Œé‚£ä¹ˆåº”è¯¥ä½äº /internal ç›®å½•ä¸­. è¯¥ç›®å½•ä¸‹ï¼Œé€šå¸¸æœ‰ä¸€ä¸ªå°çš„ main å‡½æ•°ï¼Œä» /internal å’Œ pkg ç›®å½•ä¸­å¯¼å…¥å’Œè°ƒç”¨ä»£ç ï¼Œé™¤æ­¤ä¹‹å¤–æ²¡æœ‰åˆ«çš„ä¸œè¥¿. å¾®æœåŠ¡ä¸­çš„ app æœåŠ¡ç±»å‹åˆ†ä¸º4ç±»ï¼šinterfaceã€serviceã€jobã€admin |---cmd | |---kydenapp-admin | |---kydenapp-interface | |---kydenapp-job | |---kydenapp-service | |---kydenapp-task interface: å¯¹å¤–çš„ BFF æœåŠ¡ï¼Œæ¥å—æ¥è‡ªç”¨æˆ·çš„è¯·æ±‚ï¼Œæ¯”å¦‚æš´éœ²äº† HTTP/gRPC æ¥å£ service: å¯¹å†…çš„å¾®æœåŠ¡ï¼Œä»…æ¥å—æ¥è‡ªå†…éƒ¨å…¶ä»–æœåŠ¡æˆ–ç½‘å…³çš„è¯·æ±‚ï¼Œæ¯”å¦‚æš´éœ²äº† gRPC æ¥å£åªå¯¹å†…æœåŠ¡ admin: åŒºåˆ«äº serviceï¼Œæ›´å¤šæ˜¯é¢å‘è¿è¥æµ‹çš„æœåŠ¡ï¼Œé€šå¸¸æ•°æ®æƒé™æ›´é«˜ï¼Œéš”ç¦»å¸¦æ¥æ›´å¥½çš„ä»£ç çº§åˆ«å®‰å…¨ job: æµå¼ä»»åŠ¡å¤„ç†çš„æœåŠ¡ï¼Œä¸Šæ¸¸ä¸€èˆ¬ä¾èµ– message broker task: å®šæ—¶ä»»åŠ¡ï¼Œç±»ä¼¼ cronjobï¼Œéƒ¨ç½²åˆ° task æ‰˜ç®¡å¹³å°ä¸­ /cmd åº”ç”¨ç›®å½•è´Ÿè´£ç¨‹åºçš„: å¯åŠ¨ã€å…³é—­ã€é…ç½®åˆå§‹åŒ–ç­‰ DTO(Data Transfer Object)ï¼Œæ•°æ®ä¼ è¾“å¯¹è±¡ï¼Œè¿™ä¸ªæ¦‚å¿µæ¥æºäº J2EE çš„è®¾è®¡æ¨¡å¼ï¼Œ ä½†è¿™é‡Œæ³›æŒ‡ç”¨äºå±•ç¤ºå±‚/APIå±‚ä¸æœåŠ¡å±‚ï¼ˆä¸šåŠ¡é€»è¾‘å±‚ï¼‰ä¹‹é—´çš„æ•°æ®ä¼ è¾“å¯¹è±¡ã€‚ ","date":"2024-07-13","objectID":"/posts/golang-project-layout/:2:1","tags":["Golang","Project Layout","Stardard"],"title":"Golang Project Stardard Layout","uri":"/posts/golang-project-layout/"},{"categories":["Golang","Project Layout","Stardard"],"content":"internal internalï¼Œç§æœ‰åº”ç”¨ç¨‹åºå’Œåº“ä»£ç ï¼Œå®ƒæ˜¯ä¸å¸Œæœ›å…¶ä»–äººåœ¨å…¶åº”ç”¨ç¨‹åºæˆ–åº“ä¸­å¯¼å…¥çš„ä»£ç ã€‚ è¯¥ç›®å½•ç”± Go å¼ºåˆ¶æ‰§è¡Œï¼Œç¡®ä¿ç§æœ‰åŒ…ä¸å¯å¯¼å…¥ã€‚ ","date":"2024-07-13","objectID":"/posts/golang-project-layout/:2:2","tags":["Golang","Project Layout","Stardard"],"title":"Golang Project Stardard Layout","uri":"/posts/golang-project-layout/"},{"categories":["Golang","Project Layout","Stardard"],"content":"pkg /pkgï¼Œå¤–éƒ¨åº”ç”¨ç¨‹åºå¯ä»¥ä½¿ç”¨çš„åº“ä»£ç ï¼ˆä¾‹å¦‚ /pkg/mypubliclibï¼‰. å¦‚æœåº”ç”¨ç¨‹åºé¡¹ç›®çœŸçš„å¾ˆå°ï¼Œå¹¶ä¸”é¢å¤–çš„åµŒå¥—å¹¶ä¸èƒ½å¢åŠ å¤šå°‘ä»·å€¼(é™¤éä½ çœŸçš„æƒ³è¦:-)ï¼Œé‚£å°±ä¸è¦ä½¿ç”¨å®ƒã€‚ å½“å®ƒå˜å¾—è¶³å¤Ÿå¤§æ—¶ï¼Œæ ¹ç›®å½•ä¼šå˜å¾—éå¸¸ç¹çæ—¶(å°¤å…¶æ˜¯å½“ä½ æœ‰å¾ˆå¤šé Go åº”ç”¨ç»„ä»¶æ—¶)ï¼Œè¯·è€ƒè™‘ä½¿ç”¨ã€‚ ","date":"2024-07-13","objectID":"/posts/golang-project-layout/:2:3","tags":["Golang","Project Layout","Stardard"],"title":"Golang Project Stardard Layout","uri":"/posts/golang-project-layout/"},{"categories":["Golang","Project Layout","Stardard"],"content":"api /apiï¼Œåè®®å®šä¹‰ç›®å½•ï¼Œ(xxapi.proto) protobuf æ–‡ä»¶ï¼Œä»¥åŠç”Ÿæˆçš„ go æ–‡ä»¶ã€‚ é€šå¸¸æŠŠ api æ–‡æ¡£ç›´æ¥åœ¨ proto æ–‡ä»¶ä¸­æè¿°ã€‚ ","date":"2024-07-13","objectID":"/posts/golang-project-layout/:2:4","tags":["Golang","Project Layout","Stardard"],"title":"Golang Project Stardard Layout","uri":"/posts/golang-project-layout/"},{"categories":["Golang","Project Layout","Stardard"],"content":"configs é…ç½®æ–‡ä»¶æ¨¡ç‰ˆæˆ–é»˜è®¤é…ç½® ","date":"2024-07-13","objectID":"/posts/golang-project-layout/:2:5","tags":["Golang","Project Layout","Stardard"],"title":"Golang Project Stardard Layout","uri":"/posts/golang-project-layout/"},{"categories":["Golang","Project Layout","Stardard"],"content":"scripts æ‰§è¡Œå„ç§æ„å»ºã€å®‰è£…ã€åˆ†æç­‰æ“ä½œçš„è„šæœ¬ï¼Œæ˜¯çš„æ ¹çº§åˆ«çš„ Makefile å˜å¾—å°è€Œç®€å• ","date":"2024-07-13","objectID":"/posts/golang-project-layout/:2:6","tags":["Golang","Project Layout","Stardard"],"title":"Golang Project Stardard Layout","uri":"/posts/golang-project-layout/"},{"categories":["Golang","Project Layout","Stardard"],"content":"test é¢å¤–çš„å¤–éƒ¨æµ‹è¯•åº”ç”¨ç¨‹åºå’Œæµ‹è¯•æ•°æ® Go ä¼šå¿½ç•¥ä»¥ . æˆ– _ å¼€å¤´çš„ç›®å½•å’Œæ–‡ä»¶ ","date":"2024-07-13","objectID":"/posts/golang-project-layout/:2:7","tags":["Golang","Project Layout","Stardard"],"title":"Golang Project Stardard Layout","uri":"/posts/golang-project-layout/"},{"categories":["Golang","Project Layout","Stardard"],"content":"docs è®¾è®¡å’Œç”¨æˆ·æ–‡æ¡£ï¼ˆgodoc ç”Ÿæˆçš„æ–‡æ¡£é™¤å¤–ï¼‰ ","date":"2024-07-13","objectID":"/posts/golang-project-layout/:2:8","tags":["Golang","Project Layout","Stardard"],"title":"Golang Project Stardard Layout","uri":"/posts/golang-project-layout/"},{"categories":["Golang","Project Layout","Stardard"],"content":"tools é¡¹ç›®çš„æ”¯æŒå·¥å…·ï¼Œå¯ä»¥ä» /pkg å’Œ /internal ç›®å½•å¯¼å…¥ä»£ç  ","date":"2024-07-13","objectID":"/posts/golang-project-layout/:2:9","tags":["Golang","Project Layout","Stardard"],"title":"Golang Project Stardard Layout","uri":"/posts/golang-project-layout/"},{"categories":["Golang","Project Layout","Stardard"],"content":"examples åº”ç”¨ç¨‹åºå’Œ/æˆ–å…¬å…±åº“çš„ç¤ºä¾‹ ","date":"2024-07-13","objectID":"/posts/golang-project-layout/:2:10","tags":["Golang","Project Layout","Stardard"],"title":"Golang Project Stardard Layout","uri":"/posts/golang-project-layout/"},{"categories":["Golang","Project Layout","Stardard"],"content":"third_party å¤–éƒ¨è¾…åŠ©å·¥å…·ï¼Œåˆ†å‰ä»£ç å’Œå…¶ä»–ç¬¬ä¸‰æ–¹å·¥å…·ï¼ˆä¾‹å¦‚ Swagger UIï¼‰ ","date":"2024-07-13","objectID":"/posts/golang-project-layout/:2:11","tags":["Golang","Project Layout","Stardard"],"title":"Golang Project Stardard Layout","uri":"/posts/golang-project-layout/"},{"categories":["Golang","Project Layout","Stardard"],"content":"assets ä¸å­˜å‚¨åº“ä¸€èµ·ä½¿ç”¨çš„å…¶ä»–èµ„æºï¼ˆå›¾åƒã€å¾½æ ‡ç­‰ï¼‰ æŒ‰ç†æ¥è¯´æˆ‘ä»¬ä¸åº”è¯¥ src ç›®å½•ï¼Œä½†æœ‰äº› Go é¡¹ç›®æ‹¥æœ‰ä¸€ä¸ª src æ–‡ä»¶å¤¹ï¼Œè¿™é€šå¸¸å‘ç”Ÿåœ¨å¼€å‘äººå‘˜å…·æœ‰ Java èƒŒæ™¯ $GOPATH ç¯å¢ƒå˜é‡æŒ‡å‘ä½ çš„(å½“å‰)å·¥ä½œç©ºé—´(é»˜è®¤æƒ…å†µä¸‹ï¼Œå®ƒæŒ‡å‘é windows ç³»ç»Ÿä¸Šçš„ $HOME/go)ï¼Œè¿™ä¸ªå·¥ä½œç©ºé—´åŒ…æ‹¬é¡¶å±‚ /pkg, /bin å’Œ /src ç›®å½•ï¼Œè€Œå®é™…é¡¹ç›®æœ€ç»ˆæ˜¯ /src ä¸‹çš„ä¸€ä¸ªå­ç›®å½•ï¼Œå³ /xxx/workspace/src/proj/src/xxx.goï¼ˆGo 1.11 ä¹‹åï¼Œé¡¹ç›® proj å¯ä»¥æ”¾åœ¨ GOPATH ä¹‹å¤–ï¼‰. ","date":"2024-07-13","objectID":"/posts/golang-project-layout/:2:12","tags":["Golang","Project Layout","Stardard"],"title":"Golang Project Stardard Layout","uri":"/posts/golang-project-layout/"},{"categories":["Golang","Project Layout","Stardard"],"content":"Reference https://talks.golang.org/2014/names.slide https://golang.org/doc/effective_go.html#names https://blog.golang.org/package-names https://go.dev/wiki/CodeReviewComments Style guideline for Go packages (rakyll/JBD) ","date":"2024-07-13","objectID":"/posts/golang-project-layout/:3:0","tags":["Golang","Project Layout","Stardard"],"title":"Golang Project Stardard Layout","uri":"/posts/golang-project-layout/"},{"categories":["Golang","Context"],"content":" å¯¼è¯­ å½“éœ€è¦åœ¨å¤šä¸ª Goroutine ä¸­ä¼ é€’ä¸Šä¸‹æ–‡ä¿¡æ¯æ—¶ï¼Œå¯ä»¥ä½¿ç”¨ Context å®ç° ","date":"2024-06-01","objectID":"/posts/golang-context/:0:0","tags":["Golang","Context"],"title":"æµ…æ Golang Context","uri":"/posts/golang-context/"},{"categories":["Golang","Context"],"content":"Context Context é™¤äº†ç”¨æ¥ä¼ é€’ä¸Šä¸‹æ–‡ä¿¡æ¯ï¼Œè¿˜å¯ä»¥ç”¨æ¥ä¼ é€’ç»ˆç»“æ‰§è¡Œå­ä»»åŠ¡çš„ç›¸å…³ä¿¡å·ï¼Œç»ˆæ­¢å¤šä¸ªæ‰§è¡Œå­ä»»åŠ¡çš„ Goroutineã€‚ context.Context æ¥å£æ•°æ®ç»“æ„ï¼š // A Context carries a deadline, a cancellation signal, and other values across // API boundaries. // // Context's methods may be called by multiple goroutines simultaneously. type Context interface { // Deadline returns the time when work done on behalf of this context // should be canceled. Deadline returns ok==false when no deadline is // set. Successive calls to Deadline return the same results. Deadline() (deadline time.Time, ok bool) // Done returns a channel that's closed when work done on behalf of this // context should be canceled. Done may return nil if this context can // never be canceled. Successive calls to Done return the same value. // The close of the Done channel may happen asynchronously, // after the cancel function returns. // // WithCancel arranges for Done to be closed when cancel is called; // WithDeadline arranges for Done to be closed when the deadline // expires; WithTimeout arranges for Done to be closed when the timeout // elapses. // // Done is provided for use in select statements: // // // Stream generates values with DoSomething and sends them to out // // until DoSomething returns an error or ctx.Done is closed. // func Stream(ctx context.Context, out chan\u003c- Value) error { // for { // v, err := DoSomething(ctx) // if err != nil { // return err // } // select { // case \u003c-ctx.Done(): // return ctx.Err() // case out \u003c- v: // } // } // } // // See https://blog.golang.org/pipelines for more examples of how to use // a Done channel for cancellation. Done() \u003c-chan struct{} // If Done is not yet closed, Err returns nil. // If Done is closed, Err returns a non-nil error explaining why: // Canceled if the context was canceled // or DeadlineExceeded if the context's deadline passed. // After Err returns a non-nil error, successive calls to Err return the same error. Err() error // Value returns the value associated with this context for key, or nil // if no value is associated with key. Successive calls to Value with // the same key returns the same result. // // Use context values only for request-scoped data that transits // processes and API boundaries, not for passing optional parameters to // functions. // // A key identifies a specific value in a Context. Functions that wish // to store values in Context typically allocate a key in a global // variable then use that key as the argument to context.WithValue and // Context.Value. A key can be any type that supports equality; // packages should define keys as an unexported type to avoid // collisions. // // Packages that define a Context key should provide type-safe accessors // for the values stored using that key: // // // Package user defines a User type that's stored in Contexts. // package user // // import \"context\" // // // User is the type of value stored in the Contexts. // type User struct {...} // // // key is an unexported type for keys defined in this package. // // This prevents collisions with keys defined in other packages. // type key int // // // userKey is the key for user.User values in Contexts. It is // // unexported; clients use user.NewContext and user.FromContext // // instead of using this key directly. // var userKey key // // // NewContext returns a new Context that carries value u. // func NewContext(ctx context.Context, u *User) context.Context { // return context.WithValue(ctx, userKey, u) // } // // // FromContext returns the User value stored in ctx, if any. // func FromContext(ctx context.Context) (*User, bool) { // u, ok := ctx.Value(userKey).(*User) // return u, ok // } Value(key any) any } Deadlineï¼šè¿”å› Context è¢«å–æ¶ˆçš„æ—¶é—´ï¼Œä¹Ÿå°±æ˜¯å®Œæˆå·¥ä½œçš„æˆªè‡³æ—¥æœŸï¼› Doneï¼šè¿”å›ä¸€ä¸ª channelï¼Œè¿™ä¸ª channel ä¼šåœ¨å½“å‰å·¥ä½œå®Œæˆæˆ–è€…ä¸Šä¸‹æ–‡è¢«å–æ¶ˆä¹‹åå…³é—­ï¼Œå¤šæ¬¡è°ƒç”¨ Done æ–¹æ³•ä¼šè¿”å›åŒä¸€ä¸ª channelï¼› Errï¼šæ”¾å› Context ç»“æŸçš„åŸå› ï¼Œåªä¼šåœ¨ Done è¿”å›çš„ channel è¢«å…³é—­æ—¶æ‰ä¼šè¿”å›éç©ºçš„å€¼ï¼Œå¦‚æœ Context è¢«å–æ¶ˆï¼Œä¼šè¿”å› Canceled é”™è¯¯ï¼›å¦‚æœ Context è¶…æ—¶ï¼Œä¼šè¿”å› DeadlineExceeded é”™è¯¯ï¼› Valueï¼šå¯ç”¨äºä» Context ä¸­è·å–ä¼ é€’çš„é”®å€¼ä¿¡æ¯ï¼› ","date":"2024-06-01","objectID":"/posts/golang-context/:1:0","tags":["Golang","Context"],"title":"æµ…æ Golang Context","uri":"/posts/golang-context/"},{"categories":["Golang","Context"],"content":"Example åœ¨ Web è¯·æ±‚çš„å¤„ç†è¿‡ç¨‹ä¸­ï¼Œä¸€ä¸ªè¯·æ±‚å¯èƒ½å¯åŠ¨å¤šä¸ª goroutine ååŒå·¥ä½œï¼Œè¿™äº› goroutine ä¹‹é—´å¯èƒ½éœ€è¦å…±äº«è¯·æ±‚çš„ä¿¡æ¯ï¼Œä¸”å½“è¯·æ±‚è¢«å–æ¶ˆæˆ–è€…æ‰§è¡Œè¶…æ—¶æ—¶ï¼Œè¯¥è¯·æ±‚å¯¹åº”çš„æ‰€æœ‰ goroutine éƒ½éœ€è¦å¿«é€Ÿç»“æŸï¼Œé‡Šæ”¾èµ„æºï¼ŒContext å°±æ˜¯ä¸ºäº†è§£å†³ä¸Šè¿°åœºæ™¯è€Œå¼€å‘çš„ã€‚ package main import ( \"context\" \"fmt\" \"time\" ) const DB_ADDRESS = \"db_address\" const CALCULATE_VALUE = \"calculate_value\" func readDB(ctx context.Context, cost time.Duration) { fmt.Println(\"DB address is \", ctx.Value(DB_ADDRESS)) select { case \u003c-time.After(cost): fmt.Println(\"read data from db\") case \u003c-ctx.Done(): fmt.Println(ctx.Err()) } } func calculate(ctx context.Context, cost time.Duration) { fmt.Println(\"calculate value is\", ctx.Value(CALCULATE_VALUE)) select { case \u003c-time.After(cost): // æ¨¡æ‹Ÿæ•°æ®è®¡ç®— fmt.Println(\"calculate finish\") case \u003c-ctx.Done(): fmt.Println(ctx.Err()) // ä»»åŠ¡å–æ¶ˆçš„åŸå›  // ä¸€äº›æ¸…ç†å·¥ä½œ } } func main() { ctx := context.Background() // Add Context info ctx = context.WithValue(ctx, DB_ADDRESS, \"localhost:3306\") ctx = context.WithValue(ctx, CALCULATE_VALUE, \"123\") ctx, cancel := context.WithTimeout(ctx, time.Second*2) defer cancel() go readDB(ctx, time.Second*4) go calculate(ctx, time.Second*4) time.Sleep(time.Second * 5) } ä½¿ç”¨ Contextï¼Œèƒ½å¤Ÿæœ‰æ•ˆåœ°åœ¨ä¸€ç»„ goroutine ä¸­ä¼ é€’å…±äº«å€¼ã€å–æ¶ˆä¿¡å·ã€deadline ç­‰ä¿¡æ¯ï¼ŒåŠæ—¶å…³é—­ä¸éœ€è¦çš„ goroutineã€‚ ","date":"2024-06-01","objectID":"/posts/golang-context/:2:0","tags":["Golang","Context"],"title":"æµ…æ Golang Context","uri":"/posts/golang-context/"},{"categories":["Golang","Context"],"content":"Reference Go Context ","date":"2024-06-01","objectID":"/posts/golang-context/:3:0","tags":["Golang","Context"],"title":"æµ…æ Golang Context","uri":"/posts/golang-context/"},{"categories":["Golang","é€ƒé€¸åˆ†æ","Escape Analysis","Heap","Stack"],"content":" å¯¼è¯­ æ·±å…¥ç†è§£ Golang Escape Analysisï¼šå˜é‡ä½•æ—¶é€ƒé€¸ï¼Ÿ ","date":"2024-05-19","objectID":"/posts/golang-escape-analysis/:0:0","tags":["Golang","é€ƒé€¸åˆ†æ","Escape Analysis","Heap","Stack"],"title":"æ·±å…¥æ¢è®¨ Golang Escape Analysis","uri":"/posts/golang-escape-analysis/"},{"categories":["Golang","é€ƒé€¸åˆ†æ","Escape Analysis","Heap","Stack"],"content":"I. Golang Escape Ananlysis Golang ç¼–è¯‘å™¨ä¼šè‡ªåŠ¨å†³å®šæŠŠä¸€ä¸ªå˜é‡æ”¾åœ¨å †æ ˆè¿˜æ˜¯æ ˆä¸Šï¼Œå³é€ƒé€¸åˆ†æï¼ˆEscape Analysisï¼‰. Go å£°ç§°é€ƒé€¸åˆ†æå¯ä»¥é‡Šæ”¾ç¨‹åºå‘˜å…³äºå†…å­˜çš„ä½¿ç”¨é™åˆ¶ï¼Œæ›´å¤šåœ°å…³æ³¨ç¨‹åºé€»è¾‘æœ¬èº«ã€‚ ","date":"2024-05-19","objectID":"/posts/golang-escape-analysis/:1:0","tags":["Golang","é€ƒé€¸åˆ†æ","Escape Analysis","Heap","Stack"],"title":"æ·±å…¥æ¢è®¨ Golang Escape Analysis","uri":"/posts/golang-escape-analysis/"},{"categories":["Golang","é€ƒé€¸åˆ†æ","Escape Analysis","Heap","Stack"],"content":"II. é€ƒé€¸è§„åˆ™ ä¼—æ‰€å‘¨çŸ¥ï¼Œå½“å˜é‡éœ€è¦ä½¿ç”¨å †ï¼ˆheapï¼‰ç©ºé—´æ—¶ï¼Œé‚£ä¹ˆå˜é‡å°±åº”è¯¥è¿›è¡Œé€ƒé€¸ã€‚ ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œä¸€ä¸ªå¼•ç”¨å¯¹è±¡ä¸­çš„å¼•ç”¨ç±»æˆå‘˜è¿›è¡Œèµ‹å€¼ï¼Œå¯èƒ½å‡ºç°é€ƒé€¸ç°è±¡ï¼šå¯ä»¥ç†è§£ä¸ºè®¿é—®ä¸€ä¸ªå¼•ç”¨å¯¹è±¡å®é™…ä¸Šåº•å±‚å°±æ˜¯é€šè¿‡ä¸€ä¸ªæŒ‡é’ˆæ¥é—´æ¥çš„è®¿é—®ï¼Œä½†å¦‚æœå†è®¿é—®é‡Œé¢çš„å¼•ç”¨æˆå‘˜å°±ä¼šæœ‰ç¬¬äºŒæ¬¡é—´æ¥è®¿é—®ï¼Œè¿™æ ·æ“ä½œè¿™éƒ¨åˆ†å¯¹è±¡çš„è¯ï¼Œæå¤§å¯èƒ½ä¼šå‡ºç°é€ƒé€¸çš„ç°è±¡ã€‚ Golang ä¸­çš„å¼•ç”¨ç±»å‹æœ‰å‡½æ•°ç±»å‹ func()ï¼Œæ¥å£ç±»å‹ interfaceï¼Œåˆ‡ç‰‡ç±»å‹ sliceï¼Œå­—å…¸ç±»å‹ mapï¼Œç®¡é“ç±»å‹ channelï¼ŒæŒ‡é’ˆç±»å‹ * ç­‰ã€‚ ","date":"2024-05-19","objectID":"/posts/golang-escape-analysis/:2:0","tags":["Golang","é€ƒé€¸åˆ†æ","Escape Analysis","Heap","Stack"],"title":"æ·±å…¥æ¢è®¨ Golang Escape Analysis","uri":"/posts/golang-escape-analysis/"},{"categories":["Golang","é€ƒé€¸åˆ†æ","Escape Analysis","Heap","Stack"],"content":"é€ƒé€¸åœºæ™¯Iï¼š []interface{} ä½¿ç”¨ [] èµ‹å€¼ []interface{} æ•°æ®ç±»å‹ï¼Œå¿…å®šé€ƒé€¸ package main import \"fmt\" func main() { data := []interface{}{1, 2} val := data[0] fmt.Printf(\"%v\\n\", val) data[0] = 3 } $ go build -v -gcflags='-m' ./main.go command-line-arguments # command-line-arguments ./main.go:8:12: inlining call to fmt.Printf ./main.go:6:23: []interface {}{...} does not escape ./main.go:6:24: 1 escapes to heap ./main.go:6:27: 2 escapes to heap ./main.go:8:12: ... argument does not escape ./main.go:9:12: 3 escapes to heap ","date":"2024-05-19","objectID":"/posts/golang-escape-analysis/:2:1","tags":["Golang","é€ƒé€¸åˆ†æ","Escape Analysis","Heap","Stack"],"title":"æ·±å…¥æ¢è®¨ Golang Escape Analysis","uri":"/posts/golang-escape-analysis/"},{"categories":["Golang","é€ƒé€¸åˆ†æ","Escape Analysis","Heap","Stack"],"content":"é€ƒé€¸åœºæ™¯IIï¼š map[string]interface{} ä½¿ç”¨ [] èµ‹å€¼ map[string]interface{} æ•°æ®ç±»å‹ï¼Œå¿…å®šé€ƒé€¸ package main import \"fmt\" func main() { dat := make(map[string]interface{}) dat[\"BlogName\"] = \"Kyden's Blog\" val := dat[\"BlogName\"] fmt.Printf(\"%v\\n\", val) } $ go build -v -gcflags='-m' ./main.go command-line-arguments # command-line-arguments ./main.go:9:12: inlining call to fmt.Printf ./main.go:6:13: make(map[string]interface {}) does not escape ./main.go:7:20: \"Kyden's Blog\" escapes to heap ./main.go:9:12: ... argument does not escape ","date":"2024-05-19","objectID":"/posts/golang-escape-analysis/:2:2","tags":["Golang","é€ƒé€¸åˆ†æ","Escape Analysis","Heap","Stack"],"title":"æ·±å…¥æ¢è®¨ Golang Escape Analysis","uri":"/posts/golang-escape-analysis/"},{"categories":["Golang","é€ƒé€¸åˆ†æ","Escape Analysis","Heap","Stack"],"content":"é€ƒé€¸åœºæ™¯ IIIï¼š map[interface{}]interface{} ä½¿ç”¨ [] èµ‹å€¼ map[interface{}]interface{} æ•°æ®ç±»å‹ï¼Œå¿…å®šé€ƒé€¸ package main import ( \"fmt\" ) func main() { dat := make(map[interface{}]interface{}) dat[\"BlogName\"] = \"Kyden's Blog\" val := dat[\"BlogName\"] fmt.Printf(\"%v\\n\", val) } $ go build -v -gcflags='-m' ./main.go command-line-arguments # command-line-arguments ./main.go:11:12: inlining call to fmt.Printf ./main.go:8:13: make(map[interface {}]interface {}) does not escape ./main.go:9:6: \"BlogName\" escapes to heap ./main.go:9:20: \"Kyden's Blog\" escapes to heap ./main.go:10:13: \"BlogName\" does not escape ./main.go:11:12: ... argument does not escape ","date":"2024-05-19","objectID":"/posts/golang-escape-analysis/:2:3","tags":["Golang","é€ƒé€¸åˆ†æ","Escape Analysis","Heap","Stack"],"title":"æ·±å…¥æ¢è®¨ Golang Escape Analysis","uri":"/posts/golang-escape-analysis/"},{"categories":["Golang","é€ƒé€¸åˆ†æ","Escape Analysis","Heap","Stack"],"content":"é€ƒé€¸åœºæ™¯ IVï¼šmap[string][]string map[string][]string æ•°æ®ç±»å‹ï¼Œèµ‹å€¼ä¼šå‘ç”Ÿ []string é€ƒé€¸ package main import ( \"fmt\" ) func main() { dat := make(map[string][]string) dat[\"BlogName\"] = []string{\"Kyden's Blog\"} val := dat[\"BlogName\"] fmt.Printf(\"%v\\n\", val) } $ go build -v -gcflags='-m' ./main.go command-line-arguments # command-line-arguments ./main.go:11:12: inlining call to fmt.Printf ./main.go:8:13: make(map[string][]string) does not escape ./main.go:9:28: []string{...} escapes to heap ./main.go:11:12: ... argument does not escape ./main.go:11:21: val escapes to heap ","date":"2024-05-19","objectID":"/posts/golang-escape-analysis/:2:4","tags":["Golang","é€ƒé€¸åˆ†æ","Escape Analysis","Heap","Stack"],"title":"æ·±å…¥æ¢è®¨ Golang Escape Analysis","uri":"/posts/golang-escape-analysis/"},{"categories":["Golang","é€ƒé€¸åˆ†æ","Escape Analysis","Heap","Stack"],"content":"é€ƒé€¸åœºæ™¯ Vï¼š[]*int []*int æ•°æ®ç±»å‹ï¼Œèµ‹å€¼çš„å³å€¼ä¼šå‘ç”Ÿé€ƒé€¸ package main import \"fmt\" func main() { dat := []*int{nil} a := 10 dat[0] = \u0026a fmt.Printf(\"%v\\r\\n\", *dat[0]) fmt.Printf(\"%v\\r\\n\", dat[0]) } $ go build -v -gcflags='-m' ./main.go command-line-arguments # command-line-arguments ./main.go:9:12: inlining call to fmt.Printf ./main.go:10:12: inlining call to fmt.Printf ./main.go:7:2: moved to heap: a ./main.go:6:15: []*int{...} does not escape ./main.go:9:12: ... argument does not escape ./main.go:9:23: *dat[0] escapes to heap ./main.go:10:12: ... argument does not escape ","date":"2024-05-19","objectID":"/posts/golang-escape-analysis/:2:5","tags":["Golang","é€ƒé€¸åˆ†æ","Escape Analysis","Heap","Stack"],"title":"æ·±å…¥æ¢è®¨ Golang Escape Analysis","uri":"/posts/golang-escape-analysis/"},{"categories":["Golang","é€ƒé€¸åˆ†æ","Escape Analysis","Heap","Stack"],"content":"é€ƒé€¸åœºæ™¯ VIï¼šfunc(*int) func(*int) æ•°æ®ç±»å‹ï¼Œè¿›è¡Œå‡½æ•°èµ‹å€¼ï¼Œä¼šä½¿ä¼ é€’çš„å½¢å‚é€ƒé€¸ package main import \"fmt\" func f(a *int) { fmt.Printf(\"%v\\n\", *a) return } func main() { a := 10 fn := f fn(\u0026a) fmt.Printf(\"a = %v\\n\", a) } $ go build -v -gcflags='-m' ./main.go # command-line-arguments ./main.go:6:12: inlining call to fmt.Printf ./main.go:14:12: inlining call to fmt.Printf ./main.go:5:8: a does not escape ./main.go:6:12: ... argument does not escape ./main.go:6:21: *a escapes to heap ./main.go:14:12: ... argument does not escape ./main.go:14:25: a escapes to heap ","date":"2024-05-19","objectID":"/posts/golang-escape-analysis/:2:6","tags":["Golang","é€ƒé€¸åˆ†æ","Escape Analysis","Heap","Stack"],"title":"æ·±å…¥æ¢è®¨ Golang Escape Analysis","uri":"/posts/golang-escape-analysis/"},{"categories":["Golang","GMP","Goroutine","Machine","Process"],"content":" å¯¼è¯­ Go çš„è°ƒåº¦æµç¨‹æœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ªç”Ÿäº§-æ¶ˆè´¹æµç¨‹. ","date":"2024-05-15","objectID":"/posts/golang-gmp/:0:0","tags":["Golang","GMP","Goroutine","Machine","Process"],"title":"æ·±å…¥ç†è§£ Golang GMP","uri":"/posts/golang-gmp/"},{"categories":["Golang","GMP","Goroutine","Machine","Process"],"content":"I. Processã€Threadã€Co-routine ","date":"2024-05-15","objectID":"/posts/golang-gmp/:1:0","tags":["Golang","GMP","Goroutine","Machine","Process"],"title":"æ·±å…¥ç†è§£ Golang GMP","uri":"/posts/golang-gmp/"},{"categories":["Golang","GMP","Goroutine","Machine","Process"],"content":"è¿›ç¨‹ Process åœ¨æ“ä½œç³»ç»Ÿä¸­ï¼Œè¿›ç¨‹ä½¿ç”¨è¿›ç¨‹æ§åˆ¶å— (PCB, Process Control Block) æ•°æ®ç»“æ„ task_struct æ¥æè¿°ï¼ŒPCB æ˜¯è¿›ç¨‹å­˜åœ¨çš„å”¯ä¸€æ ‡è¯†ã€‚ è¿›ç¨‹æ˜¯æŒ‡åœ¨ç³»ç»Ÿä¸­æ­£åœ¨è¿è¡Œçš„ä¸€ä¸ªåº”ç”¨ç¨‹åºï¼Œç¨‹åºä¸€æ—¦è¿è¡Œå°±æ˜¯è¿›ç¨‹ï¼› è¿›ç¨‹å¯ä»¥è®¤ä¸ºæ˜¯ç¨‹åºæ‰§è¡Œçš„ä¸€ä¸ªå®ä¾‹ï¼Œè¿›ç¨‹æ˜¯ç³»ç»Ÿè¿›è¡Œèµ„æºåˆ†é…çš„æœ€å°å•ä½ï¼Œä¸”æ¯ä¸ªè¿›ç¨‹æ‹¥æœ‰ç‹¬ç«‹çš„åœ°å€ç©ºé—´ï¼› ä¸€ä¸ªè¿›ç¨‹æ— æ³•ç›´æ¥è®¿é—®åˆ°å¦ä¸€ä¸ªè¿›ç¨‹çš„å˜é‡å’Œæ•°æ®ç»“æ„ï¼Œå¦‚æœå¸Œæœ›ä¸€ä¸ªè¿›ç¨‹å»è®¿é—®å¦ä¸€ä¸ªè¿›ç¨‹çš„èµ„æºï¼Œéœ€è¦ä½¿ç”¨è¿›ç¨‹é—´çš„é€šä¿¡ï¼Œå¦‚fifoã€pipeã€signalã€socket ç­‰ï¼› è¿›ç¨‹è°ƒåº¦ç®—æ³•ï¼šå…ˆæ¥å…ˆæœåŠ¡è°ƒåº¦ç®—æ³•ã€çŸ­ä½œä¸šä¼˜å…ˆè°ƒåº¦ç®—æ³•ã€æœ€çŸ­å‰©ä½™ä½œä¸šä¼˜å…ˆè°ƒåº¦ç®—æ³•ã€æœ€é«˜å“åº”æ¯”ä¼˜å…ˆè°ƒåº¦ç®—æ³•ã€æœ€é«˜ä¼˜å…ˆçº§ä¼˜å…ˆè°ƒåº¦ç®—æ³•ã€æ—¶é—´ç‰‡è½®è½¬ç®—æ³•ï¼ˆå…¬å¹³è°ƒåº¦ï¼Œ$20 - 50 ms$ï¼‰ã€å¤šçº§åé¦ˆé˜Ÿåˆ—è°ƒåº¦ç®—æ³•($æœ€é«˜ä¼˜å…ˆçº§ + æ—¶é—´ç‰‡è½®è½¬$)ï¼› ","date":"2024-05-15","objectID":"/posts/golang-gmp/:1:1","tags":["Golang","GMP","Goroutine","Machine","Process"],"title":"æ·±å…¥ç†è§£ Golang GMP","uri":"/posts/golang-gmp/"},{"categories":["Golang","GMP","Goroutine","Machine","Process"],"content":"çº¿ç¨‹ Thread ç”¨æˆ·æ€çº¿ç¨‹ï¼Œæ˜¯åŸºäºç”¨æˆ·æ€çš„çº¿ç¨‹ç®¡ç†åº“æ¥å®ç°çš„ï¼Œçº¿ç¨‹æ§åˆ¶å— (Thread Control Block) ä¹Ÿæ˜¯åœ¨åº“é‡Œå®ç°ï¼Œæ“ä½œç³»ç»Ÿåªèƒ½çœ‹åˆ°æ•´ä¸ªè¿›ç¨‹çš„PCBï¼Œå³è¿›ç¨‹ä¸ç”¨æˆ·çº¿ç¨‹å±äºå¤šå¯¹ä¸€çš„æ¨¡å‹ã€‚ å†…æ ¸æ€çº¿ç¨‹(Thread)ï¼Œæ˜¯ç”±æ“ä½œç³»ç»Ÿç®¡ç†ï¼Œå¯¹åº”çš„ TCB å­˜å‚¨åœ¨æ“ä½œç³»ç»Ÿé‡Œï¼Œä¸”å…¶åˆ›å»ºã€é”€æ¯ã€è°ƒåº¦éƒ½ç”±æ“ä½œç³»ç»Ÿå®Œæˆï¼› è½»é‡çº§çº¿ç¨‹ LWP(Light-weight process)ï¼Œæ˜¯ç”±å†…æ ¸æ”¯æŒçš„ç”¨æˆ·çº¿ç¨‹ï¼Œä¸€ä¸ªè¿›ç¨‹å¯ä»¥æœ‰ä¸€ä¸ªæˆ–å¤šä¸ª LWPï¼Œæ¯ä¸ª LWP æ˜¯è·Ÿå†…æ ¸çº¿ç¨‹ä¸€å¯¹ä¸€æ˜ å°„çš„ï¼Œå³ LWP éƒ½æ˜¯ç”±ä¸€ä¸ªå†…æ ¸çº¿ç¨‹æ”¯æŒï¼Œè€Œä¸” LWP æ˜¯ç”±å†…æ ¸ç®¡ç†å¹¶åƒæ™®é€šè¿›ç¨‹ä¸€æ ·è¢«è°ƒåº¦ã€‚ åœ¨å¤§å¤šæ•°ç³»ç»Ÿä¸­ï¼ŒLWP å’Œ æ™®é€šè¿›ç¨‹çš„åŒºåˆ«åœ¨äºï¼ŒLWP åªæœ‰ä¸€ä¸ªæœ€å°çš„æ‰§è¡Œä¸Šä¸‹æ–‡å’Œè°ƒåº¦ç¨‹åºæ‰€éœ€çš„ç»Ÿè®¡ä¿¡æ¯ã€‚ çº¿ç¨‹æ˜¯è¿›ç¨‹çš„ä¸€ä¸ªå®ä½“ï¼Œæ˜¯è¿›ç¨‹çš„ä¸€æ¡æ‰§è¡Œè·¯å¾„ï¼› çº¿ç¨‹æ˜¯æ¯”è¿›ç¨‹æ›´å°çš„ç‹¬ç«‹è¿è¡Œçš„åŸºæœ¬å•ä½ ä¸€ä¸ªç¨‹åºè‡³å°‘å­˜åœ¨ä¸€ä¸ªè¿›ç¨‹ï¼Œä¸€ä¸ªè¿›ç¨‹å¯ä»¥æœ‰å¤šä¸ª($\u003e=1$)çº¿ç¨‹ è¿›ç¨‹ä¸çº¿ç¨‹çš„åŒºåˆ« è¿›ç¨‹æ˜¯èµ„æºï¼ˆåŒ…æ‹¬å†…å­˜ã€æ‰“å¼€çš„æ–‡ä»¶ç­‰ï¼‰åˆ†é…çš„å•ä½ï¼Œçº¿ç¨‹æ˜¯ CPU è°ƒåº¦çš„å•ä½ï¼› è¿›ç¨‹æ‹¥æœ‰ä¸€ä¸ªå®Œæ•´çš„èµ„æºå¹³å°ï¼Œè€Œçº¿ç¨‹åªç‹¬äº«å¿…ä¸å¯å°‘çš„èµ„æºï¼Œå¦‚å¯„å­˜å™¨å’Œæ ˆï¼› åŒä¸€è¿›ç¨‹çš„çº¿ç¨‹å…±äº«æœ¬è¿›ç¨‹çš„åœ°å€ç©ºé—´ï¼Œè€Œè¿›ç¨‹ä¹‹é—´åˆ™æ˜¯ç‹¬ç«‹çš„åœ°å€ç©ºé—´ï¼› åŒä¸€è¿›ç¨‹å†…çš„çº¿ç¨‹å…±äº«æœ¬åœ°çš„èµ„æºï¼Œä½†æ˜¯è¿›ç¨‹ä¹‹é—´çš„èµ„æºæ˜¯ç‹¬ç«‹çš„ï¼› ä¸€ä¸ªè¿›ç¨‹å´©æºƒåï¼Œåœ¨ä¿æŠ¤æ¨¡å¼ä¸‹ä¸ä¼šå¯¹å…¶ä»–è¿›ç¨‹äº§ç”Ÿå½±å“ï¼Œä½†æ˜¯ä¸€ä¸ªçº¿ç¨‹å´©æºƒæ•´ä¸ªè¿›ç¨‹å´©æºƒï¼Œå³å¤šè¿›ç¨‹æ¯”å¤šçº¿ç¨‹å¥å£®ï¼› è¿›ç¨‹åˆ‡æ¢ï¼Œæ¶ˆè€—çš„èµ„æºå¤§ï¼ˆä¸»è¦æ˜¯è™šæ‹Ÿåœ°å€ç©ºé—´çš„åˆ‡æ¢å¼€é”€ï¼‰ï¼Œçº¿ç¨‹åŒæ ·å…·æœ‰å°±ç»ªã€é˜»å¡ã€æ‰§è¡Œä¸‰ç§åŸºæœ¬çŠ¶æ€ï¼ŒåŒæ ·å…·æœ‰çŠ¶æ€ä¹‹é—´çš„è½¬æ¢å…³ç³»ï¼› å¤šè¿›ç¨‹ã€å¤šçº¿ç¨‹éƒ½å¯ä»¥å¹¶å‘æ‰§è¡Œï¼Œçº¿ç¨‹èƒ½å‡å°‘å¹¶å‘æ‰§è¡Œçš„æ—¶é—´å’Œç©ºé—´å¼€é”€ï¼› æ¯ä¸ªç‹¬ç«‹çš„è¿›ç¨‹æœ‰ä¸€ä¸ªç¨‹åºå…¥å£ã€ç¨‹åºå‡ºå£ï¼›çº¿ç¨‹ä¸èƒ½ç‹¬ç«‹è¿è¡Œï¼Œå¿…é¡»ä¾å­˜äºåº”ç”¨ç¨‹åºä¸­ï¼Œæœ‰åº”ç”¨ç¨‹åºæä¾›å¤šä¸ªçº¿ç¨‹æ‰§è¡Œæ§åˆ¶ï¼› ","date":"2024-05-15","objectID":"/posts/golang-gmp/:1:2","tags":["Golang","GMP","Goroutine","Machine","Process"],"title":"æ·±å…¥ç†è§£ Golang GMP","uri":"/posts/golang-gmp/"},{"categories":["Golang","GMP","Goroutine","Machine","Process"],"content":"åç¨‹ Co-routine åç¨‹ï¼Œåˆç§° â€œå¾®çº¿ç¨‹â€ï¼Œè¡¨ç°ä¸ºä¸€ä¸ªå¯ä»¥ suspend å’Œ resume çš„å‡½æ•°ã€‚ å®ç°åç¨‹çš„å…³é”®ç‚¹ï¼šåœ¨äºå¦‚ä½•ä¿å­˜ã€æ¢å¤å’Œåˆ‡æ¢ä¸Šä¸‹æ–‡ï¼Œåç¨‹åˆ‡æ¢åªæ¶‰åŠåŸºæœ¬çš„CPUä¸Šä¸‹æ–‡åˆ‡æ¢ï¼ˆCPUå¯„å­˜å™¨ï¼‰. æ‰€æœ‰çš„åç¨‹å…±ç”¨çš„éƒ½æ˜¯ä¸€ä¸ªæ ˆï¼Œå³ç³»ç»Ÿæ ˆï¼Œä¹Ÿå°±ä¹Ÿä¸å¿…æˆ‘ä»¬è‡ªè¡Œå»ç»™åç¨‹åˆ†é…æ ˆï¼Œå› ä¸ºæ˜¯å‡½æ•°è°ƒç”¨ï¼Œæˆ‘ä»¬å½“ç„¶ä¹Ÿä¸å¿…å»æ˜¾ç¤ºçš„ä¿å­˜å¯„å­˜å™¨çš„å€¼ï¼› Co-routine åˆ†ç±» æœ‰æ ˆ (stackful) åç¨‹ï¼šå®ç°ç±»ä¼¼äºå†…æ ¸æ€çº¿ç¨‹çš„å®ç°ï¼Œä¸åŒåç¨‹çš„åˆ‡æ¢è¿˜æ˜¯è¦åˆ‡æ¢å¯¹åº”çš„æ ˆä¸Šä¸‹æ–‡ï¼Œåªæ˜¯ä¸ç”¨é™·å…¥å†…æ ¸ï¼Œä¾‹å¦‚ goroutineã€libco æ— æ ˆ (stackless) åç¨‹ï¼šæ— æ ˆåç¨‹çš„ä¸Šä¸‹æ–‡éƒ½ä¼šæ”¾åˆ°å…¬å…±å†…å­˜ä¸­ï¼Œåœ¨åç¨‹åˆ‡æ¢æ—¶ä½¿ç”¨çŠ¶æ€æœºæ¥åˆ‡æ¢ï¼Œè€Œä¸ç”¨åˆ‡æ¢å¯¹åº”çš„ä¸Šä¸‹æ–‡ï¼ˆéƒ½å·²ç»åœ¨å †ä¸­ï¼‰ï¼Œç›¸æ¯”æœ‰æ ˆåç¨‹æ›´è½»é‡ï¼Œä¾‹å¦‚ C++20ã€Rustã€JavaScriptï¼›==æœ¬è´¨å°±æ˜¯ä¸€ä¸ªçŠ¶æ€æœºï¼ˆstate machineï¼‰ï¼Œå³åŒä¸€åç¨‹åç¨‹çš„åˆ‡æ¢æœ¬è´¨ä¸è¿‡æ˜¯æŒ‡ä»¤æŒ‡é’ˆå¯„å­˜å™¨çš„æ”¹å˜== Co-routine ç‰¹ç‚¹ ä¸€ä¸ªçº¿ç¨‹å¯ä»¥æœ‰å¤šä¸ªåç¨‹ï¼›åç¨‹ä¸æ˜¯è¢«æ“ä½œç³»ç»Ÿå†…æ ¸ç®¡ç†ï¼Œè€Œæ˜¯å®Œå…¨ç”±ç¨‹åºæ§åˆ¶ï¼› åç¨‹çš„å¼€é”€è¿œè¿œå°äºçº¿ç¨‹ï¼›åç¨‹æ‹¥æœ‰è‡ªå·±çš„å¯„å­˜å™¨ä¸Šä¸‹æ–‡å’Œæ ˆï¼Œåœ¨è¿›è¡Œåç¨‹è°ƒåº¦æ—¶ï¼Œå°†å¯„å­˜å™¨ä¸Šä¸‹æ–‡å’Œæ ˆä¿å­˜åˆ°å…¶ä»–åœ°æ–¹ï¼Œåœ¨åˆ‡æ¢å›æ¥æ—¶æ¢å¤å…ˆå‰ä¿å­˜çš„å¯„å­˜å™¨ä¸Šä¸‹æ–‡å’Œæ ˆï¼› æ¯ä¸ªåç¨‹è¡¨ç¤ºä¸€ä¸ªæ‰§è¡Œå•å…ƒï¼Œæœ‰è‡ªå·±çš„æœ¬åœ°æ•°æ®ï¼Œä¸å…¶ä»–åç¨‹å…±äº«å…¨å±€æ•°æ®å’Œå…¶ä»–èµ„æºï¼› è·¨å¹³å°ã€è·¨ä½“ç³»æ¶æ„ã€æ— éœ€çº¿ç¨‹ä¸Šä¸‹æ–‡åˆ‡æ¢çš„å¼€é”€ã€æ–¹ä¾¿åˆ‡æ¢æ§åˆ¶æµï¼Œç®€åŒ–ç¼–ç¨‹æ¨¡å‹ï¼› åç¨‹çš„æ‰§è¡Œæ•ˆç‡æé«˜ï¼Œå’Œå¤šçº¿ç¨‹ç›¸æ¯”ï¼Œçº¿ç¨‹æ•°é‡è¶Šå¤šï¼Œåç¨‹çš„æ€§èƒ½ä¼˜åŠ¿è¶Šæ˜æ˜¾ï¼› ","date":"2024-05-15","objectID":"/posts/golang-gmp/:1:3","tags":["Golang","GMP","Goroutine","Machine","Process"],"title":"æ·±å…¥ç†è§£ Golang GMP","uri":"/posts/golang-gmp/"},{"categories":["Golang","GMP","Goroutine","Machine","Process"],"content":"II. GMP Golang ä¸ºæä¾›æ›´åŠ å®¹æ˜“ä½¿ç”¨çš„å¹¶å‘å·¥å…·ï¼ŒåŸºäº GMP æ¨¡å‹å®ç°äº† goroutine å’Œ channelã€‚ Goroutine å±äº Co-routine çš„æ¦‚å¿µï¼Œéå¸¸è½»é‡ï¼Œä¸€ä¸ª goroutine åˆå§‹ç©ºé—´åªå å‡  KB ä¸”å¯ä¼¸ç¼©ï¼Œä½¿å¾—åœ¨æœ‰é™ç©ºé—´å†…æ”¯æŒå¤§é‡ goroutine å¹¶å‘ã€‚ Channel å¯ä»¥ç‹¬ç«‹åˆ›å»ºå’Œå­˜å–ï¼Œåœ¨ä¸åŒçš„ Goroutine ä¸­ä¼ é€’ä½¿ç”¨ï¼Œä½œä¸ºé˜Ÿåˆ—ï¼Œéµå¾ª FIFO åŸåˆ™ï¼ŒåŒæ—¶ä¿è¯åŒä¸€æ—¶åˆ»åªèƒ½æœ‰ä¸€ä¸ª goroutine è®¿é—®ã€‚ channel ä½œä¸ºä¸€ç§å¼•ç”¨ç±»å‹ï¼Œå£°æ˜æ—¶éœ€è¦æŒ‡å®šä¼ è¾“æ•°æ®ç±»å‹ï¼Œå£°æ˜å½¢å¼å¦‚ä¸‹(T æ˜¯ channel å¯ä¼ è¾“çš„æ•°æ®ç±»å‹)ï¼š // å£°æ˜ channel var ch chan T // åŒå‘ channel var ch chan\u003c- T // åªèƒ½å‘é€ msg çš„ channel var ch \u003c-chan T // åªèƒ½æ¥æ”¶ msg çš„ channel // åˆ›å»º channel ch := make(chan T, capicity) // åŒå‘ channel ch := make(chan\u003c- T, capicity) // åªèƒ½å‘é€ msg çš„ channel ch := make(\u003c-chan T, capicity) // åªèƒ½æ¥æ”¶ msg çš„ channel // è®¿é—® channel ch \u003c- msg // å‘é€ msg msg := \u003c-ch // æ¥æ”¶ msg msg, ok := \u003c-ch // æ¥æ”¶ msgï¼ŒåŒæ—¶åˆ¤æ–­ channel æ˜¯å¦æ¥æ”¶æˆåŠŸ close(ch) // å…³é—­ channel ","date":"2024-05-15","objectID":"/posts/golang-gmp/:2:0","tags":["Golang","GMP","Goroutine","Machine","Process"],"title":"æ·±å…¥ç†è§£ Golang GMP","uri":"/posts/golang-gmp/"},{"categories":["Golang","GMP","Goroutine","Machine","Process"],"content":"Golang è°ƒåº¦ è°ƒåº¦ç»„ä»¶ Gï¼šGoroutineï¼Œä¸€ä¸ªè®¡ç®—ä»»åŠ¡. ç”±éœ€è¦æ‰§è¡Œçš„ä»£ç å’Œå…¶ä¸Šä¸‹æ–‡ç»„æˆï¼Œä¸Šä¸‹æ–‡åŒ…æ‹¬ï¼šå½“å‰ä»£ç ä½ç½®ã€æ ˆç©ºé—´(åˆå§‹2Kï¼Œå¯å¢é•¿)ã€çŠ¶æ€ç­‰ã€‚ Mï¼šMachineï¼Œç³»ç»Ÿçº¿ç¨‹ï¼Œæ‰§è¡Œå®ä½“ã€‚ä¸ C è¯­è¨€ä¸­çš„çº¿ç¨‹ç›¸åŒï¼Œé€šè¿‡ clone åˆ›å»ºã€‚ P: Processorï¼Œè™šæ‹Ÿå¤„ç†å™¨ï¼ŒåŒ…å«äº† G è¿è¡Œæ‰€éœ€çš„èµ„æºï¼Œå› æ­¤ M å¿…é¡»è·å¾— P æ‰èƒ½æ‰§è¡Œä»£ç ï¼Œå¦åˆ™å¿…é¡»é™·å…¥ä¼‘çœ ï¼ˆåå°ç›‘æ§çº¿ç¨‹é™¤å¤–ï¼‰ã€‚å¯ç†è§£ä¸ºä¸€ç§ tokenï¼Œæœ‰è¿™ä¸ª tokenï¼Œæ‰æœ‰åœ¨ç‰©ç† CPU æ ¸å¿ƒä¸Šæ‰§è¡Œçš„æƒé™ã€‚ ç›¸å…³æ•°æ®ç»“æ„å®šä¹‰å¦‚ä¸‹ï¼š g çš„æ•°æ®ç»“æ„ï¼š type g struct { // Stack parameters. // stack describes the actual stack memory: [stack.lo, stack.hi). // stackguard0 is the stack pointer compared in the Go stack growth prologue. // It is stack.lo+StackGuard normally, but can be StackPreempt to trigger a preemption. // stackguard1 is the stack pointer compared in the //go:systemstack stack growth prologue. // It is stack.lo+StackGuard on g0 and gsignal stacks. // It is ~0 on other goroutine stacks, to trigger a call to morestackc (and crash). stack stack // offset known to runtime/cgo stackguard0 uintptr // offset known to liblink stackguard1 uintptr // offset known to liblink _panic *_panic // innermost panic - offset known to liblink _defer *_defer // innermost defer m *m // current m; offset known to arm liblink sched gobuf syscallsp uintptr // if status==Gsyscall, syscallsp = sched.sp to use during gc syscallpc uintptr // if status==Gsyscall, syscallpc = sched.pc to use during gc stktopsp uintptr // expected sp at top of stack, to check in traceback // param is a generic pointer parameter field used to pass // values in particular contexts where other storage for the // parameter would be difficult to find. It is currently used // in four ways: // 1. When a channel operation wakes up a blocked goroutine, it sets param to // point to the sudog of the completed blocking operation. // 2. By gcAssistAlloc1 to signal back to its caller that the goroutine completed // the GC cycle. It is unsafe to do so in any other way, because the goroutine's // stack may have moved in the meantime. // 3. By debugCallWrap to pass parameters to a new goroutine because allocating a // closure in the runtime is forbidden. // 4. When a panic is recovered and control returns to the respective frame, // param may point to a savedOpenDeferState. param unsafe.Pointer atomicstatus atomic.Uint32 stackLock uint32 // sigprof/scang lock; TODO: fold in to atomicstatus goid uint64 schedlink guintptr waitsince int64 // approx time when the g become blocked waitreason waitReason // if status==Gwaiting preempt bool // preemption signal, duplicates stackguard0 = stackpreempt preemptStop bool // transition to _Gpreempted on preemption; otherwise, just deschedule preemptShrink bool // shrink stack at synchronous safe point // asyncSafePoint is set if g is stopped at an asynchronous // safe point. This means there are frames on the stack // without precise pointer information. asyncSafePoint bool paniconfault bool // panic (instead of crash) on unexpected fault address gcscandone bool // g has scanned stack; protected by _Gscan bit in status throwsplit bool // must not split stack // activeStackChans indicates that there are unlocked channels // pointing into this goroutine's stack. If true, stack // copying needs to acquire channel locks to protect these // areas of the stack. activeStackChans bool // parkingOnChan indicates that the goroutine is about to // park on a chansend or chanrecv. Used to signal an unsafe point // for stack shrinking. parkingOnChan atomic.Bool // inMarkAssist indicates whether the goroutine is in mark assist. // Used by the execution tracer. inMarkAssist bool coroexit bool // argument to coroswitch_m raceignore int8 // ignore race detection events nocgocallback bool // whether disable callback from C tracking bool // whether we're tracking this G for sched latency statistics trackingSeq uint8 // used to decide whether to track this G trackingStamp int64 // timestamp of when the G last started being tracked runnableTime int64 // the amount of time spent runnable, cleared when running, only used when tracking lockedm muintptr sig uint32 writebuf []byte sigcode0 uintptr sigcode1 uintptr sigpc uintptr parentGoid uint64 // goid of g","date":"2024-05-15","objectID":"/posts/golang-gmp/:2:1","tags":["Golang","GMP","Goroutine","Machine","Process"],"title":"æ·±å…¥ç†è§£ Golang GMP","uri":"/posts/golang-gmp/"},{"categories":["Golang","GMP","Goroutine","Machine","Process"],"content":"Goroutine åˆ‡æ¢æˆæœ¬ gobuf æè¿°äº†ä¸€ä¸ª Goroutine æ‰€æœ‰ç°åœºï¼Œä»ä¸€ä¸ª g åˆ‡æ¢åˆ°å¦ä¸€ä¸ª gï¼Œåªè¦æŠŠè¿™å‡ ä¸ªç°åœºå­—æ®µä¿å­˜ä¸‹æ¥ï¼Œå†å°† g å…¥é˜Ÿï¼ŒM å°±å¯ä»¥æ‰§è¡Œå…¶ä»– g äº†ï¼Œæ— éœ€è¿›å…¥å†…æ ¸æ€ã€‚ gobuf æ•°æ®ç»“æ„å¦‚ä¸‹ type gobuf struct { // The offsets of sp, pc, and g are known to (hard-coded in) libmach. // // ctxt is unusual with respect to GC: it may be a // heap-allocated funcval, so GC needs to track it, but it // needs to be set and cleared from assembly, where it's // difficult to have write barriers. However, ctxt is really a // saved, live register, and we only ever exchange it between // the real register and the gobuf. Hence, we treat it as a // root during stack scanning, which means assembly that saves // and restores it doesn't need write barriers. It's still // typed as a pointer so that any other writes from Go get // write barriers. sp uintptr pc uintptr g guintptr ctxt unsafe.Pointer ret uintptr lr uintptr bp uintptr // for framepointer-enabled architectures } ","date":"2024-05-15","objectID":"/posts/golang-gmp/:2:2","tags":["Golang","GMP","Goroutine","Machine","Process"],"title":"æ·±å…¥ç†è§£ Golang GMP","uri":"/posts/golang-gmp/"},{"categories":["Golang","GMP","Goroutine","Machine","Process"],"content":"runtime å¯æ‹¦æˆª goroutine é˜»å¡åœºæ™¯è§£æ Goroutine å±äºåç¨‹çš„ä¸€ç§ï¼Œå› æ­¤å­˜åœ¨è¿è¡Œæ€ã€é˜»å¡æ€ç­‰å„ç§çŠ¶æ€ã€‚ é‚£ä¹ˆ goroutine ä»€ä¹ˆæƒ…å†µä¸‹ä¼šå‘ç”Ÿé˜»å¡ï¼Ÿ å½“ goroutine å‘ç”Ÿé˜»å¡æ—¶ï¼ŒGMP æ¨¡å‹å¦‚ä½•åº”å¯¹ï¼Ÿ æ˜¾ç„¶ï¼Œå½“ goroutine å‘ç”Ÿå¯è¢« runtime æ‹¦æˆªçš„é˜»å¡æ—¶ï¼ŒGMP æ¨¡å‹å¹¶ä¸ä¼šé˜»å¡è°ƒåº¦å¾ªç¯ï¼Œ è€Œæ˜¯æŠŠ goroutine æŒ‚èµ·ï¼Œå³è®© g å…ˆè¿›æŸä¸ªæ•°æ®ç»“æ„ï¼Œå¾… ready ååœ¨ç»§ç»­æ‰§è¡Œï¼Œå¹¶ä¸ä¼šå ç”¨çº¿ç¨‹ï¼Œ åŒæ—¶çº¿ç¨‹ä¼šè¿›å…¥ scheduleï¼Œç»§ç»­æ¶ˆè´¹é˜Ÿåˆ—ï¼Œæ‰§è¡Œå…¶ä»–çš„ g. åœºæ™¯ I: å»¶è¿Ÿ package main import ( \"fmt\" \"time\" ) func main() { fmt.Println(\"Before: \", time.Now()) time.Sleep(30 * time.Minute) fmt.Println(\"After: \", time.Now()) } å‡½æ•°è°ƒç”¨é“¾å¦‚ä¸‹ï¼š time.Sleep -\u003e runtime.timeSleep { ... gp := getg() t := gp.timer ... t.arg = gp ... } -\u003e gopark(resetForSleep, unsafe.Pointer(t), waitReasonSleep, traceBlockSleep, 1) æ˜¾ç„¶ï¼Œåœ¨ runtime.timeSleep å‡½æ•°ä¸­ï¼Œè·å–åˆ°çš„å½“å‰ g è¢«æŒ‚åœ¨ runtime.timer.arg ä¸Šï¼Œç„¶åè¢«æŒ‚èµ·ã€‚ åœºæ™¯ II: Channel send / recv (chan / select) package main import ( \"fmt\" \"sync\" \"time\" ) func main() { var ch = make(chan int) var wg = sync.WaitGroup{} wg.Add(2) go func(ch chan\u003c- int) { defer close(ch) defer wg.Done() time.Sleep(time.Second) ch \u003c- 1 }(ch) go func(ch \u003c-chan int) { defer wg.Done() val := \u003c-ch fmt.Println(val) }(ch) wg.Wait() } å‡½æ•° ch\u003c- è°ƒç”¨é“¾å¦‚ä¸‹ï¼š ch\u003c- -\u003e runtime.chansend1 -\u003e runtime.chansend { ... gp := getg() mysg := acquireSudog() ... gp.waiting = mysg gp.param = nil c.sendq.enqueue(mysg) // Signal to anyone trying to shrink our stack that we're about // to park on a channel. The window between when this G's status // changes and when we set gp.activeStackChans is not safe for // stack shrinking. gp.parkingOnChan.Store(true) gopark(chanparkcommit, unsafe.Pointer(\u0026c.lock), waitReasonChanSend, traceBlockChanSend, 2) ... } -\u003e gopark å‡½æ•° ch\u003c- è°ƒç”¨é“¾å¦‚ä¸‹ï¼š \u003c-ch -\u003e runtime.chanrecv1(c *hchan, elem unsafe.Pointer) -\u003e runtime.chanrecv(c *hchan, ep unsafe.Pointer, block bool) (selected, received bool) { ... // no sender available: block on this channel. gp := getg() mysg := acquireSudog() ... gp.waiting = mysg mysg.g = gp ... c.recvq.enqueue(mysg) // Signal to anyone trying to shrink our stack that we're about // to park on a channel. The window between when this G's status // changes and when we set gp.activeStackChans is not safe for // stack shrinking. gp.parkingOnChan.Store(true) gopark(chanparkcommit, unsafe.Pointer(\u0026c.lock), waitReasonChanReceive, traceBlockChanRecv, 2) } -\u003e runtime.gopark(unlockf func(*g, unsafe.Pointer) bool, lock unsafe.Pointer, reason waitReason, traceReason traceBlockReason, traceskip int) æ ¹æ®è°ƒç”¨é“¾å¯çŸ¥ï¼Œg è¢«å°è£…è¿› sudog ä¸­ï¼Œç„¶åæŒ‚åœ¨äº† hchan.sendq é“¾è¡¨ä¸Šã€‚ ç›¸å…³æ•°æ®ç»“æ„ sudog, sendq å¦‚ä¸‹ï¼š sudog çš„æ•°æ®ç»“æ„ï¼š // sudog (pseudo-g) represents a g in a wait list, such as for sending/receiving // on a channel. // // sudog is necessary because the g â†” synchronization object relation // is many-to-many. A g can be on many wait lists, so there may be // many sudogs for one g; and many gs may be waiting on the same // synchronization object, so there may be many sudogs for one object. // // sudogs are allocated from a special pool. Use acquireSudog and // releaseSudog to allocate and free them. type sudog struct { // The following fields are protected by the hchan.lock of the // channel this sudog is blocking on. shrinkstack depends on // this for sudogs involved in channel ops. g *g next *sudog prev *sudog elem unsafe.Pointer // data element (may point to stack) // The following fields are never accessed concurrently. // For channels, waitlink is only accessed by g. // For semaphores, all fields (including the ones above) // are only accessed when holding a semaRoot lock. acquiretime int64 releasetime int64 ticket uint32 // isSelect indicates g is participating in a select, so // g.selectDone must be CAS'd to win the wake-up race. isSelect bool // success indicates whether communication over channel c // succeeded. It is true if the goroutine was awoken because a // value was delivered over channel c, and false if awoken // because c was closed. success bool // waiters is a count of semaRoot waiting list other than head of list, // clamped to a uint16 to fit in unused space. // Only meaningful at the head of the list. // (If we wanted to be overly clever, we could store a high 16 bits // in the se","date":"2024-05-15","objectID":"/posts/golang-gmp/:2:3","tags":["Golang","GMP","Goroutine","Machine","Process"],"title":"æ·±å…¥ç†è§£ Golang GMP","uri":"/posts/golang-gmp/"},{"categories":["Golang","GMP","Goroutine","Machine","Process"],"content":"runtime ä¸å¯æ‹¦æˆª goroutine é˜»å¡åœºæ™¯è§£æ time.Sleep / channel send / channel recv / select / net read / net write / sync.Mutex ç­‰é˜»å¡åœºæ™¯å¯è¢« runtime æ‹¦æˆªï¼Œç„¶è€Œä»å­˜åœ¨ä¸€äº›é˜»å¡æƒ…å†µæ˜¯ runtime æ— æ³•æ‹¦æˆªçš„ï¼Œä¾‹å¦‚ï¼šåœ¨æ‰§è¡Œ C ä»£ç æˆ–é˜»å¡åœ¨ syscall ä¸Šæ—¶ï¼Œå¿…é¡»å ç”¨ä¸€ä¸ªçº¿ç¨‹ã€‚ ","date":"2024-05-15","objectID":"/posts/golang-gmp/:2:4","tags":["Golang","GMP","Goroutine","Machine","Process"],"title":"æ·±å…¥ç†è§£ Golang GMP","uri":"/posts/golang-gmp/"},{"categories":["Golang","GMP","Goroutine","Machine","Process"],"content":"III. Sysmon system monitorï¼Œé«˜ä¼˜å…ˆçº§ï¼Œåœ¨ä¸“æœ‰çº¿ç¨‹ä¸­æ‰§è¡Œï¼Œä¸éœ€è¦ç»‘å®š p. ","date":"2024-05-15","objectID":"/posts/golang-gmp/:3:0","tags":["Golang","GMP","Goroutine","Machine","Process"],"title":"æ·±å…¥ç†è§£ Golang GMP","uri":"/posts/golang-gmp/"},{"categories":["Golang","GMP","Goroutine","Machine","Process"],"content":"IV. Summary Runtime æ„æˆï¼šSchedulerã€Netpollã€å†…å­˜ç®¡ç†ã€åƒåœ¾å›æ”¶ GMPï¼šM - ä»»åŠ¡æ¶ˆè´¹è€…ï¼›G - è®¡ç®—ä»»åŠ¡ï¼›P - å¯ä»¥ä½¿ç”¨ CPU çš„ token GMP ä¸­çš„é˜Ÿåˆ—æŠ½è±¡ï¼šP çš„æœ¬åœ° runnext å­—æ®µ â€“Â» P çš„ local run queue â€“Â» global run queueï¼›é‡‡ç”¨å¤šçº§é˜Ÿåˆ—å‡å°‘é”ç«äº‰ è°ƒåº¦å¾ªç¯ï¼šçº¿ç¨‹ M åœ¨æŒæœ‰ P çš„æƒ…å†µä¸‹ä¸æ–­æ¶ˆè´¹è¿è¡Œé˜Ÿåˆ—ä¸­çš„ G çš„è¿‡ç¨‹ å¤„ç†é˜»å¡ï¼š runtime å¯ä»¥æ¥ç®¡çš„é˜»å¡ï¼š channel send / recvï¼Œsync.Mutexï¼Œnet read / writeï¼Œselectï¼Œtime.Sleep æ‰€æœ‰ runtime å¯æ¥ç®¡çš„é˜»å¡éƒ½æ˜¯é€šè¿‡ gopark / goparkunlock æŒ‚èµ·ï¼Œgoready æ¢å¤ runtime ä¸å¯æ¥ç®¡çš„é˜»å¡ï¼šsyscallï¼Œcgoï¼Œé•¿æ—¶é—´è¿è¡Œéœ€è¦å‰¥ç¦» P æ‰§è¡Œï¼› sysmonï¼š ä¸€ä¸ªåå°é«˜çº§ä¼˜å…ˆçº§å¾ªç¯ï¼Œæ‰§è¡Œæ—¶ä¸éœ€è¦ç»‘å®šä»»ä½•çš„ P è´Ÿè´£ï¼š æ£€æŸ¥æ˜¯å¦å·²ç»æ²¡æœ‰æ´»åŠ¨çº¿ç¨‹ï¼Œå¦‚æœæ˜¯åˆ™å´©æºƒ è½®è¯¢ netpoll å‰¥ç¦»åœ¨ syscall ä¸Šé˜»å¡çš„ M çš„ P å‘ä¿¡å·ï¼ŒæŠ¢å å·²ç»æ‰§è¡Œæ—¶é—´è¿‡é•¿çš„ G ","date":"2024-05-15","objectID":"/posts/golang-gmp/:4:0","tags":["Golang","GMP","Goroutine","Machine","Process"],"title":"æ·±å…¥ç†è§£ Golang GMP","uri":"/posts/golang-gmp/"},{"categories":["Golang","GMP","Goroutine","Machine","Process"],"content":"V. Q \u0026 A ä¸ºä»€ä¹ˆé˜»å¡ç­‰å¾…çš„ goroutineï¼Œæœ‰æ—¶è¡¨ç°ä¸º g æœ‰æ—¶è¡¨ç°ä¸º sudog ï¼Ÿ sudog (pseudo-g) è¡¨ç¤ºç­‰å¾…åˆ—è¡¨ä¸­çš„ gï¼Œä¾‹å¦‚ç”¨äºåœ¨ channel ä¸Šçš„ send/recv. g ä¸åŒæ­¥å¯¹è±¡æ˜¯å¤šå¯¹å¤šçš„å…³ç³»: ä¸€ä¸ª g å¯ä»¥å‡ºç°åœ¨å¤šä¸ªç­‰å¾…åˆ—è¡¨ä¸­ï¼Œå› æ­¤ä¸€ä¸ª g å¯èƒ½æœ‰å¤šä¸ª sudogï¼› å¾ˆå¤š g å¯èƒ½åœ¨ç­‰å¾…åŒä¸€ä¸ªåŒæ­¥å¯¹è±¡ï¼Œå› æ­¤ä¸€ä¸ªå¯¹è±¡å¯èƒ½æœ‰å¾ˆå¤š sudog ä¸€ä¸ª g å¯èƒ½å¯¹åº”å¤šä¸ª sudogï¼Œæ¯”å¦‚ä¸€ä¸ª g ä¼šåŒæ—¶ select å¤šä¸ª channel ","date":"2024-05-15","objectID":"/posts/golang-gmp/:5:0","tags":["Golang","GMP","Goroutine","Machine","Process"],"title":"æ·±å…¥ç†è§£ Golang GMP","uri":"/posts/golang-gmp/"},{"categories":["Golang","GMP","Goroutine","Machine","Process"],"content":"VI. Reference Golangçš„åç¨‹è°ƒåº¦å™¨åŸç†åŠGMPè®¾è®¡æ€æƒ³ Golang ç”Ÿäº§-æ¶ˆè´¹è°ƒåº¦æµç¨‹: Producer Golang ç”Ÿäº§-æ¶ˆè´¹è°ƒåº¦æµç¨‹: Consumer æç«¯æƒ…å†µä¸‹æ”¶ç¼© Go çš„çº¿ç¨‹æ•° Go Scheduler å˜æ›´å² internal/poll/fd_poll_runtime.go internal/poll/fd_unix.go net/fd_unix.go runtime/runtime2.go runtime/time.go runtime/proc.go runtime/netpoll.go runtime/netpoll_epoll.go runtime/sema.go sync/mutex.go time/sleep.go ","date":"2024-05-15","objectID":"/posts/golang-gmp/:6:0","tags":["Golang","GMP","Goroutine","Machine","Process"],"title":"æ·±å…¥ç†è§£ Golang GMP","uri":"/posts/golang-gmp/"},{"categories":["Netpoll","Epoll","Network Program","Golang","Linux"],"content":" å¯¼è¯­ æ·±å…¥å‰–æ Golang ç½‘ç»œç¼–ç¨‹ä¹‹ Netpollï¼Œä¸»è¦æ¶‰åŠ Linux ç¯å¢ƒä¸‹çš„ Epoll åˆå§‹åŒ–ã€ Go ç½‘ç»œç¼–ç¨‹åŸºæœ¬æµç¨‹ï¼ˆListenã€Acceptã€Readã€Writeï¼‰ä»¥åŠnetpoll æ‰§è¡Œæµç¨‹ Golang æºç ç‰ˆæœ¬ æœ¬æ–‡æ‰€æ¶‰åŠçš„æºç ç‰ˆæœ¬ï¼šv1.22.3 ","date":"2024-05-08","objectID":"/posts/golang-netpoll/:0:0","tags":["Netpoll","Epoll","Network Program","Golang","Linux"],"title":"Golang Netpoll","uri":"/posts/golang-netpoll/"},{"categories":["Netpoll","Epoll","Network Program","Golang","Linux"],"content":"I. åŸºç¡€æ¦‚å¿µ ç½‘ç»œç¼–ç¨‹ï¼Œæ˜¯å…è®¸ä¸åŒè®¡ç®—æœºä¸Šçš„ç¨‹åºé€šè¿‡ç½‘ç»œé€šä¿¡çš„å¼€å‘è¿‡ç¨‹ï¼Œæ¶‰åŠå¤šç§åè®®ï¼ˆHTTPã€TCP/IPç­‰ï¼‰ä»¥åŠä¸åŒç¼–ç¨‹è¯­è¨€çš„åº”ç”¨ã€‚ ","date":"2024-05-08","objectID":"/posts/golang-netpoll/:1:0","tags":["Netpoll","Epoll","Network Program","Golang","Linux"],"title":"Golang Netpoll","uri":"/posts/golang-netpoll/"},{"categories":["Netpoll","Epoll","Network Program","Golang","Linux"],"content":"åŒæ­¥ã€å¼‚æ­¥ã€å¹¶å‘æ¨¡å‹ IO æ¨¡å‹ è¯»å†™æ“ä½œå’Œé˜»å¡é˜¶æ®µ é˜»å¡ IO ç¨‹åºé˜»å¡äºè¯»å†™å‡½æ•° IO å¤ç”¨ ç¨‹åºé˜»å¡äº IO å¤ç”¨ç³»ç»Ÿè°ƒç”¨ï¼Œä½†å¯åŒæ—¶ç›‘å¬å¤šä¸ª IO äº‹ä»¶ï¼›å¯¹ IO æœ¬èº«çš„è¯»å†™æ“ä½œæ˜¯éé˜»å¡çš„ SIGIO ä¿¡å· ä¿¡å·è§¦å‘è¯»å†™å°±ç»ªäº‹ä»¶ï¼Œç”¨æˆ·ç¨‹åºæ‰§è¡Œè¯»å†™æ“ä½œï¼›ç¨‹åºæœ¬èº«æ²¡æœ‰é˜»å¡é˜¶æ®µ å¼‚æ­¥ IO å†…æ ¸æ‰§è¡Œè¯»å†™æ“ä½œå¹¶è§¦å‘è¯»å†™å®Œæˆäº‹ä»¶ï¼›ç¨‹åºæ²¡æœ‰é˜»å¡é˜¶æ®µ ä¸»è¦ç”¨äºåŒºåˆ†å†…æ ¸å‘åº”ç”¨ç¨‹åºé€šçŸ¥çš„æ˜¯ä½•ç§ IO äº‹ä»¶ï¼ˆå°±ç»ªäº‹ä»¶ or å®Œæˆäº‹ä»¶ï¼‰ï¼Œä»¥åŠç”±è°æ¥å®Œæˆ IO è¯»å†™ï¼ˆåº”ç”¨ç¨‹åº or å†…æ ¸ï¼‰ IOæ¨¡å‹ä¸­çš„åŒæ­¥ åŒæ­¥ IO æ¨¡å‹ï¼ŒæŒ‡çš„æ˜¯åº”ç”¨ç¨‹åºå‘èµ· IO æ“ä½œåï¼Œå¿…é¡»ç­‰å¾… IO æ“ä½œå®Œæˆåæ‰èƒ½ç»§ç»­æ‰§è¡Œåç»­çš„æ“ä½œï¼Œå³ IO æ“ä½œçš„ç»“æœéœ€è¦ç«‹å³è¿”å›ç»™åº”ç”¨ç¨‹åºï¼›åœ¨æ­¤æœŸé—´ï¼Œåº”ç”¨ç¨‹åºå¤„äºé˜»å¡çŠ¶æ€ï¼Œæ— æ³•åšå…¶ä»–æ“ä½œã€‚ ä¼˜ç‚¹ï¼šç¼–ç¨‹æ¨¡å‹ç®€å• ç¼ºç‚¹ï¼šæ•ˆç‡è¾ƒä½ï¼ˆåº”ç”¨ç¨‹åºçš„æ‰§è¡Œé€Ÿåº¦è¢« IO æ“ä½œæ‰€é™åˆ¶ï¼‰ å¯¹äºæ“ä½œç³»ç»Ÿå†…æ ¸æ¥è¯´ï¼ŒåŒæ­¥ IO æ“ä½œæ˜¯æŒ‡åœ¨å†…æ ¸å¤„ç† IO è¯·æ±‚æ—¶éœ€è¦ç­‰å¾… IO æ¨¡å‹ä¸­çš„å¼‚æ­¥ å¼‚æ­¥ IO æ¨¡å‹ï¼ŒæŒ‡çš„æ˜¯åº”ç”¨ç¨‹åºå‘èµ· IO æ“ä½œåï¼Œæ— é¡»ç­‰å¾… IO æ“ä½œå®Œæˆï¼Œå¯ä»¥ç«‹å³è¿›è¡Œåç»­çš„æ“ä½œï¼›åœ¨æ­¤æœŸé—´ï¼Œæ“ä½œç³»ç»Ÿè´Ÿè´£æŠŠ IO æ“ä½œçš„ç»“æœè¿”å›ç»™åº”ç”¨ç¨‹åºï¼› ä¼˜ç‚¹ï¼šå¯ä»¥å……åˆ†åˆ©ç”¨ç³»ç»Ÿèµ„æºï¼Œæé«˜ IO æ“ä½œçš„æ•ˆç‡ ç¼ºç‚¹ï¼šç¼–ç¨‹æ¨¡å‹ç›¸å¯¹å¤æ‚ å¯¹äºæ“ä½œç³»ç»Ÿå†…æ ¸æ¥è¯´ï¼Œå¼‚æ­¥ IO æ“ä½œæŒ‡çš„æ˜¯ï¼Œåœ¨å†…æ ¸å¤„ç† IO è¯·æ±‚æ—¶æ— éœ€ç­‰å¾…ï¼Œç«‹å³è¿”å› å¹¶å‘æ¨¡å¼ å¹¶å‘æ¨¡å¼ï¼ŒæŒ‡çš„æ˜¯ I/O å¤„ç†å•å…ƒå’Œå¤šä¸ªé€»è¾‘å•å…ƒä¹‹é—´åè°ƒå®Œæˆä»»åŠ¡çš„æ–¹æ³• ","date":"2024-05-08","objectID":"/posts/golang-netpoll/:1:1","tags":["Netpoll","Epoll","Network Program","Golang","Linux"],"title":"Golang Netpoll","uri":"/posts/golang-netpoll/"},{"categories":["Netpoll","Epoll","Network Program","Golang","Linux"],"content":"Linux Epoll epoll åœ¨å†…æ ¸é‡Œä½¿ç”¨çº¢é»‘æ ‘(Red-black tree)æ¥è·Ÿè¸ªè¿›ç¨‹æ‰€æœ‰å¾…æ£€æµ‹çš„æ–‡ä»¶æè¿°å­— fdï¼ŒæŠŠéœ€è¦ç›‘æ§çš„ socket é€šè¿‡ epoll_ctl() å‡½æ•°åŠ å…¥å†…æ ¸ä¸­çš„çº¢é»‘æ ‘é‡Œï¼ˆçº¢é»‘æ ‘æ˜¯ä¸ªé«˜æ•ˆçš„æ•°æ®ç»“æ„ï¼Œå¢åˆ æ”¹ä¸€èˆ¬æ—¶é—´å¤æ‚åº¦æ˜¯ O(logn)ï¼‰ epoll ä½¿ç”¨äº‹ä»¶é©±åŠ¨çš„æœºåˆ¶ï¼Œåœ¨å†…æ ¸é‡Œç»´æŠ¤äº†ä¸€ä¸ªé“¾è¡¨(List)æ¥è®°å½•å°±ç»ªäº‹ä»¶ã€‚ å½“æŸä¸ª socket æœ‰äº‹ä»¶å‘ç”Ÿæ—¶ï¼Œå†…æ ¸é€šè¿‡å›è°ƒå‡½æ•°å°†å…¶åŠ å…¥åˆ°è¿™ä¸ªå°±ç»ªäº‹ä»¶åˆ—è¡¨ä¸­ã€‚ å½“ç”¨æˆ·è°ƒç”¨ epoll_wait() å‡½æ•°æ—¶ï¼Œåªä¼šè¿”å›æœ‰äº‹ä»¶å‘ç”Ÿçš„æ–‡ä»¶æè¿°ç¬¦çš„ä¸ªæ•°ï¼Œä¸éœ€è¦åƒ select/poll é‚£æ ·è½®è¯¢æ‰«ææ•´ä¸ª socket é›†åˆï¼Œå¤§å¤§æé«˜äº†æ£€æµ‹çš„æ•ˆç‡ ä¸¤ç§è§¦å‘æ¨¡å¼ Level triggerï¼šæœåŠ¡å™¨ç«¯ä¸æ–­åœ°ä» epoll_wait ä¸­è‹é†’ï¼Œç›´åˆ°å†…æ ¸ç¼“å†²åŒºæ•°æ®è¢« read å‡½æ•°è¯»å®Œæ‰ç»“æŸ Edge triggerï¼šæœåŠ¡å™¨ç«¯åªä¼šä» epoll_wait ä¸­è‹é†’ä¸€æ¬¡ äº‹ä»¶å® EPOLLIN è¡¨ç¤ºå¯¹åº”çš„æ–‡ä»¶æè¿°ç¬¦å¯è¯»ï¼ˆåŒ…æ‹¬å¯¹ç«¯ socket æ­£å¸¸å…³é—­ï¼‰ EPOLLOUT è¡¨ç¤ºå¯¹åº”çš„æ–‡ä»¶æè¿°ç¬¦å¯å†™ EPOLLPRI è¡¨ç¤ºå¯¹åº”çš„æ–‡ä»¶æè¿°ç¬¦æœ‰ç´§æ€¥çš„æ•°æ®å¯è¯»ï¼ˆå¸¦å¤–æ•°æ®ï¼‰ EPOLLERR è¡¨ç¤ºå¯¹åº”çš„æ–‡ä»¶æè¿°ç¬¦å‘ç”Ÿé”™è¯¯ EPOLLHUP è¡¨ç¤ºå¯¹åº”çš„æ–‡ä»¶æè¿°ç¬¦è¢«æŒ‚æ–­ EPOLLET å°† EPOLL è®¾ä¸ºè¾¹ç¼˜è§¦å‘æ¨¡å¼ï¼ˆé»˜è®¤ç”µå¹³è§¦å‘ï¼‰ EPOLLONESHOT åªç›‘å¬ä¸€æ¬¡äº‹ä»¶ï¼Œå½“ç›‘å¬å®Œè¿™æ¬¡äº‹ä»¶ä¹‹åï¼Œå¦‚æœè¿˜éœ€è¦ç»§ç»­ç›‘å¬è¿™ä¸ª socket çš„è¯ï¼Œéœ€è¦å†æ¬¡æŠŠè¿™ä¸ª socket åŠ å…¥åˆ°å†…æ ¸ä¸­çš„äº‹ä»¶æ³¨å†Œè¡¨ä¸­ ","date":"2024-05-08","objectID":"/posts/golang-netpoll/:1:2","tags":["Netpoll","Epoll","Network Program","Golang","Linux"],"title":"Golang Netpoll","uri":"/posts/golang-netpoll/"},{"categories":["Netpoll","Epoll","Network Program","Golang","Linux"],"content":"II. åº”ç”¨ç¤ºä¾‹ package main import \"net\" func main() { l, _ := net.Listen(\"tcp\", \"127.0.0.1:2333\") for { conn, _ := l.Accept() go func() { defer conn.Close() buf := make([]byte, 4096) _, _ = conn.Read(buf) conn.Write(buf) }() } } ","date":"2024-05-08","objectID":"/posts/golang-netpoll/:2:0","tags":["Netpoll","Epoll","Network Program","Golang","Linux"],"title":"Golang Netpoll","uri":"/posts/golang-netpoll/"},{"categories":["Netpoll","Epoll","Network Program","Golang","Linux"],"content":"III. ç›¸å…³æ•°æ®ç»“æ„ // src/net/fd_fake.go // Network file descriptor. type netFD struct { pfd poll.FD // immutable until Close family int sotype int isConnected bool // handshake completed or use of association with peer net string laddr Addr raddr Addr // The only networking available in WASI preview 1 is the ability to // sock_accept on a pre-opened socket, and then fd_read, fd_write, // fd_close, and sock_shutdown on the resulting connection. We // intercept applicable netFD calls on this instance, and then pass // the remainder of the netFD calls to fakeNetFD. *fakeNetFD } // poll.FD`: `src/internal/poll/fd_unix.go // FD is a file descriptor. The net and os packages use this type as a // field of a larger type representing a network connection or OS file. type FD struct { // Lock sysfd and serialize access to Read and Write methods. fdmu fdMutex // System file descriptor. Immutable until Close. Sysfd int // Platform dependent state of the file descriptor. SysFile // I/O poller. pd pollDesc // Semaphore signaled when file is closed. csema uint32 // Non-zero if this file has been set to blocking mode. isBlocking uint32 // Whether this is a streaming descriptor, as opposed to a // packet-based descriptor like a UDP socket. Immutable. IsStream bool // Whether a zero byte read indicates EOF. This is false for a // message based socket connection. ZeroReadIsEOF bool // Whether this is a file rather than a network socket. isFile bool } // Addr represents a network end point address. // // The two methods [Addr.Network] and [Addr.String] conventionally return strings // that can be passed as the arguments to [Dial], but the exact form // and meaning of the strings is up to the implementation. type Addr interface { Network() string // name of the network (for example, \"tcp\", \"udp\") String() string // string form of address (for example, \"192.0.2.1:25\", \"[2001:db8::1]:80\") } // fdMutex is a specialized synchronization primitive that manages // lifetime of an fd and serializes access to Read, Write and Close // methods on FD. type fdMutex struct { state uint64 rsema uint32 wsema uint32 } type SysFile struct { // Writev cache. iovecs *[]syscall.Iovec } type pollDesc struct { runtimeCtx uintptr } é€šè¿‡æºç å¯ä»¥çœ‹åˆ°ï¼ŒGolang ç½‘ç»œç¼–ç¨‹æ¶‰åŠåˆ°çš„ netFD, poll.FD, Addr, SysFile ä»¥åŠ pollDesc ä¹‹é—´çš„å…³ç³»å¦‚ä¸‹ï¼š fdmu æ˜¯ä¸ºäº†ä¿è¯å¯¹åŒä¸€ä¸ªæ–‡ä»¶çš„è¯»ã€å†™æ“ä½œèƒ½åˆ†åˆ«è¢«åºåˆ—åŒ– Sysfd å°±æ˜¯æ“ä½œç³»ç»Ÿä¸­ syscall è¿”å›çš„ fd å€¼ pdï¼ŒpollDesc I/O pollerï¼Œæ˜¯ Go å¯¹ poll è¿‡ç¨‹çš„ä¸€ä¸ªæŠ½è±¡ï¼Œæ‰€æœ‰å¹³å°çš„æŠ½è±¡éƒ½æ˜¯ä¸€æ ·çš„ csemaï¼Œå½“æ–‡ä»¶è¢«å…³é—­æ—¶ä¼šè¢«è§¦å‘ isBlocking è¡¨æ˜ FD æ˜¯å¦ä¸º blocking æ¨¡å¼ IsStream æ ‡å¿—è¯¥ FD æ˜¯å¦æ˜¯æµå¼ï¼Œä¸æµå¼ç›¸åçš„æ˜¯åŸºäº packet çš„ï¼Œå³ UDP socket ZeroReadIsEOFï¼Œå½“è¿æ¥è¯»åˆ° 0 é•¿åº¦æ—¶ï¼Œç”¨æ¥åŒºåˆ†æ˜¯å¦ä»£è¡¨ EOF. å¦‚æœæ˜¯åŸºäº packet çš„ socket è¿æ¥ï¼Œåˆ™å§‹ç»ˆæ˜¯ false isFile æ ‡å¿—è¯¥ FD æ˜¯å¦ä»£è¡¨æ–‡ä»¶ï¼Œè¿˜æ˜¯ç½‘ç»œè¿æ¥ netFD ç»“æ„ä¸­åŒ…å«ä¸€ä¸ª poll.FD ç±»å‹çš„æˆå‘˜ pfdï¼Œä»¥åŠ Addr æ¥å£ç±»å‹çš„ laddr å’Œ raddr poll.FD ç»“æ„å«æœ‰ SysFile å’Œ pollDesc ç±»å‹çš„æˆå‘˜ï¼Œä»¥åŠ fdMutex ç±»å‹çš„ fdmu ","date":"2024-05-08","objectID":"/posts/golang-netpoll/:3:0","tags":["Netpoll","Epoll","Network Program","Golang","Linux"],"title":"Golang Netpoll","uri":"/posts/golang-netpoll/"},{"categories":["Netpoll","Epoll","Network Program","Golang","Linux"],"content":"IV. TCP ç½‘ç»œç¼–ç¨‹åŸºæœ¬æµç¨‹ æœ¬éƒ¨åˆ†æ¶‰åŠä¼—å¤šå‡½æ•°è°ƒç”¨ï¼Œä¸ºäº†æè¿°æ¸…æ™°ï¼Œé‡‡ç”¨äº†å›¾çš„å½¢å¼ï¼Œå…¶ä¸­ï¼Œæ¯ä¸€å—ç¬¬ä¸€è¡Œè¡¨ç¤ºè¯¥å—æ‰€è¡¨ç¤ºçš„å‡½æ•°åç§°ï¼Œå…¶ä»–éƒ¨åˆ†è¡¨ç¤ºè¯¥å‡½æ•°ä¸­å…³é”®å‡½æ•°è°ƒç”¨ã€‚ ","date":"2024-05-08","objectID":"/posts/golang-netpoll/:4:0","tags":["Netpoll","Epoll","Network Program","Golang","Linux"],"title":"Golang Netpoll","uri":"/posts/golang-netpoll/"},{"categories":["Netpoll","Epoll","Network Program","Golang","Linux"],"content":"åˆ›å»º TCP socket å¹¶ç›‘å¬: net.Listen NOTE éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œåœ¨æ‰§è¡Œ net.(*netFD).listenStream ä¹‹å‰ï¼Œç”±äº maxListenerBacklog å‡½æ•°è°ƒç”¨äº† open(\"/proc/sys/net/core/somaxconn\")ï¼Œåˆ™ä¼šå¯¼è‡´ epoll åº•å±‚çº¢é»‘æ ‘çš„æå‰åˆ›å»º: runtime.netpollinit -\u003e syscall.EpollCreate1 -\u003e Syscall6(SYS_EPOLL_CREATE1, uintptr(flags), 0, 0, 0, 0, 0). å¦å¤–ï¼Œå½“å¯ç”¨ Timer æ—¶ï¼Œä¹Ÿå­˜åœ¨æå‰åˆå§‹åŒ– netpoll çš„å¯èƒ½ï¼ŒåŸå› ï¼š Timers rely on the network poller time.NewTimer -\u003e runtime.startTimer -\u003e runtime.addtimer -\u003e runtime.doaddtimer -\u003e netpollGenericInit() // doaddtimer adds t to the current P's heap. // The caller must have locked the timers for pp. func doaddtimer(pp *p, t *timer) { // Timers rely on the network poller, so make sure the poller // has started. if netpollInited.Load() == 0 { netpollGenericInit() } ... } ","date":"2024-05-08","objectID":"/posts/golang-netpoll/:4:1","tags":["Netpoll","Epoll","Network Program","Golang","Linux"],"title":"Golang Netpoll","uri":"/posts/golang-netpoll/"},{"categories":["Netpoll","Epoll","Network Program","Golang","Linux"],"content":"è·å– TCP è¿æ¥: net.(*TCPListener).Accept ","date":"2024-05-08","objectID":"/posts/golang-netpoll/:4:2","tags":["Netpoll","Epoll","Network Program","Golang","Linux"],"title":"Golang Netpoll","uri":"/posts/golang-netpoll/"},{"categories":["Netpoll","Epoll","Network Program","Golang","Linux"],"content":"TCP è¿æ¥è¯»æ•°æ®: net.(*TCPConn).Read ","date":"2024-05-08","objectID":"/posts/golang-netpoll/:4:3","tags":["Netpoll","Epoll","Network Program","Golang","Linux"],"title":"Golang Netpoll","uri":"/posts/golang-netpoll/"},{"categories":["Netpoll","Epoll","Network Program","Golang","Linux"],"content":"TCP è¿æ¥å†™æ•°æ®: net.(*TCPConn).Write ","date":"2024-05-08","objectID":"/posts/golang-netpoll/:4:4","tags":["Netpoll","Epoll","Network Program","Golang","Linux"],"title":"Golang Netpoll","uri":"/posts/golang-netpoll/"},{"categories":["Netpoll","Epoll","Network Program","Golang","Linux"],"content":"V. netpoll æ‰§è¡Œæµç¨‹: netpoll åœ¨è°ƒåº¦å’Œ GC çš„å…³é”®ç‚¹ä¸Šéƒ½ä¼šæ£€æŸ¥ä¸€æ¬¡ netpollï¼Œç¡®å®šæ˜¯å¦å­˜åœ¨ ready çŠ¶æ€çš„ FDï¼š startTheWorldWithSema // reason is the same STW reason passed to stopTheWorld. start is the start // time returned by stopTheWorld. // // now is the current time; prefer to pass 0 to capture a fresh timestamp. // // stattTheWorldWithSema returns now. func startTheWorldWithSema(now int64, w worldStop) int64 { assertWorldStopped() mp := acquirem() // disable preemption because it can be holding p in a local var if netpollinited() { list, delta := netpoll(0) // non-blocking injectglist(\u0026list) netpollAdjustWaiters(delta) } lock(\u0026sched.lock) procs := gomaxprocs if newprocs != 0 { procs = newprocs newprocs = 0 } p1 := procresize(procs) sched.gcwaiting.Store(false) if sched.sysmonwait.Load() { sched.sysmonwait.Store(false) notewakeup(\u0026sched.sysmonnote) } unlock(\u0026sched.lock) worldStarted() ... } findrunnable // Finds a runnable goroutine to execute. // Tries to steal from other P's, get g from local or global queue, poll network. // tryWakeP indicates that the returned goroutine is not normal (GC worker, trace // reader) so the caller should try to wake a P. func findRunnable() (gp *g, inheritTime, tryWakeP bool) { ... // Poll network until next timer. if netpollinited() \u0026\u0026 (netpollAnyWaiters() || pollUntil != 0) \u0026\u0026 sched.lastpoll.Swap(0) != 0 { sched.pollUntil.Store(pollUntil) if mp.p != 0 { throw(\"findrunnable: netpoll with p\") } if mp.spinning { throw(\"findrunnable: netpoll with spinning\") } delay := int64(-1) if pollUntil != 0 { if now == 0 { now = nanotime() } delay = pollUntil - now if delay \u003c 0 { delay = 0 } } if faketime != 0 { // When using fake time, just poll. delay = 0 } list, delta := netpoll(delay) // block until new work is available ... } ... } pollWork // pollWork reports whether there is non-background work this P could // be doing. This is a fairly lightweight check to be used for // background work loops, like idle GC. It checks a subset of the // conditions checked by the actual scheduler. func pollWork() bool { if sched.runqsize != 0 { return true } p := getg().m.p.ptr() if !runqempty(p) { return true } if netpollinited() \u0026\u0026 netpollAnyWaiters() \u0026\u0026 sched.lastpoll.Load() != 0 { if list, delta := netpoll(0); !list.empty() { injectglist(\u0026list) netpollAdjustWaiters(delta) return true } } return false } sysmon // Always runs without a P, so write barriers are not allowed. // //go:nowritebarrierrec func sysmon() { ... lock(\u0026sched.sysmonlock) // Update now in case we blocked on sysmonnote or spent a long time // blocked on schedlock or sysmonlock above. now = nanotime() // trigger libc interceptors if needed if *cgo_yield != nil { asmcgocall(*cgo_yield, nil) } // poll network if not polled for more than 10ms lastpoll := sched.lastpoll.Load() if netpollinited() \u0026\u0026 lastpoll != 0 \u0026\u0026 lastpoll+10*1000*1000 \u003c now { sched.lastpoll.CompareAndSwap(lastpoll, now) list, delta := netpoll(0) // non-blocking - returns list of goroutines if !list.empty() { // Need to decrement number of idle locked M's // (pretending that one more is running) before injectglist. // Otherwise it can lead to the following situation: // injectglist grabs all P's but before it starts M's to run the P's, // another M returns from syscall, finishes running its G, // observes that there is no work to do and no other running M's // and reports deadlock. incidlelocked(-1) injectglist(\u0026list) incidlelocked(1) netpollAdjustWaiters(delta) } } ... } æ ¹æ® ready çš„äº‹ä»¶æ—¶ Read æˆ– Writeï¼Œåˆ†åˆ«ä» poolDesc çš„ rgã€wg ä¸Šè·å–è¯¥å”¤é†’çš„ goroutine. ç„¶åå°†å·²ç» ready çš„ goroutine push åˆ° toRun é“¾è¡¨ï¼Œå¹¶ä¸” toRun é“¾è¡¨æœ€ç»ˆä¼šä» netpoll() è¿”å›ï¼Œé€šè¿‡ injectglist è¿›å…¥å…¨å±€é˜Ÿåˆ—. ç›¸å½“äºæ¯æ¬¡è°ƒåº¦å¾ªç¯éƒ½è¦æ‰§è¡Œ netpollï¼Œæ£€æŸ¥é¢‘ç‡è¿˜æ˜¯æ¯”è¾ƒé«˜çš„ // netpoll checks for ready network connections. // Returns list of goroutines that become runnable. // delay \u003c 0: blocks indefinitely // delay == 0: does not block, just polls // delay \u003e 0: block for up to that many nanoseconds func netpoll(delay int64) (gList, int32) { if epfd == -1 { return gList{}, 0 } var waitms int32 if delay \u003c 0 { waitms = -1 } else if ","date":"2024-05-08","objectID":"/posts/golang-netpoll/:5:0","tags":["Netpoll","Epoll","Network Program","Golang","Linux"],"title":"Golang Netpoll","uri":"/posts/golang-netpoll/"},{"categories":["Netpoll","Epoll","Network Program","Golang","Linux"],"content":"VI. æ€»ç»“ Golang é€šè¿‡å¯¹ Linux å†…æ ¸æä¾›çš„ epoll å®ç°è¿›è¡Œå°è£…ï¼Œå®ç°äº†åŒæ­¥ç¼–ç¨‹å¼‚æ­¥æ‰§è¡Œçš„æ•ˆæœï¼Œå…¶æ ¸å¿ƒæ•°æ®ç»“æ„æ˜¯ netFDï¼Œå¹¶å°† Sysfd ä¸ pollDesc ç»“æ„ç»‘å®šã€‚ å½“æŸä¸ª netFD äº§ç”Ÿ EAGAIN é”™è¯¯æ—¶ï¼Œåˆ™å½“å‰ Goroutine å°†ä¼šè¢«å­˜å‚¨åˆ°å…¶å¯¹åº”çš„ pollDesc ä¸­ï¼ŒåŒæ—¶ Goroutine ä¼š gopark()ï¼Œç›´è‡³è¿™ä¸ª netFD å†æ¬¡å‘ç”Ÿè¯»å†™äº‹ä»¶ï¼Œä¼šå°†æ­¤ Goroutine è®¾ç½®ä¸º ready å¹¶æ”¾å…¥ toRun é˜Ÿåˆ—ç­‰å¾…é‡æ–°è¿è¡Œï¼Œè€Œåº•å±‚äº‹ä»¶é€šçŸ¥æœºåˆ¶å°±æ˜¯ epoll. Golang ä¸­ netpoll çš„åˆ›å»ºä¸åˆå§‹åŒ–çš„å¯èƒ½æ¥æºï¼šTimerã€è¯»æ–‡ä»¶ã€TCP Listen. å¦‚ä¸‹çš„è°ƒåº¦å’Œ GC å…³é”®å‡½æ•° startTheWorldWithSemaã€findrunnableã€pollWorkã€sysmon éƒ½ä¼šè¿›è¡Œ netpoll æ‰§è¡Œæµç¨‹ï¼Œæ£€æŸ¥æ˜¯å¦å­˜åœ¨ ready çŠ¶æ€çš„ FD. ","date":"2024-05-08","objectID":"/posts/golang-netpoll/:6:0","tags":["Netpoll","Epoll","Network Program","Golang","Linux"],"title":"Golang Netpoll","uri":"/posts/golang-netpoll/"},{"categories":["Netpoll","Epoll","Network Program","Golang","Linux"],"content":"VII. Reference runtime/netpoll.go runtime/netpoll_epoll.go runtime/proc.go net/fd_unix.go internal/poll/fd_poll_runtime.go internal/poll/fd_unix.go ","date":"2024-05-08","objectID":"/posts/golang-netpoll/:7:0","tags":["Netpoll","Epoll","Network Program","Golang","Linux"],"title":"Golang Netpoll","uri":"/posts/golang-netpoll/"},{"categories":["Golang","Profile","Optimize"],"content":" å¯¼è¯­ Golang å¸¸è§çš„æ€§èƒ½å‰–æ (Profile) ä¸ä¼˜åŒ– (Optimize) ","date":"2024-04-20","objectID":"/posts/golang-profile/:0:0","tags":["Golang","Profile","Optimize"],"title":"Golang Profile and Optimize","uri":"/posts/golang-profile/"},{"categories":["Golang","Profile","Optimize"],"content":"I. Profile åœ¨è¿›è¡Œ API å‹æµ‹ã€å…¨é“¾è·¯å‹æµ‹ã€çº¿ä¸Šç”Ÿäº§ç¯å¢ƒè¢«é«˜å³°æµé‡æ‰“çˆ†çš„è¿‡ç¨‹ä¸­éšæ—¶å¯èƒ½å‘ç”Ÿæ•…éšœç­‰é—®é¢˜ï¼Œä¾‹å¦‚ï¼š CPU å ç”¨è¿‡é«˜ï¼Œè¶…è¿‡ 90%ï¼› å†…å­˜çˆ†æ‰ï¼ŒOOM(Out of memory)ï¼› Goroutine æ•°é‡è¿‡å¤šï¼Œ80Wï¼› çº¿ç¨‹æ•°è¶…é«˜ï¼› å»¶è¿Ÿè¿‡é«˜ï¼› åœ¨å‘ç”Ÿä»¥ä¸Šæ•…éšœæ—¶ï¼Œä¸€èˆ¬éœ€è¦ç»“åˆ pprof å¯»æ‰¾æ•…éšœåŸå› ï¼Œå¹¶æ ¹æ®ä¸åŒçš„æƒ…å†µé€‰æ‹©ä¸åŒçš„æ–¹æ¡ˆï¼› çº¿ä¸Šä¸€å®šè¦å…·æœ‰å¼€å¯ pprof çš„èƒ½åŠ›ï¼Œå¦‚æœè€ƒè™‘å®‰å…¨æ€§ï¼Œä¹Ÿè¦å…·æœ‰é€šè¿‡é…ç½®å¼€å¯çš„èƒ½åŠ›ï¼› ","date":"2024-04-20","objectID":"/posts/golang-profile/:1:0","tags":["Golang","Profile","Optimize"],"title":"Golang Profile and Optimize","uri":"/posts/golang-profile/"},{"categories":["Golang","Profile","Optimize"],"content":"å‹æµ‹æ—¶éœ€è¦å…³æ³¨çš„æœåŠ¡æŒ‡æ ‡ Request rate: The number of service requests per second. Errors: The number of request that failed. Duration: The time for requests to complete. Goroutine / Thread æ•°é‡: å¦‚æœ Goroutine æ•°é‡å¾ˆå¤šï¼Œéœ€è¦å…³æ³¨è¿™äº› Goroutine çš„æ‰§è¡Œæƒ…å†µ. GC é¢‘ç‡ gctrace çš„å†…å®¹: GC çš„ STW æ—¶é—´ è¿˜æœ‰ä¸€äº›å…¶ä»– Memstats ç›¸å…³çš„å…¶ä»–æŒ‡æ ‡ï¼Œå¯ä»¥å‚è€ƒ Prometheus. ","date":"2024-04-20","objectID":"/posts/golang-profile/:1:1","tags":["Golang","Profile","Optimize"],"title":"Golang Profile and Optimize","uri":"/posts/golang-profile/"},{"categories":["Golang","Profile","Optimize"],"content":"å‹æµ‹æ‰‹æ®µ wrk: a HTTP benchmarking tool wrk2: a HTTP benchmarking tool based mostly on wrk HEY: a tiny program that sends some load to a web application. Vegate: a versatile HTTP load testing tool built out of a need to drill HTTP services with a constant request rate. h2load: HTTP/2 benchmarking tool ghz: gRPC benchmarking and load testing tool ","date":"2024-04-20","objectID":"/posts/golang-profile/:1:2","tags":["Golang","Profile","Optimize"],"title":"Golang Profile and Optimize","uri":"/posts/golang-profile/"},{"categories":["Golang","Profile","Optimize"],"content":"pprof åº”ç”¨å®ä¾‹ package main import ( \"net/http\" _ \"net/http/pprof\" ) var quit chan struct{} = make(chan struct{}) func f() { \u003c- quit } func main() { go func() { http.ListenAndServe(\":8080\", nil) }() for i := 0; i \u003c 10000; i++ { go f() } for {} // Test } go tool pprof -http=:9999 localhost:8080/debug/pprof/heap æ³¨æ„äº‹é¡¹ æµ‹è¯•ä»£ç ä¸­å¼•å…¥ net/http/pprof åŒ…ï¼š _ \"net/http/pprof\" å•ç‹¬å¯åŠ¨ä¸€ä¸ª Goroutine å¼€å¯ç›‘å¬(ç«¯å£è‡ªå®šï¼Œä¾‹å¦‚è¿™é‡Œæ˜¯ 8080)ï¼šgo func() { http.ListenAndServe(\":8080\", nil) }() $ go tool pprof -http=:9999 localhost:8080/debug/pprof/heap ","date":"2024-04-20","objectID":"/posts/golang-profile/:1:3","tags":["Golang","Profile","Optimize"],"title":"Golang Profile and Optimize","uri":"/posts/golang-profile/"},{"categories":["Golang","Profile","Optimize"],"content":"II. Optimize ","date":"2024-04-20","objectID":"/posts/golang-profile/:2:0","tags":["Golang","Profile","Optimize"],"title":"Golang Profile and Optimize","uri":"/posts/golang-profile/"},{"categories":["Golang","Profile","Optimize"],"content":"ä¼˜åŒ–æ–¹å‘ åœ¨åˆ†æä¸Šå›¾çš„åº”ç”¨ç¨‹åºè¿è¡Œè¿‡ç¨‹ï¼Œå¯ä»¥å‘ç°è¿›è¡Œç¨‹åºä¼˜åŒ–æ—¶ï¼Œä¸€èˆ¬ä»å¯ä»¥ä»ä»¥ä¸‹æ–¹é¢å…¥æ‰‹ï¼š åº”ç”¨å±‚ä¼˜åŒ–: ä¸»è¦æŒ‡çš„æ˜¯é€»è¾‘ä¼˜åŒ–ã€å†…å­˜ä½¿ç”¨ä¼˜åŒ–ã€CPU ä½¿ç”¨ä¼˜åŒ–ã€é˜»å¡ä¼˜åŒ–ç­‰ï¼Œå¹¶ä¸”æœ¬å±‚ä¼˜åŒ–æ•ˆæœå¯èƒ½ä¼˜äºåº•å±‚ä¼˜åŒ–ï¼› åº•å±‚ä¼˜åŒ–ï¼šGCä¼˜åŒ–ã€Go æ ‡å‡†åº“ä¼˜åŒ–ã€Go runtime ä¼˜åŒ–ç­‰ ","date":"2024-04-20","objectID":"/posts/golang-profile/:2:1","tags":["Golang","Profile","Optimize"],"title":"Golang Profile and Optimize","uri":"/posts/golang-profile/"},{"categories":["Golang","Profile","Optimize"],"content":"åŸºæœ¬ä¼˜åŒ–æµç¨‹ å¤–éƒ¨ä¾èµ–ï¼šåœ¨ç›‘æ§ç³»ç»Ÿä¸­æŸ¥çœ‹æ˜¯å¦å­˜åœ¨é—®é¢˜ï¼Œä¾‹å¦‚ä¾èµ–çš„ä¸Šæ¸¸æœåŠ¡ (DB/redis/MQ) å»¶è¿Ÿè¿‡é«˜ï¼› CPU å ç”¨ï¼šé€šè¿‡æŸ¥çœ‹ CPU profile æ£€æŸ¥æ˜¯å¦å­˜åœ¨é—®é¢˜ï¼Œä¼˜åŒ–å ç”¨ CPU è¾ƒå¤šçš„éƒ¨åˆ†é€»è¾‘ï¼› å†…å­˜å ç”¨ï¼šçœ‹ Prometheusï¼Œå†…å­˜ RSS / Goroutine æ•°é‡ / Goroutine æ ˆå ç”¨ â€“Â» å¦‚æœ Goroutine æ•°é‡ä¸å¤šï¼Œåˆ™é‡ç‚¹å…³æ³¨ heap profile ä¸­çš„ inuse â€“Â» å®šæ—¶ä»»åŠ¡ç±»éœ€è¦çœ‹ alloc Goroutine æ•°é‡è¿‡å¤š â€“Â» ä» profile ç½‘é¡µè¿›å»çœ‹çœ‹ Goroutine çš„æ‰§è¡Œæƒ…å†µï¼ˆåœ¨å¹²ä»€ä¹ˆï¼Ÿï¼‰ â€“Â» æ£€æŸ¥æ­»é”ã€é˜»å¡ç­‰é—®é¢˜ â€“Â» ä¸ªåˆ«ä¸åœ¨æ„å»¶è¿Ÿçš„é€‰æ‹©ç¬¬ä¸‰æ–¹åº“ä¼˜åŒ– ","date":"2024-04-20","objectID":"/posts/golang-profile/:2:2","tags":["Golang","Profile","Optimize"],"title":"Golang Profile and Optimize","uri":"/posts/golang-profile/"},{"categories":["Golang","Profile","Optimize"],"content":"å¸¸è§ä¼˜åŒ–åœºæ™¯ å­—ç¬¦ä¸²æ‹¼æ¥ package main import ( \"fmt\" \"testing\" ) func BenchmarkConcat0(b *testing.B) { var str string for i := 0; i \u003c b.N; i++ { str = \"\" str += \"userid : \" + \"1\" str += \"localtion : \" + \"ab\" } } func BenchmarkConcat1(b *testing.B) { var str string for i := 0; i \u003c b.N; i++ { str = \"\" str += fmt.Sprintf(\"userid : %v\", \"1\") str += fmt.Sprintf(\"localtion : %v\", \"ab\") } } $ go test -bench=. -benchmem goos: linux goarch: amd64 pkg: github.com/lutianen/go-test/bench0 cpu: 11th Gen Intel(R) Core(TM) i7-11800H @ 2.30GHz BenchmarkConcat0-16 35702518 32.86 ns/op 24 B/op 1 allocs/op BenchmarkConcat1-16 8105732 140.9 ns/op 56 B/op 3 allocs/op PASS ok github.com/lutianen/go-test/bench0 2.506s é€ƒé€¸åˆ†æ ç”¨æˆ·å£°æ˜çš„å¯¹è±¡ï¼Œè¢«æ”¾åœ¨æ ˆä¸Šè¿˜æ˜¯å †ä¸Šï¼Ÿ å¯ä»¥é€šè¿‡ç¼–è¯‘å™¨çš„ escape analysis æ¥å†³å®š go build -gcflags=\"-m\" xxx.go package main func main() { var sl = make([]int, 1024) println(sl[0]) var sl0 = make([]int, 10240) println(sl0[0]) } $ go build -gcflags=\"-m\" main.go # command-line-arguments ./main.go:3:6: can inline main ./main.go:4:15: make([]int, 1024) does not escape ./main.go:7:16: make([]int, 10240) escapes to heap TODO: å„ç§é€ƒé€¸åˆ†æçš„å¯èƒ½æ€§æœ‰å“ªäº›ï¼Ÿ Trasval 2-D Matrix package bench1 import \"testing\" func BenchmarkHorizontal(b *testing.B) { arrLen := 10000 arr := make([][]int, arrLen, arrLen) for i := 0; i \u003c arrLen; i++ { arrInternal := make([]int, arrLen) for j := 0; j \u003c arrLen; j++ { arrInternal[j] = 0 } arr[i] = arrInternal } for i := 0; i \u003c b.N; i++ { for x := 0; x \u003c len(arr); x++ { for y := 0; y \u003c len(arr); y++ { arr[x][y] = 1 } } } } func BenchmarkVertical(b *testing.B) { arrLen := 10000 arr := make([][]int, arrLen, arrLen) for i := 0; i \u003c arrLen; i++ { arrInternal := make([]int, arrLen) for j := 0; j \u003c arrLen; j++ { arrInternal[j] = 0 } arr[i] = arrInternal } for i := 0; i \u003c b.N; i++ { for x := 0; x \u003c len(arr); x++ { for y := 0; y \u003c len(arr); y++ { arr[y][x] = 1 } } } } $ go test -bench=. -benchmem goos: linux goarch: amd64 pkg: github.com/lutianen/go-test/bench1 cpu: 11th Gen Intel(R) Core(TM) i7-11800H @ 2.30GHz BenchmarkHorizontal-16 15 71020410 ns/op 54629717 B/op 666 allocs/op BenchmarkVertical-16 1 1059649022 ns/op 819445856 B/op 10002 allocs/op PASS ok github.com/lutianen/go-test/bench1 3.676s Zero Garbage / Allocation Zero Grabage ä¸€èˆ¬æŒ‡çš„æ˜¯é€šè¿‡åˆ©ç”¨ sync.Pool å°†å †åˆ†é…å®Œå…¨æ¶ˆç­çš„ä¼˜åŒ–æŠ€æœ¯ã€‚ ä¾‹å¦‚ï¼Œåœ¨ http router æ¡†æ¶ fasthttp ä¸­åº”ç”¨è¾ƒå¤š. False Sharing CPU è¿è¡Œè¿‡ç¨‹ä¸­ä¿®æ”¹æ•°æ®æ˜¯ä¸€ä¸ª cache lineä¸ºå•ä½ï¼Œå½“ä¸¤ä¸ªå˜é‡A/Bæ»¡è¶³ä»¥ä¸‹æ¡ä»¶ï¼š åœ¨å†…å­˜ä¸­ç›¸é‚» å¹¶å‘ä¿®æ”¹é¢‘ç¹ é‚£ä¹ˆï¼Œå½“ CPU0 ä¿®æ”¹å˜é‡ A æ—¶ï¼Œä¼šå¯¼è‡´ CPU1 ä¸­çš„å˜é‡ B ç¼“å­˜å¤±æ•ˆã€‚ è§£å†³æ–¹æ³•ï¼Œåœ¨å®šä¹‰æ•°æ®ç»“æ„ä¸­ï¼Œå¡«å……ä¸€äº› padding ç”¨ä»¥æ»¡è¶³è¯¥æ•°æ®ç»“æ„æ­£å¥½æ˜¯ cache line çš„æ•´æ•°å€ï¼› type NoPad struct { x uint64 y uint64 } type WithPad struct { x uint64 _ [6]uint64 y uint64 } æŸ¥çœ‹ cache line å¤§å°ï¼šcat /sys/devices/system/cpu/cpu\u003ccore-num\u003e/cache/index0/coherency_line_size é™ä½å¤–éƒ¨å‘½ä»¤è°ƒç”¨é¢‘æ¬¡ ä¼˜åŒ–å‰ï¼š func f(wr http.ResponseWriter, r *http.Request) { uuid, _ := exec.Command(\"uuidgen\").Output() // Use exec.Command wr.Header()[\"Content-Type\"] = []string{\"application/text\"} io.WriteString(wr, string(uuid)) } ä¼˜åŒ–åï¼š import uuid \"github.com/satori/go.uuid\" func f(wr http.ResponseWriter, r *http.Request) { uuid, _ := uuid.NewV4() // Replace exec.Command with existing library wr.Header()[\"Content-Type\"] = []string{\"application/text\"} io.WriteString(wr, uuid.String()) } æ€»ç»“ï¼š çº¿ä¸Šä½¿ç”¨ exec å‘½ä»¤æ˜¯éå¸¸å±é™©çš„ é‡‡ç”¨ç¬¬ä¸‰æ–¹åº“ä»£æ›¿å¤–éƒ¨å‘½ä»¤ é˜»å¡å¯¼è‡´é«˜å»¶è¿Ÿ é”é˜»å¡ var mtx sync.Mutex var data = map[string]string{ \"hint\": \"hello wold\", } func f(wr http.ResponseWriter, r *http.Request) { mtx.Lock() defer mtx.Unlock() buf := data[\"hint\"] time.Sleep(time.Millisecond * 10) // ä¸´ç•ŒåŒºå†…çš„æ…¢æ“ä½œ wr.Header()[\"Content-Type\"] = []string{\"application/json\"} io.WriteString(wr, buf) } å‡å°ä¸´ç•ŒåŒº - ä¼˜åŒ–åï¼š var mtx sync.Mutex var data = map[string]string{ \"hint\": \"hello wold\", } func f(wr http.ResponseWriter, r *http.Request) { mtx.Lock() buf := data[\"hint\"] mtx.Unlock() time.Sleep(time.Millisecond * 10) // æ…¢æ“ä½œæ”¾ç½®äºä¸´ç•ŒåŒºä¹‹å¤– wr.Header()[\"Content-Type\"] = []string{\"application/json\"} io.WriteString(wr, buf) } åœ¨åç«¯ç³»ç»Ÿå¼€å‘ä¸­ï¼Œé”ç“¶é¢ˆæ˜¯è¾ƒå¸¸è§çš„é—®é¢˜ï¼Œä¾‹å¦‚æ–‡ä»¶é” åŒ Buffer å®Œå…¨å¹²æ‰é”é˜»å¡ ä½¿ç”¨åŒ Buffer / RCU å®Œå…¨æ¶ˆé™¤è¯»é˜»å¡ï¼šå…¨é‡æ›´æ–°ï¼Œç›´æ¥æ›¿æ¢åŸ config func updateConfig() { var newConfig = \u0026MyConfig { WhiteList: make(map[int]struct{}), } // Do a lot of compulation ","date":"2024-04-20","objectID":"/posts/golang-profile/:2:3","tags":["Golang","Profile","Optimize"],"title":"Golang Profile and Optimize","uri":"/posts/golang-profile/"},{"categories":["Golang","Profile","Optimize"],"content":"III. Coutinuous Profiling å‹æµ‹æ˜¯ä¸€ä¸ªè¹²ç‚¹è¡Œä¸ºï¼Œç„¶è€ŒçœŸå®åœºæ™¯å¹¶ä¸ç¾å¥½ï¼Œå®ƒä»¬é€šå¸¸æ˜¯éš¾ä»¥å‘ç°çš„å¶å‘é—®é¢˜ï¼š è¯¥åˆ°åƒé¥­çš„æ—¶å€™ï¼ŒCPU ä½¿ç”¨å°–åˆº å‡Œæ™¨å››ç‚¹åŠï¼Œç³»ç»Ÿå‘ç”Ÿ OOM åˆšç¡ç€çš„æ—¶å€™ï¼ŒGoroutine æ•°é‡çˆ†ç‚¸ äº§å“è¢«éƒ¨ç½²åˆ°å®¢æˆ·é‚£é‡Œï¼Œæƒ³ç™»é™†å®¢æˆ·çš„ç¯å¢ƒå¹¶ä¸æ–¹ä¾¿ æ­¤æ—¶ Coutinuout Profiling å°±æ´¾ä¸Šç”¨åœºäº†. è‡ªçœå¼çš„ Profile Dumperï¼Œå¯ä»¥æ ¹æ® CPU åˆ©ç”¨ç‡ã€Memory åˆ©ç”¨ç‡ã€Goroutine æ•°é‡ç­‰å¤šä¸ªæŒ‡æ ‡æ£€æµ‹ç³»ç»Ÿï¼Œè®¾ç½®å®šæ—¶å‘¨æœŸè¿›è¡Œæ£€æµ‹ï¼Œå½“å‘ç°æŸä¸ªæŒ‡æ ‡å¼‚å¸¸æ—¶ï¼Œè‡ªåŠ¨ Dump file. ","date":"2024-04-20","objectID":"/posts/golang-profile/:3:0","tags":["Golang","Profile","Optimize"],"title":"Golang Profile and Optimize","uri":"/posts/golang-profile/"},{"categories":["Golang","Profile","Optimize"],"content":"IV. Summary _pad ä¼˜åŒ–ï¼Œé’ˆå¯¹å¤šä¸ªçº¿ç¨‹æ›´æ–°åŒä¸€ä¸ªç»“æ„ä½“å†…ä¸åŒçš„å­—æ®µåœºæ™¯æœ‰æ•ˆï¼Œè€Œé’ˆå¯¹ä¸€ä¸ªçº¿ç¨‹åŒæ—¶æ›´æ–°æ•´ä¸ªç»“æ„ä½“çš„åœºæ™¯æ„ä¹‰ä¸å¤§ï¼› ç¬¬ä¸‰æ–¹æ¥å£å‡ºç°é—®é¢˜ï¼Œå¦‚ä½•ä¿æŠ¤è‡ªå·±çš„æœåŠ¡ï¼Ÿ å¯¹å¤–éƒ¨è°ƒç”¨å¿…é¡»æœ‰è¶…æ—¶ ==\u003e ç†”æ–­ goroutine åˆå§‹åŒ–æ ˆç©ºé—´ä¸º 2KBï¼Œæœ€å¤§ 1GBï¼Œé‚£ä¹ˆ heap ä¸ºä»€ä¹ˆä¸çˆ†æ ˆï¼Ÿ åœ¨ Go è¯­è¨€ä¸­ï¼Œgoroutine å’Œ heap ä½¿ç”¨å•ç‹¬çš„å†…å­˜ç©ºé—´ï¼šGoroutine æœ‰è‡ªå·±çš„å †æ ˆç©ºé—´ï¼Œç”¨äºå­˜å‚¨å±€éƒ¨å˜é‡ã€å‡½æ•°å¸§å’Œå…¶ä»–è¿è¡Œæ—¶ä¿¡æ¯ï¼›heap åˆ™æ˜¯ä¸€ä¸ªå…±äº«å†…å­˜ç©ºé—´ï¼Œç”¨äºå­˜å‚¨åŠ¨æ€åˆ†é…çš„å¯¹è±¡ï¼Œä¾‹å¦‚ sliceã€map å’Œ stringsã€‚ å½“ Goroutine éœ€è¦åˆ†é…çš„å†…å­˜å¤šäºèµ·å †æ ˆä¸Šçš„å¯ç”¨å†…å­˜æ—¶ï¼Œå®ƒå°†è‡ªåŠ¨ä» stack ä¸­åˆ†é…å†…å­˜ï¼Œé‡‡ç”¨çš„æ˜¯ stack åˆ†é…æœºåˆ¶å®Œæˆï¼Œè¿è¡Œ goroutine åˆ†é…ä»»ä½•æ•°é‡çš„å†…å­˜ï¼Œè€Œä¸ç”¨æ‹…å¿ƒ stack ç©ºé—´è€—å°½ï¼› é™¤äº†å †åˆ†é…ä¹‹å¤–ï¼Œgoroutine è¿˜å¯ä»¥ä½¿ç”¨ä¸€ç§ç§°ä¸ºå †æ ˆå¤åˆ¶çš„æŠ€æœ¯æ¥åœ¨å®ƒä»¬ä¹‹é—´å…±äº«æ•°æ®ï¼Œå †æ ˆå¤åˆ¶æ¯”å †åˆ†é…æ›´æœ‰æ•ˆï¼Œä½†å®ƒåªèƒ½ç”¨äºå…±äº«è¶³å¤Ÿå°ä»¥é€‚åˆå †æ ˆçš„æ•°æ®ã€‚ ","date":"2024-04-20","objectID":"/posts/golang-profile/:4:0","tags":["Golang","Profile","Optimize"],"title":"Golang Profile and Optimize","uri":"/posts/golang-profile/"},{"categories":["Golang","Profile","Optimize"],"content":"V. Reference Benchmarks Game Go Web Frame Benchmarks Go HTTP Router Benchmark Web åœºæ™¯è·¨è¯­è¨€æ€§èƒ½å¯¹æ¯” ã€ŠSystems Performanceã€‹ Dave åˆ†äº«çš„ High Performance Go Workshop go-perfbook: best practices for writing high-performance Go code Delve What is Continuous Profiling? Google-Wide Profiling: A Continuous Profiling Infrastructure for Data Centers ","date":"2024-04-20","objectID":"/posts/golang-profile/:5:0","tags":["Golang","Profile","Optimize"],"title":"Golang Profile and Optimize","uri":"/posts/golang-profile/"},{"categories":["Golang","Linter","Static Check","CI/CD"],"content":" å¯¼è¯­ åœ¨ Golang ç”Ÿæ€ç³»ç»Ÿä¸­ï¼ŒLinter å·¥å…·æ˜¯å¼€å‘è€…æå‡ä»£ç è´¨é‡çš„å…³é”®ã€‚ æœ¬æ–‡å°†æ·±å…¥ä»‹ç»å‡ æ¬¾å¸¸ç”¨çš„ Linter å·¥å…·åŠå…¶æœ€ä½³å®è·µï¼Œå¸®åŠ©æ‚¨åœ¨å¼€å‘ä¸­é¿å…å¸¸è§é”™è¯¯å¹¶æé«˜ä»£ç çš„å¯ç»´æŠ¤æ€§ã€‚ ","date":"2024-04-19","objectID":"/posts/golang-linter/:0:0","tags":["Golang","Linter","Static Check","CI/CD"],"title":"æ·±å…¥è§£è¯» Golang å¸¸ç”¨ Linter å·¥å…·åŠæœ€ä½³å®è·µ","uri":"/posts/golang-linter/"},{"categories":["Golang","Linter","Static Check","CI/CD"],"content":"ç›®å½• è¯´æ˜ ä½•ä¸º Linterï¼Ÿ Gocyclo bodyclose sqlrows funlen goconst ineffassign lll errcheck whitespace GolangCI-Lint reviewdog Summary Reference ","date":"2024-04-19","objectID":"/posts/golang-linter/:1:0","tags":["Golang","Linter","Static Check","CI/CD"],"title":"æ·±å…¥è§£è¯» Golang å¸¸ç”¨ Linter å·¥å…·åŠæœ€ä½³å®è·µ","uri":"/posts/golang-linter/"},{"categories":["Golang","Linter","Static Check","CI/CD"],"content":"O. è¯´æ˜ å¦‚ç‰¹æ®Šè¯´æ˜ï¼Œæ–‡ä¸­ä»£ç å·²åœ¨åœ¨ Mac å’Œ Linux ç³»ç»Ÿä¸‹è¿›è¡Œæµ‹è¯• ","date":"2024-04-19","objectID":"/posts/golang-linter/:2:0","tags":["Golang","Linter","Static Check","CI/CD"],"title":"æ·±å…¥è§£è¯» Golang å¸¸ç”¨ Linter å·¥å…·åŠæœ€ä½³å®è·µ","uri":"/posts/golang-linter/"},{"categories":["Golang","Linter","Static Check","CI/CD"],"content":"I. ä½•ä¸º Linterï¼Ÿ Linter æ˜¯ä¸€ç§é™æ€ä»£ç åˆ†æå·¥å…·ï¼Œç”¨äºåœ¨ç¼–è¯‘å‰æ£€æŸ¥ä»£ç ä¸­çš„é”™è¯¯ã€é£æ ¼é—®é¢˜åŠæ½œåœ¨çš„ Bugã€‚ åœ¨ Golang ç”Ÿæ€ä¸­ï¼ŒLinter å·¥å…·å¸®åŠ©å¼€å‘è€…åœ¨æ—©æœŸé˜¶æ®µå°±å‘ç°é—®é¢˜ï¼Œä»è€Œé¿å…åæœŸä¿®å¤çš„é«˜æˆæœ¬ã€‚ ","date":"2024-04-19","objectID":"/posts/golang-linter/:3:0","tags":["Golang","Linter","Static Check","CI/CD"],"title":"æ·±å…¥è§£è¯» Golang å¸¸ç”¨ Linter å·¥å…·åŠæœ€ä½³å®è·µ","uri":"/posts/golang-linter/"},{"categories":["Golang","Linter","Static Check","CI/CD"],"content":"II. Gocyclo Gocyclo æ˜¯ä¸€æ¬¾ç”¨äºåˆ†æ Go ä»£ç ä¸­å‡½æ•°åœˆå¤æ‚åº¦çš„ Linter å·¥å…·ï¼Œå¸®åŠ©å¼€å‘è€…è¯†åˆ«éœ€è¦é‡æ„çš„å¤æ‚å‡½æ•°ã€‚ é€šè¿‡é™ä½åœˆå¤æ‚åº¦ï¼Œä»£ç å˜å¾—æ›´åŠ ç®€æ´ã€æ˜“è¯»ä¸”æ›´æ˜“ç»´æŠ¤ã€‚ ","date":"2024-04-19","objectID":"/posts/golang-linter/:4:0","tags":["Golang","Linter","Static Check","CI/CD"],"title":"æ·±å…¥è§£è¯» Golang å¸¸ç”¨ Linter å·¥å…·åŠæœ€ä½³å®è·µ","uri":"/posts/golang-linter/"},{"categories":["Golang","Linter","Static Check","CI/CD"],"content":"å‡½æ•°åœˆå¤æ‚åº¦(cyclomatic complexities) åœˆå¤æ‚åº¦ï¼Œæ˜¯ä¸€ç§è¡¡é‡ä»£ç å¤æ‚æ€§çš„æŒ‡æ ‡ï¼Œé€šè¿‡è®¡ç®—ä»£ç ä¸­çš„å†³ç­–ç‚¹ï¼ˆå¦‚ifè¯­å¥ã€å¾ªç¯ç­‰ï¼‰æ¥è¯„ä¼°å‡½æ•°çš„å¤æ‚åº¦ï¼Œå…·ä½“è®¡ç®—æ–¹æ³•å¦‚ä¸‹ï¼š ä¸€ä¸ªå‡½æ•°çš„åŸºæœ¬åœˆå¤æ‚åº¦ä¸º 1 å½“å‡½æ•°ä¸­å­˜åœ¨çš„æ¯ä¸€ä¸ª if, for, case, \u0026\u0026 or ||ï¼Œéƒ½ä¼šä½¿å¾—è¯¥å‡½æ•°çš„åœˆå¤æ‚åº¦åŠ  1 åœ¨ Go è¯­è¨€ä¸­ï¼Œç”±äº if err != nil çš„ç‰¹æ®Šæƒ…å†µå­˜åœ¨ï¼Œå› æ­¤ï¼Œå…¶åœˆå¤æ‚åº¦é˜ˆå€¼é»˜è®¤ä¸º 15ï¼Œè€Œå…¶ä»–ç¼–ç¨‹è¯­è¨€ä¸­åœˆå¤æ‚åº¦é˜ˆå€¼ä¸€èˆ¬é»˜è®¤ä¸º 10ã€‚ åœ¨ Go è¯­è¨€ä¸­ï¼Œswitch ä¸­çš„ default å¹¶ä¸ä¼šå¢åŠ å‡½æ•°çš„åœˆå¤æ‚åº¦ï¼› Gocyclo å¯ä»¥ä½œä¸ºå•ç‹¬çš„å‘½ä»¤è¡Œå·¥å…·ä½¿ç”¨ï¼Œä¹Ÿå¯ä»¥ä¸å…¶ä»– Linter å·¥å…·(å¦‚ golangci-lint)é›†æˆä½¿ç”¨ï¼Œæä¾›æ›´å…¨é¢çš„ä»£ç è´¨é‡æ£€æŸ¥ã€‚ åŒæ—¶ï¼Œå®ƒä¹Ÿå¯ä»¥é›†æˆåˆ° CI/CD æµç¨‹ä¸­ï¼Œå¸®åŠ©å›¢é˜ŸæŒç»­æ”¹å–„ä»£ç è´¨é‡ã€‚ ","date":"2024-04-19","objectID":"/posts/golang-linter/:4:1","tags":["Golang","Linter","Static Check","CI/CD"],"title":"æ·±å…¥è§£è¯» Golang å¸¸ç”¨ Linter å·¥å…·åŠæœ€ä½³å®è·µ","uri":"/posts/golang-linter/"},{"categories":["Golang","Linter","Static Check","CI/CD"],"content":"å®‰è£… go install github.com/fzipp/gocyclo/cmd/gocyclo@latest ","date":"2024-04-19","objectID":"/posts/golang-linter/:4:2","tags":["Golang","Linter","Static Check","CI/CD"],"title":"æ·±å…¥è§£è¯» Golang å¸¸ç”¨ Linter å·¥å…·åŠæœ€ä½³å®è·µ","uri":"/posts/golang-linter/"},{"categories":["Golang","Linter","Static Check","CI/CD"],"content":"å¦‚ä½•ä½¿ç”¨ Gocyclo linter ï¼Ÿ Calculate cyclomatic complexities of Go functions. Usage: gocyclo [flags] \u003cGo file or directory\u003e ... Flags: -over N show functions with complexity \u003e N only and return exit code 1 if the set is non-empty -top N show the top N most complex functions only -avg, -avg-short show the average complexity over all functions; the short option prints the value without a label -ignore REGEX exclude files matching the given regular expression The output fields for each line are: \u003ccomplexity\u003e \u003cpackage\u003e \u003cfunction\u003e \u003cfile:line:column\u003e ä½¿ç”¨ç¤ºä¾‹ // gocyclo-test/main.go package main import ( \"fmt\" \"strconv\" ) func main() { var a = 10 if a == 10 { f() } else { fmt.Printf(\"%s\", strconv.Itoa(a)) } switch a{ case 10: fmt.Println(a) default: fmt.Println(\"default\") } } func f() { a := 10 b := 12 if a != b { // do something fmt.Println(\"a != b\") } } $ gocyclo gocyclo-test/main.go 3 main main gocyclo-test/main.go:8:1 2 main f gocyclo-test/main.go:24:1 ","date":"2024-04-19","objectID":"/posts/golang-linter/:4:3","tags":["Golang","Linter","Static Check","CI/CD"],"title":"æ·±å…¥è§£è¯» Golang å¸¸ç”¨ Linter å·¥å…·åŠæœ€ä½³å®è·µ","uri":"/posts/golang-linter/"},{"categories":["Golang","Linter","Static Check","CI/CD"],"content":"III. bodyclose åœ¨ Go ä¸­ï¼Œå³ä½¿è¯»å–äº†æ‰€æœ‰çš„å“åº”å†…å®¹ï¼Œä¹Ÿéœ€è¦æ˜¾å¼å…³é—­å“åº”ä½“ä»¥é‡Šæ”¾èµ„æºï¼Œå¦åˆ™å¯èƒ½å¯¼è‡´èµ„æºæ³„æ¼ã€è¿æ¥æ± è€—å°½ï¼Œè¿›è€Œå½±å“åº”ç”¨æ€§èƒ½ã€‚ bodyclose ä¸»è¦å…³æ³¨äº HTTP å“åº”ä½“çš„æ­£ç¡®å…³é—­ï¼Œé€šè¿‡æ£€æŸ¥ resp.Body æ˜¯å¦è¢«æ­£ç¡®å…³é—­ã€‚ å®ƒæ—¢å¯ä»¥å•ç‹¬ä½¿ç”¨ï¼Œä¹Ÿå¯ä»¥é›†æˆåˆ°å…¶ä»– linter å·¥å…·ï¼ˆä¾‹å¦‚ golangci-lintï¼‰ä¸­ã€‚ ","date":"2024-04-19","objectID":"/posts/golang-linter/:5:0","tags":["Golang","Linter","Static Check","CI/CD"],"title":"æ·±å…¥è§£è¯» Golang å¸¸ç”¨ Linter å·¥å…·åŠæœ€ä½³å®è·µ","uri":"/posts/golang-linter/"},{"categories":["Golang","Linter","Static Check","CI/CD"],"content":"å®‰è£… go install github.com/timakin/bodyclose@latest ","date":"2024-04-19","objectID":"/posts/golang-linter/:5:1","tags":["Golang","Linter","Static Check","CI/CD"],"title":"æ·±å…¥è§£è¯» Golang å¸¸ç”¨ Linter å·¥å…·åŠæœ€ä½³å®è·µ","uri":"/posts/golang-linter/"},{"categories":["Golang","Linter","Static Check","CI/CD"],"content":"å¦‚ä½•ä½¿ç”¨ bodyclose ? $ bodyclose bodyclose is a tool for static analysis of Go programs. Usage of bodyclose: bodyclose unit.cfg # execute analysis specified by config file bodyclose help # general help, including listing analyzers and flags bodyclose help name # help on specific analyzer and its flags ä½¿ç”¨ç¤ºä¾‹ è¿™é‡Œå±•ç¤ºå€ŸåŠ© golangci-lint çš„æ–¹å¼ä½¿ç”¨ bodyclose. // main.go package kyden import ( \"fmt\" \"io\" \"net/http\" ) func f() error{ resp, err := http.Get(\"http://example.com/\") if err != nil { return err } // defer resp.Body.Close() // \u003c\u003c\u003c body, err := io.ReadAll(resp.Body) fmt.Println(body) return nil } $ golangci-lint run --disable-all -E bodyclose main.go main.go:11:26: response body must be closed (bodyclose) resp, err := http.Get(\"http://example.com/\") é¿å…ä½¿ç”¨ http åº“ä¸­ body å¿˜è®° close çš„æ›´ä¼˜æ–¹æ¡ˆæ˜¯: å¯¹ Go å®˜æ–¹æä¾›çš„ http è¿›è¡Œå°è£…ï¼Œä½¿è°ƒç”¨æ–¹ï¼ˆCallerï¼‰ä¸ç”¨æ˜¾ç¤ºè°ƒç”¨ close å‡½æ•°. package httpclient import ( \"io/ioutil\" \"net/http\" ) // Client æ˜¯ä¸€ä¸ªè‡ªå®šä¹‰çš„ HTTP å®¢æˆ·ç«¯ç»“æ„ä½“ type Client struct { http.Client } // Get å°è£…äº† http.Get æ–¹æ³• func (c *Client) Get(url string) (string, error) { resp, err := c.Client.Get(url) if err != nil { return \"\", err } // ç¡®ä¿åœ¨å‡½æ•°è¿”å›æ—¶å…³é—­å“åº”ä½“ defer resp.Body.Close() // è¯»å–å“åº”å†…å®¹ body, err := ioutil.ReadAll(resp.Body) if err != nil { return \"\", err } return string(body), nil } ","date":"2024-04-19","objectID":"/posts/golang-linter/:5:2","tags":["Golang","Linter","Static Check","CI/CD"],"title":"æ·±å…¥è§£è¯» Golang å¸¸ç”¨ Linter å·¥å…·åŠæœ€ä½³å®è·µ","uri":"/posts/golang-linter/"},{"categories":["Golang","Linter","Static Check","CI/CD"],"content":"IV. sqlrows åœ¨ Go çš„ database/sql åŒ…ä¸­ï¼Œsql.Rows æ˜¯ä¸€ä¸ª structï¼Œç”¨äºè¡¨ç¤ºä»æ•°æ®åº“æŸ¥è¯¢ä¸­è¿”å›çš„å¤šè¡Œç»“æœã€‚ å®ƒæä¾›äº†ä¸€ç»„æ–¹æ³•ï¼Œå…è®¸å¼€å‘è€…é€è¡Œè¯»å–æŸ¥è¯¢ç»“æœã€‚ è¿­ä»£ç»“æœï¼šä½¿ç”¨ Next() æ–¹æ³•é€è¡Œéå†ç»“æœé›†ã€‚ æ‰«ææ•°æ®ï¼šä½¿ç”¨ Scan() æ–¹æ³•å°†å½“å‰è¡Œçš„åˆ—å€¼å¤åˆ¶åˆ°æŒ‡å®šçš„å˜é‡ä¸­ã€‚ å…³é—­ç»“æœé›†ï¼šä½¿ç”¨ Close() æ–¹æ³•é‡Šæ”¾ä¸ç»“æœé›†ç›¸å…³çš„èµ„æºã€‚ sqlrows çš„å®˜æ–¹ä»‹ç»ï¼š sqlrows is a static code analyzer which helps uncover bugs by reporting a diagnostic for mistakes of sql.Rows usage. ","date":"2024-04-19","objectID":"/posts/golang-linter/:6:0","tags":["Golang","Linter","Static Check","CI/CD"],"title":"æ·±å…¥è§£è¯» Golang å¸¸ç”¨ Linter å·¥å…·åŠæœ€ä½³å®è·µ","uri":"/posts/golang-linter/"},{"categories":["Golang","Linter","Static Check","CI/CD"],"content":"å®‰è£… go install github.com/gostaticanalysis/sqlrows@latest ","date":"2024-04-19","objectID":"/posts/golang-linter/:6:1","tags":["Golang","Linter","Static Check","CI/CD"],"title":"æ·±å…¥è§£è¯» Golang å¸¸ç”¨ Linter å·¥å…·åŠæœ€ä½³å®è·µ","uri":"/posts/golang-linter/"},{"categories":["Golang","Linter","Static Check","CI/CD"],"content":"å¦‚ä½•ä½¿ç”¨ sqlrows ? $ sqlrows sqlrows is a tool for static analysis of Go programs. Usage of sqlrows: sqlrows unit.cfg # execute analysis specified by config file sqlrows help # general help sqlrows help name # help on specific analyzer and its flags Go æºç ã€æ³¨æ„ Not Good(NG) å¤„ã€‘ // main.go package kyden import ( \"context\" \"database/sql\" ) func f(ctx context.Context, db *sql.DB) (interface{}, error) { rows, err := db.QueryContext(ctx, \"SELECT * FROM users\") defer rows.Close() // NG: using rows before checking for errors if err != nil { return nil, err } // defer rows.Close() // NG: this return will not release a connection. for rows.Next() { err = rows.Scan() if err != nil { return nil, err } } return nil, nil } é’ˆå¯¹ä¸¤ç§ NG çš„ä¸åŒè¾“å‡ºï¼š go vet -vettool=$(which sqlrows) main.go # command-line-arguments ./main.go:10:11: using rows before checking for errors go vet -vettool=$(which sqlrows) main.go # command-line-arguments ./main.go:9:33: rows.Close must be called ","date":"2024-04-19","objectID":"/posts/golang-linter/:6:2","tags":["Golang","Linter","Static Check","CI/CD"],"title":"æ·±å…¥è§£è¯» Golang å¸¸ç”¨ Linter å·¥å…·åŠæœ€ä½³å®è·µ","uri":"/posts/golang-linter/"},{"categories":["Golang","Linter","Static Check","CI/CD"],"content":"V. funlen funlenï¼Œç”¨äºæ£€æŸ¥å‡½æ•°çš„é•¿åº¦ï¼Œç¡®ä¿å‡½æ•°çš„å¯è¯»æ€§å’Œå¯ç»´æŠ¤æ€§ã€‚ é»˜è®¤æƒ…å†µä¸‹ï¼Œfunlen å°†å‡½æ•°çš„æœ€å¤§è¡Œæ•°é™åˆ¶(lines)ä¸º 60 è¡Œï¼Œæœ€å¤§è¯­å¥æ•°(statements)é™åˆ¶ä¸º 40 æ¡ã€‚ é€šå¸¸ï¼Œfunlen ä¼šç»“åˆ golangci-lint ä½¿ç”¨ï¼Œ å¹¶é›†æˆåˆ°å¼€å‘å·¥ä½œæµä¸­ï¼Œæå‡ä»£ç è´¨é‡. ","date":"2024-04-19","objectID":"/posts/golang-linter/:7:0","tags":["Golang","Linter","Static Check","CI/CD"],"title":"æ·±å…¥è§£è¯» Golang å¸¸ç”¨ Linter å·¥å…·åŠæœ€ä½³å®è·µ","uri":"/posts/golang-linter/"},{"categories":["Golang","Linter","Static Check","CI/CD"],"content":"å®‰è£… funlen å¯ä»¥é€šè¿‡ golangci-lint å®‰è£…: go install github.com/golangci/golangci-lint/cmd/golangci-lint@latest ","date":"2024-04-19","objectID":"/posts/golang-linter/:7:1","tags":["Golang","Linter","Static Check","CI/CD"],"title":"æ·±å…¥è§£è¯» Golang å¸¸ç”¨ Linter å·¥å…·åŠæœ€ä½³å®è·µ","uri":"/posts/golang-linter/"},{"categories":["Golang","Linter","Static Check","CI/CD"],"content":"å¦‚ä½•ä½¿ç”¨ funlen ï¼Ÿ linters: disable-all: true enable: - funlen linters-settings: funlen: lines: 60 statements: 40 ä½¿ç”¨ç¤ºä¾‹ // main.go package main import ( \"fmt\" ) func main() { f() } func f () { fmt.Println(\"Test funlen\") a := 1 fmt.Println(a) b := 1 fmt.Println(b) c := 1 fmt.Println(c) } ä¸‹é¢çš„ .golangci.yml ä»…ç”¨äºå±•ç¤º funlen çš„ç”¨æ³•ï¼Œå…·ä½“å‚æ•°è¯·æ ¹æ®å®é™…é¡¹ç›®è‡ªè¡Œè°ƒæ•´ã€‚ # .golangci.yml linters: disable-all: true enable: - funlen linters-settings: funlen: lines: 6 statements: 4 $ golangci-lint run main.go:12: Function 'f' has too many statements (7 \u003e 4) (funlen) ","date":"2024-04-19","objectID":"/posts/golang-linter/:7:2","tags":["Golang","Linter","Static Check","CI/CD"],"title":"æ·±å…¥è§£è¯» Golang å¸¸ç”¨ Linter å·¥å…·åŠæœ€ä½³å®è·µ","uri":"/posts/golang-linter/"},{"categories":["Golang","Linter","Static Check","CI/CD"],"content":"VI. goconst goconst ä¼šæ‰«æä»£ç ï¼Œè¯†åˆ«å‡ºåœ¨å¤šä¸ªåœ°æ–¹é‡å¤å‡ºç°çš„å­—ç¬¦ä¸²ã€‚ è¿™äº›å­—ç¬¦ä¸²é€šå¸¸æ˜¯ç›¸åŒçš„æ–‡æœ¬ï¼Œå¼€å‘è€…é€šè¿‡å°†é‡å¤çš„å­—ç¬¦ä¸²æå–ä¸ºå¸¸é‡ï¼Œä»£ç å˜å¾—æ›´åŠ æ¸…æ™°ï¼Œå‡å°‘äº†ç¡¬ç¼–ç çš„å‡ºç°ï¼Œé™ä½äº†å‡ºé”™çš„å¯èƒ½æ€§ã€‚ å¯ä»¥æ ¹æ®é¡¹ç›®éœ€æ±‚è‡ªå®šä¹‰ goconst çš„è¡Œä¸ºï¼Œä¾‹å¦‚è®¾ç½®å­—ç¬¦ä¸²çš„æœ€å°é•¿åº¦ã€æœ€å°å‡ºç°æ¬¡æ•°ç­‰ã€‚ goconst é€šå¸¸ä½œä¸º golangci-lint çš„ä¸€éƒ¨åˆ†ä½¿ç”¨ã€‚ ","date":"2024-04-19","objectID":"/posts/golang-linter/:8:0","tags":["Golang","Linter","Static Check","CI/CD"],"title":"æ·±å…¥è§£è¯» Golang å¸¸ç”¨ Linter å·¥å…·åŠæœ€ä½³å®è·µ","uri":"/posts/golang-linter/"},{"categories":["Golang","Linter","Static Check","CI/CD"],"content":"å¦‚ä½•ä½¿ç”¨ goconst ? linters: disable-all: true enable: - goconst linters-settings: goconst: min-len: 3 min-occurrences: 3 ä½¿ç”¨ç¤ºä¾‹ // main.go package main import \"fmt\" func f() { a := \"Hello\" fmt.Println(a) b := \"Hello\" fmt.Println(b) c := \"Hello\" fmt.Println(c) } ä¸‹é¢çš„ .golangci.yml ä»…ç”¨äºå±•ç¤º funlen çš„ç”¨æ³•ï¼Œå…·ä½“å‚æ•°è¯·æ ¹æ®å®é™…é¡¹ç›®è‡ªè¡Œè°ƒæ•´ã€‚ # .golangci.yml linters: disable-all: true enable: - goconst linters-settings: goconst: min-len: 3 min-occurrences: 3 $ golangci-lint run main.go:7:10: string `Hello` has 3 occurrences, make it a constant (goconst) a := \"Hello\" ^ ","date":"2024-04-19","objectID":"/posts/golang-linter/:8:1","tags":["Golang","Linter","Static Check","CI/CD"],"title":"æ·±å…¥è§£è¯» Golang å¸¸ç”¨ Linter å·¥å…·åŠæœ€ä½³å®è·µ","uri":"/posts/golang-linter/"},{"categories":["Golang","Linter","Static Check","CI/CD"],"content":"VII. ineffassign ineffassignï¼Œä¸»è¦ç”¨äºæ£€æµ‹ä»£ç ä¸­å¯¹ç°æœ‰å˜é‡çš„èµ‹å€¼æ“ä½œæ˜¯å¦æœªè¢«ä½¿ç”¨ã€‚ è¿™ç§æœªä½¿ç”¨çš„èµ‹å€¼é€šå¸¸æ˜¯ä»£ç ä¸­çš„æ½œåœ¨é”™è¯¯ï¼Œå¯èƒ½å¯¼è‡´é€»è¾‘ä¸Šçš„æ··ä¹±æˆ–èµ„æºçš„æµªè´¹ã€‚ ","date":"2024-04-19","objectID":"/posts/golang-linter/:9:0","tags":["Golang","Linter","Static Check","CI/CD"],"title":"æ·±å…¥è§£è¯» Golang å¸¸ç”¨ Linter å·¥å…·åŠæœ€ä½³å®è·µ","uri":"/posts/golang-linter/"},{"categories":["Golang","Linter","Static Check","CI/CD"],"content":"å¦‚ä½•ä½¿ç”¨ ineffassign ? é€šå¸¸ä½œä¸º golangci-lint çš„ä¸€éƒ¨åˆ†ä½¿ç”¨ã€‚ linters: disable-all: true enable: - ineffassign ä½¿ç”¨ç¤ºä¾‹ // main.go package main import \"fmt\" func f() { a := \"Hello\" // ... // Not assign a value to `a` // ... a = \"kyden\" fmt.Println(a) } $ golangci-lint run main.go:7:5: ineffectual assignment to a (ineffassign) a := \"Hello\" ^ ","date":"2024-04-19","objectID":"/posts/golang-linter/:9:1","tags":["Golang","Linter","Static Check","CI/CD"],"title":"æ·±å…¥è§£è¯» Golang å¸¸ç”¨ Linter å·¥å…·åŠæœ€ä½³å®è·µ","uri":"/posts/golang-linter/"},{"categories":["Golang","Linter","Static Check","CI/CD"],"content":"VIII. lll é€šè¿‡é™åˆ¶è¡Œçš„é•¿åº¦ï¼Œlll æœ‰åŠ©äºç¡®ä¿ä»£ç åœ¨æŸ¥çœ‹æ—¶ä¸ä¼šæ¨ªå‘æ»šåŠ¨ï¼Œæå‡ä»£ç çš„å¯è¯»æ€§ã€‚ lllï¼Œä¸»è¦ç”¨äºæ£€æŸ¥ä»£ç è¡Œçš„é•¿åº¦ï¼Œæ£€æŸ¥æ¯ä¸€è¡Œçš„é•¿åº¦æ˜¯å¦è¶…è¿‡æŒ‡å®šçš„æœ€å¤§å€¼ã€‚ é»˜è®¤æƒ…å†µä¸‹ï¼Œlll å°†æœ€å¤§è¡Œé•¿åº¦é™åˆ¶ä¸º 120 ä¸ªå­—ç¬¦ã€‚ ","date":"2024-04-19","objectID":"/posts/golang-linter/:10:0","tags":["Golang","Linter","Static Check","CI/CD"],"title":"æ·±å…¥è§£è¯» Golang å¸¸ç”¨ Linter å·¥å…·åŠæœ€ä½³å®è·µ","uri":"/posts/golang-linter/"},{"categories":["Golang","Linter","Static Check","CI/CD"],"content":"å¦‚ä½•ä½¿ç”¨ lll ? lll é€šå¸¸ä½œä¸º golangci-lint çš„ä¸€éƒ¨åˆ†ä½¿ç”¨ã€‚ linters: disable-all: true enable: - lll linters-settings: lll: line-length: 80 ä½¿ç”¨ç¤ºä¾‹ // main.go package kyden func f() int { a := \"This is a very long line that exceeds the maximum line length set by the linter and should be broken up into smaller, more manageable lines.\" return len(a) } golangci-lint run main.go:5: the line is 151 characters long, which exceeds the maximum of 80 characters. (lll) a := \"This is a very long line that exceeds the maximum line length set by the linter and should be broken up into smaller, more manageable lines.\" è§£å†³æ–¹æ¡ˆ ä½¿ç”¨åå¼•å·ï¼ˆ`ï¼‰å®šä¹‰å¤šè¡Œå­—ç¬¦ä¸²ï¼Œå…è®¸å­—ç¬¦ä¸²è·¨è¶Šå¤šè¡Œè€Œä¸éœ€è¦ä½¿ç”¨è¿æ¥ç¬¦ ","date":"2024-04-19","objectID":"/posts/golang-linter/:10:1","tags":["Golang","Linter","Static Check","CI/CD"],"title":"æ·±å…¥è§£è¯» Golang å¸¸ç”¨ Linter å·¥å…·åŠæœ€ä½³å®è·µ","uri":"/posts/golang-linter/"},{"categories":["Golang","Linter","Static Check","CI/CD"],"content":"IX. errcheck errcheckï¼Œä¸“é—¨æ£€æŸ¥æœªå¤„ç†çš„é”™è¯¯ï¼Œç¡®ä¿å¼€å‘è€…åœ¨è°ƒç”¨å¯èƒ½è¿”å›é”™è¯¯çš„å‡½æ•°æ—¶ï¼Œæ­£ç¡®åœ°æ£€æŸ¥å’Œå¤„ç†è¿™äº›é”™è¯¯ï¼Œä»è€Œæé«˜ä»£ç çš„å¥å£®æ€§å’Œå¯é æ€§ã€‚ errcheck ä¼šæ‰«æ Go ä»£ç ï¼ŒæŸ¥æ‰¾æœªæ£€æŸ¥é”™è¯¯çš„åœ°æ–¹ é™¤äº†æ£€æŸ¥å‡½æ•°è¿”å›çš„é”™è¯¯,è¿˜å¯ä»¥æ£€æŸ¥ç±»å‹æ–­è¨€æ˜¯å¦è¢«å¿½ç•¥ å¯ä»¥æ£€æŸ¥æ˜¯å¦å°†é”™è¯¯èµ‹å€¼ç»™äº†ç©ºç™½æ ‡è¯†ç¬¦ ","date":"2024-04-19","objectID":"/posts/golang-linter/:11:0","tags":["Golang","Linter","Static Check","CI/CD"],"title":"æ·±å…¥è§£è¯» Golang å¸¸ç”¨ Linter å·¥å…·åŠæœ€ä½³å®è·µ","uri":"/posts/golang-linter/"},{"categories":["Golang","Linter","Static Check","CI/CD"],"content":"å¦‚ä½•ä½¿ç”¨ ? errcheck é€šå¸¸ä½œä¸º golangci-lint çš„ä¸€éƒ¨åˆ†ä½¿ç”¨ linters-settings: errcheck: check-type-assertions: true # æ£€æŸ¥ç±»å‹æ–­è¨€æ˜¯å¦è¢«å¿½ç•¥,é»˜è®¤ä¸º false check-blank: true # æ£€æŸ¥æ˜¯å¦å°†é”™è¯¯èµ‹å€¼ç»™ç©ºç™½æ ‡è¯†ç¬¦,é»˜è®¤ä¸º false disable-default-exclusions: true # ç¦ç”¨é»˜è®¤çš„å¿½ç•¥å‡½æ•°åˆ—è¡¨,é»˜è®¤ä¸º false exclude-functions: # æŒ‡å®šè¦å¿½ç•¥æ£€æŸ¥çš„å‡½æ•°åˆ—è¡¨ # ... ä½¿ç”¨ç¤ºä¾‹ // main.go package main import ( \"fmt\" ) func main() { hello(\"Kyden\") // err Not Check _ = hello(\"Kyden\") // err assign to _ err := hello(\"Go\") if err != nil { return } } func hello(str string) error { fmt.Printf(\"Hello, %s\", str) return nil } ä¸‹é¢çš„ .golangci.yml ä»…ç”¨äºå±•ç¤º errcheck çš„ç”¨æ³•ï¼Œå…·ä½“å‚æ•°è¯·æ ¹æ®å®é™…é¡¹ç›®è‡ªè¡Œè°ƒæ•´ã€‚ # .golangci.yml linters: disable-all: true enable: - errcheck linters-settings: errcheck: check-type-assertions: true check-blank: true golangci-lint run main.go:9:10: Error return value is not checked (errcheck) hello(\"Kyden\") // err Not Check ^ main.go:11:5: Error return value is not checked (errcheck) _ = hello(\"Kyden\") // err assign to _ ^ ","date":"2024-04-19","objectID":"/posts/golang-linter/:11:1","tags":["Golang","Linter","Static Check","CI/CD"],"title":"æ·±å…¥è§£è¯» Golang å¸¸ç”¨ Linter å·¥å…·åŠæœ€ä½³å®è·µ","uri":"/posts/golang-linter/"},{"categories":["Golang","Linter","Static Check","CI/CD"],"content":"X. whitespace whitespace æ˜¯ä¸€ä¸ª Go è¯­è¨€çš„ linterï¼Œä¸»è¦ç”¨äºæ£€æŸ¥ä»£ç ä¸­ä¸å¿…è¦çš„ç©ºè¡Œï¼Œå³æ£€æŸ¥å‡½æ•°ã€æ¡ä»¶è¯­å¥ï¼ˆå¦‚ ifã€forï¼‰ç­‰å¼€å¤´å’Œç»“å°¾çš„å¤šä½™ç©ºè¡Œã€‚ ","date":"2024-04-19","objectID":"/posts/golang-linter/:12:0","tags":["Golang","Linter","Static Check","CI/CD"],"title":"æ·±å…¥è§£è¯» Golang å¸¸ç”¨ Linter å·¥å…·åŠæœ€ä½³å®è·µ","uri":"/posts/golang-linter/"},{"categories":["Golang","Linter","Static Check","CI/CD"],"content":"å¦‚ä½•ä½¿ç”¨ whitespace ? whitespace ä¹ŸåŒ…å«åœ¨ golangci-lint ä¸­ï¼Œåªéœ€åœ¨é…ç½®ä¸­å¯ç”¨å³å¯ã€‚ linters: disable-all: true enable: - whitespace ä½¿ç”¨ç¤ºä¾‹ // main.go package main import ( \"fmt\" ) func main() { err := hello(\"Kyden\") if err != nil { return } } func hello(str string) error { if len(str) \u003c= 0 { return fmt.Errorf(\"str len \u003c= 0\") } fmt.Printf(\"Hello, %s\", str) return nil } $ gosrc golangci-lint run main.go:15:31: unnecessary leading newline (whitespace) ^ main.go:25:1: unnecessary trailing newline (whitespace) ^ main.go:17:23: unnecessary leading newline (whitespace) ^ ","date":"2024-04-19","objectID":"/posts/golang-linter/:12:1","tags":["Golang","Linter","Static Check","CI/CD"],"title":"æ·±å…¥è§£è¯» Golang å¸¸ç”¨ Linter å·¥å…·åŠæœ€ä½³å®è·µ","uri":"/posts/golang-linter/"},{"categories":["Golang","Linter","Static Check","CI/CD"],"content":"XI. GolangCI-Lint ç”Ÿäº§çº§é™æ€åˆ†æå·¥å…· golangci-lint is a fast Go linters runner. It runs linters in parallel, uses caching, supports YAML configuration, integrates with all major IDEs, and includes over a hundred linters. golangci-lint æ˜¯ä¸€æ¬¾å¿«é€Ÿçš„ Go è¯­è¨€ linterï¼Œå®ƒå¹¶è¡Œè¿è¡Œå¤šä¸ª linter ç¨‹åºï¼Œä½¿ç”¨ç¼“å­˜ï¼Œæ”¯æŒ YAML é…ç½®ï¼Œä¸æ‰€æœ‰ä¸»æµé›†æˆå¼€å‘ç¯å¢ƒé›†æˆï¼Œå¹¶åŒ…å«ä¸€ç™¾å¤šä¸ª linter ç¨‹åºã€‚ ","date":"2024-04-19","objectID":"/posts/golang-linter/:13:0","tags":["Golang","Linter","Static Check","CI/CD"],"title":"æ·±å…¥è§£è¯» Golang å¸¸ç”¨ Linter å·¥å…·åŠæœ€ä½³å®è·µ","uri":"/posts/golang-linter/"},{"categories":["Golang","Linter","Static Check","CI/CD"],"content":"å®‰è£… go install github.com/golangci/golangci-lint/cmd/golangci-lint@latest # Verify golangci-lint --version ","date":"2024-04-19","objectID":"/posts/golang-linter/:13:1","tags":["Golang","Linter","Static Check","CI/CD"],"title":"æ·±å…¥è§£è¯» Golang å¸¸ç”¨ Linter å·¥å…·åŠæœ€ä½³å®è·µ","uri":"/posts/golang-linter/"},{"categories":["Golang","Linter","Static Check","CI/CD"],"content":"å¦‚ä½•ä½¿ç”¨ golangci-lint ? åœ¨ä¸è¿›è¡Œä»»ä½•é…ç½®çš„æƒ…å†µä¸‹ï¼ŒGolangCI-Lint å°†é»˜è®¤é‡‡ç”¨å¯åŠ¨ä»¥ä¸‹ Linters: errcheck, gosimple, govet, ineffassign, staticcheck, unused. ä¹Ÿå¯ä»¥é€šè¿‡ä¼ é€’ -E(--enable) å‚æ•°æ¥å¯åŠ¨ Linterï¼Œä¼ é€’ -D(--disable) æ¥ç¦ç”¨ Linter. golangci-lint run --disable-all -E errcheck ","date":"2024-04-19","objectID":"/posts/golang-linter/:13:2","tags":["Golang","Linter","Static Check","CI/CD"],"title":"æ·±å…¥è§£è¯» Golang å¸¸ç”¨ Linter å·¥å…·åŠæœ€ä½³å®è·µ","uri":"/posts/golang-linter/"},{"categories":["Golang","Linter","Static Check","CI/CD"],"content":"Visual Studio Code é›†æˆ ç”±äºä¸ªäººä¸€ç›´ä½¿ç”¨ VSCode å¼€å‘å„ç§ç¨‹åºï¼Œè¿™é‡Œåªå±•ç¤ºå…¶å¦‚ä½•é›†æˆ GolangCI-Lintã€‚ Step 1. settings.json å¯ç”¨ golangci-lint \"go.lintTool\": \"golangci-lint\", \"go.lintFlags\": [ \"--fast\" // Using it in an editor without --fast can freeze your editor. ] Step 2. é…ç½® .golangci.yml å½“ä½¿ç”¨ Golangci-lint æ—¶ï¼Œå®ƒä¼šè‡ªåŠ¨åœ¨ç¼–è¾‘çš„ Go æ–‡ä»¶æ‰€åœ¨çš„ç›®å½•æˆ–çˆ¶ç›®å½•ä¸­æŸ¥æ‰¾ .golangci.yml é…ç½®æ–‡ä»¶ã€‚ å¦‚æœæ‰¾åˆ°äº†é…ç½®æ–‡ä»¶ï¼ŒGolangci-lint å°±ä¼šæ ¹æ®è¯¥é…ç½®æ–‡ä»¶çš„è®¾ç½®æ¥è¿è¡Œ linterã€‚ å› æ­¤ï¼Œåœ¨ VS Code çš„è®¾ç½®ä¸­ï¼Œä¸éœ€è¦ä¸“é—¨é…ç½® Golangci-lintã€‚ åªéœ€è¦åœ¨é¡¹ç›®æ ¹ç›®å½•æˆ–ç›¸åº”çš„ç›®å½•ä¸‹åˆ›å»º .golangci.yml é…ç½®æ–‡ä»¶ï¼Œå¹¶åœ¨å…¶ä¸­æŒ‡å®šéœ€è¦å¯ç”¨çš„ linter å’Œç›¸å…³é€‰é¡¹å³å¯ã€‚ Step 3. Enjoy your coding time ğŸ¥‚ Golangci-lint åŒæ ·æ”¯æŒ GoLangã€NeoVim ç­‰æµè¡Œ IDE é›†æˆ. ","date":"2024-04-19","objectID":"/posts/golang-linter/:13:3","tags":["Golang","Linter","Static Check","CI/CD"],"title":"æ·±å…¥è§£è¯» Golang å¸¸ç”¨ Linter å·¥å…·åŠæœ€ä½³å®è·µ","uri":"/posts/golang-linter/"},{"categories":["Golang","Linter","Static Check","CI/CD"],"content":".golangci.yml å‚è€ƒé…ç½® è¿™é‡Œç»™å‡ºä¸€ä¸ªä¸ªäººåœ¨ç”¨çš„ golangci-lint å®Œæ•´é…ç½®æ–‡ä»¶ï¼Œä»¥ä¾›å‚è€ƒï¼š run: timeout: 5m go: 1.21 linters-settings: funlen: lines: 150 statements: 100 goconst: min-len: 3 min-occurrences: 3 lll: line-length: 80 govet: # å¯¹äºlinter govetï¼Œè¿™é‡Œæ‰‹åŠ¨å¼€å¯äº†å®ƒçš„æŸäº›æ‰«æè§„åˆ™ shadow: true check-unreachable: true check-rangeloops: true check-copylocks: true # å¯åŠ¨nilnessæ£€æµ‹ enable: - nilness linters: disable-all: true enable: - bodyclose - errcheck - funlen - goconst - gocyclo - gofmt - goimports - gosimple - govet - ineffassign - lll - misspell # Go é™æ€åˆ†æå·¥å…·ï¼Œä¸“æ³¨äºæ£€æŸ¥ä»£ç ä¸­çš„æ‹¼å†™é”™è¯¯ - nilerr - rowserrcheck - staticcheck - typecheck - unconvert - unparam - unused - whitespace issues: skip-dirs: - test exclude-files: - _test.go æ›´å¤šè¯¦ç»†ä¿¡æ¯ï¼Œè¯·å‚è€ƒå®˜æ–¹æ–‡æ¡£ ","date":"2024-04-19","objectID":"/posts/golang-linter/:13:4","tags":["Golang","Linter","Static Check","CI/CD"],"title":"æ·±å…¥è§£è¯» Golang å¸¸ç”¨ Linter å·¥å…·åŠæœ€ä½³å®è·µ","uri":"/posts/golang-linter/"},{"categories":["Golang","Linter","Static Check","CI/CD"],"content":"XII. reviewdog A code review dog who keeps your codebase healthy. reviewdog æ˜¯ä¸€ä¸ªç”¨äºè‡ªåŠ¨åŒ–ä»£ç å®¡æŸ¥çš„å·¥å…·ï¼Œæ—¨åœ¨é€šè¿‡é›†æˆå„ç§ linter å·¥å…·æ¥ç®€åŒ–ä»£ç è´¨é‡æ£€æŸ¥ã€‚å®ƒèƒ½å¤Ÿå°† lint å·¥å…·çš„è¾“å‡ºç»“æœä½œä¸ºè¯„è®ºå‘å¸ƒåˆ°ä»£ç æ‰˜ç®¡æœåŠ¡ï¼ˆå¦‚ GitHubã€GitLab ç­‰ï¼‰ï¼Œä»è€Œæé«˜ä»£ç å®¡æŸ¥çš„æ•ˆç‡å’Œå‡†ç¡®æ€§ã€‚ ","date":"2024-04-19","objectID":"/posts/golang-linter/:14:0","tags":["Golang","Linter","Static Check","CI/CD"],"title":"æ·±å…¥è§£è¯» Golang å¸¸ç”¨ Linter å·¥å…·åŠæœ€ä½³å®è·µ","uri":"/posts/golang-linter/"},{"categories":["Golang","Linter","Static Check","CI/CD"],"content":"åŠŸèƒ½ è‡ªåŠ¨å‘å¸ƒè¯„è®ºï¼šreviewdog å¯ä»¥å°† lint å·¥å…·çš„ç»“æœè‡ªåŠ¨å‘å¸ƒä¸ºè¯„è®ºï¼Œå¸®åŠ©å¼€å‘è€…å¿«é€Ÿè¯†åˆ«ä»£ç ä¸­çš„é—®é¢˜ã€‚ æ”¯æŒå¤šç§ linterï¼šå®ƒæ”¯æŒå¤šç§é™æ€åˆ†æå·¥å…·ï¼ŒåŒ…æ‹¬ golangci-lintã€eslintã€pylint ç­‰ï¼Œå¯ä»¥æ–¹ä¾¿åœ°é›†æˆåˆ°ç°æœ‰çš„å¼€å‘æµç¨‹ä¸­ã€‚ è¿‡æ»¤è¾“å‡ºï¼šæ”¯æŒæ ¹æ® diff è¿‡æ»¤ lint å·¥å…·çš„è¾“å‡ºï¼ŒåªæŠ¥å‘Šåœ¨å½“å‰å˜æ›´ä¸­å‡ºç°çš„é—®é¢˜ã€‚ å¤šç§æŠ¥å‘Šæ¨¡å¼ï¼šæ”¯æŒå¤šç§æŠ¥å‘Šæ¨¡å¼ï¼Œå¦‚ GitHub PR è¯„è®ºã€GitHub Checksã€GitLab åˆå¹¶è¯·æ±‚è®¨è®ºç­‰ã€‚ æœ¬åœ°è¿è¡Œï¼šé™¤äº†åœ¨ CI/CD ç¯å¢ƒä¸­è¿è¡Œå¤–ï¼Œreviewdog ä¹Ÿå¯ä»¥åœ¨æœ¬åœ°ç¯å¢ƒä¸­ä½¿ç”¨ï¼Œæ–¹ä¾¿å¼€å‘è€…åœ¨æäº¤ä»£ç å‰è¿›è¡Œæ£€æŸ¥ã€‚ ","date":"2024-04-19","objectID":"/posts/golang-linter/:14:1","tags":["Golang","Linter","Static Check","CI/CD"],"title":"æ·±å…¥è§£è¯» Golang å¸¸ç”¨ Linter å·¥å…·åŠæœ€ä½³å®è·µ","uri":"/posts/golang-linter/"},{"categories":["Golang","Linter","Static Check","CI/CD"],"content":"å®‰è£… # Install the latest version. (Install it into ./bin/ by default). $ curl -sfL https://raw.githubusercontent.com/reviewdog/reviewdog/master/install.sh | sh -s # Specify installation directory ($(go env GOPATH)/bin/) and version. $ curl -sfL https://raw.githubusercontent.com/reviewdog/reviewdog/master/install.sh | sh -s -- -b $(go env GOPATH)/bin [vX.Y.Z] # In alpine linux (as it does not come with curl by default) $ wget -O - -q https://raw.githubusercontent.com/reviewdog/reviewdog/master/install.sh | sh -s [vX.Y.Z] æ¨èä½¿ç”¨ç¬¬äºŒç§å®‰è£…æ–¹å¼ curl -sfL https://raw.githubusercontent.com/reviewdog/reviewdog/master/install.sh | sh -s -- -b $(go env GOPATH)/binï¼Œå…·ä½“å®‰è£…å®ä¾‹å¦‚ä¸‹ï¼š $ curl -sfL https://raw.githubusercontent.com/reviewdog/reviewdog/master/install.sh | sh -s -- -b $(go env GOPATH)/bin reviewdog/reviewdog info checking GitHub for latest tag reviewdog/reviewdog info found version: 0.20.1 for v0.20.1/Darwin/arm64 reviewdog/reviewdog info installed /Users/kyden/go/bin/reviewdog ","date":"2024-04-19","objectID":"/posts/golang-linter/:14:2","tags":["Golang","Linter","Static Check","CI/CD"],"title":"æ·±å…¥è§£è¯» Golang å¸¸ç”¨ Linter å·¥å…·åŠæœ€ä½³å®è·µ","uri":"/posts/golang-linter/"},{"categories":["Golang","Linter","Static Check","CI/CD"],"content":"å¦‚ä½•ä½¿ç”¨ reviewdog ? æœ¬åœ°ä½¿ç”¨ golangci-lint run ./... 2\u003e\u00261 | reviewdog -f=golangci-lint -reporter=local å®˜æ–¹ç¤ºä¾‹ ","date":"2024-04-19","objectID":"/posts/golang-linter/:14:3","tags":["Golang","Linter","Static Check","CI/CD"],"title":"æ·±å…¥è§£è¯» Golang å¸¸ç”¨ Linter å·¥å…·åŠæœ€ä½³å®è·µ","uri":"/posts/golang-linter/"},{"categories":["Golang","Linter","Static Check","CI/CD"],"content":"Github Action 1. åˆ›å»º GitHub Actions å·¥ä½œæµ åœ¨é¡¹ç›®æ ¹ç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ª GitHub Actions å·¥ä½œæµæ–‡ä»¶ï¼Œ.github/workflows/reviewdog.yml 2. é…ç½® .golangci.yml åœ¨é¡¹ç›®æ ¹ç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ª .golangci.yml é…ç½®æ–‡ä»¶ï¼Œé…ç½®éœ€è¦å¯ç”¨çš„ linter 3. æäº¤ä»£ç  å½“ä½ æäº¤ä»£ç å¹¶åˆ›å»ºæ‹‰å–è¯·æ±‚æ—¶ï¼ŒGitHub Actions ä¼šè‡ªåŠ¨è¿è¡Œ reviewdogï¼Œå¹¶æ ¹æ® lint å·¥å…·çš„è¾“å‡ºåœ¨æ‹‰å–è¯·æ±‚ä¸­æ·»åŠ è¯„è®ºï¼ŒæŒ‡å‡ºä»£ç ä¸­çš„é—®é¢˜ã€‚ æ›´å¤šå†…å®¹è¯·å‚è€ƒå®˜æ–¹ç¤ºä¾‹ ","date":"2024-04-19","objectID":"/posts/golang-linter/:14:4","tags":["Golang","Linter","Static Check","CI/CD"],"title":"æ·±å…¥è§£è¯» Golang å¸¸ç”¨ Linter å·¥å…·åŠæœ€ä½³å®è·µ","uri":"/posts/golang-linter/"},{"categories":["Golang","Linter","Static Check","CI/CD"],"content":"XIII. Summary ç»¼ä¸Šæ‰€è¿°ï¼ŒGolang ç”Ÿæ€ä¸­æœ‰ä¼—å¤šä¼˜ç§€çš„ Linter å·¥å…·ï¼Œå®ƒä»¬èƒ½å¤Ÿæœ‰æ•ˆåœ°æ£€æŸ¥ä»£ç è´¨é‡ï¼Œæé«˜é¡¹ç›®çš„å¯ç»´æŠ¤æ€§å’Œå¯é æ€§ã€‚ å¼€å‘è€…å¯ä»¥æ ¹æ®é¡¹ç›®éœ€æ±‚ï¼Œé€‰æ‹©åˆé€‚çš„ Linter å·¥å…·ï¼Œå¹¶å°†å…¶é›†æˆåˆ° CI/CD æµç¨‹ä¸­ï¼ŒæŒç»­æ”¹å–„ä»£ç è´¨é‡ã€‚ æœªæ¥ï¼Œéšç€ Golang ç¤¾åŒºçš„ä¸æ–­å‘å±•ï¼Œç›¸ä¿¡ä¼šæœ‰æ›´å¤šä¼˜ç§€çš„ Linter å·¥å…·é—®ä¸–ï¼Œä¸º Golang å¼€å‘è€…æä¾›æ›´åŠ å¼ºå¤§çš„ä»£ç åˆ†æèƒ½åŠ›ã€‚ ","date":"2024-04-19","objectID":"/posts/golang-linter/:15:0","tags":["Golang","Linter","Static Check","CI/CD"],"title":"æ·±å…¥è§£è¯» Golang å¸¸ç”¨ Linter å·¥å…·åŠæœ€ä½³å®è·µ","uri":"/posts/golang-linter/"},{"categories":["Golang","Linter","Static Check","CI/CD"],"content":"XIV. Reference Cyclomatic complexity Gocyclo bodyclose sqlrows GolangCI-Lint static analysis reviewdog ","date":"2024-04-19","objectID":"/posts/golang-linter/:16:0","tags":["Golang","Linter","Static Check","CI/CD"],"title":"æ·±å…¥è§£è¯» Golang å¸¸ç”¨ Linter å·¥å…·åŠæœ€ä½³å®è·µ","uri":"/posts/golang-linter/"},{"categories":["Typora","Theme","Markdown","Software"],"content":" å¯¼è¯­ åˆ†äº«ä¸€ä¸ªå¥½çœ‹çš„ Typora ä¸»é¢˜ ","date":"2024-04-18","objectID":"/posts/typora-theme/:0:0","tags":["Typora","Theme","Markdown","Software"],"title":"Typora Theme","uri":"/posts/typora-theme/"},{"categories":["Typora","Theme","Markdown","Software"],"content":"æ•ˆæœ æœ¬ Typora è½¯ä»¶ä¸»é¢˜æ˜¯åœ¨ Purple ä¹‹ä¸Šä¿®æ”¹è€Œæ¥ï¼Œå…·ä½“æ•ˆæœå¦‚ä¸‹ï¼š ","date":"2024-04-18","objectID":"/posts/typora-theme/:1:0","tags":["Typora","Theme","Markdown","Software"],"title":"Typora Theme","uri":"/posts/typora-theme/"},{"categories":["Typora","Theme","Markdown","Software"],"content":"Source ç”±äºå®ç°æºç å¤ªé•¿ï¼Œç»™å‡ºä¸‹è½½è¿æ¥ï¼škyden.css @include-when-export url(https://fonts.loli.net/css?family=Open+Sans:400italic,700italic,700,400\u0026subset=latin,latin-ext); /* open-sans-regular - latin-ext_latin */ @font-face { font-family: \"Open Sans\"; font-style: normal; font-weight: normal; src: local(\"Open Sans Regular\"), local(\"OpenSans-Regular\"), url(\"./github/open-sans-v17-latin-ext_latin-regular.woff2\") format(\"woff2\"); unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD, U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF; } /* open-sans-italic - latin-ext_latin */ @font-face { font-family: \"Open Sans\"; font-style: italic; font-weight: normal; src: local(\"Open Sans Italic\"), local(\"OpenSans-Italic\"), url(\"./github/open-sans-v17-latin-ext_latin-italic.woff2\") format(\"woff2\"); unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD, U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF; } /* open-sans-700 - latin-ext_latin */ @font-face { font-family: \"Open Sans\"; font-style: normal; font-weight: bold; src: local(\"Open Sans Bold\"), local(\"OpenSans-Bold\"), url(\"./github/open-sans-v17-latin-ext_latin-700.woff2\") format(\"woff2\"); unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD, U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF; } /* open-sans-700italic - latin-ext_latin */ @font-face { font-family: \"Open Sans\"; font-style: italic; font-weight: bold; src: local(\"Open Sans Bold Italic\"), local(\"OpenSans-BoldItalic\"), url(\"./github/open-sans-v17-latin-ext_latin-700italic.woff2\") format(\"woff2\"); unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD, U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF; } :root { --title-color: #8064a9; --text-color: #444444; --light-text-color: #666666; --lighter-text-color: #888888; /* --link-color: #2aa899; */ /* --code-color: #745fb5; */ --link-color: #745fb5; /* --code-color: #2aa899; */ --code-color: #ec71b7; --shadow-color: #eee; --border-quote: rgba(116, 95, 181, 0.2); --border-quote-grey: #c8c8c8; --border: #e7e7e7; --link-bottom: #bbb; --shadow: 3px 3px 10px var(--shadow-color); --inline-code-bg: #f4f2f9; --header-weight: normal; --side-bar-bg-color: #fafafa; --control-text-color: var(var(--light-text-color)); --active-file-text-color: var(--title-color); --active-file-bg-color: var(--shadow-color); --item-hover-bg-color: var(--shadow-color); --active-file-border-color: var(var(--title-color)); --base-font: \"Open Sans\", \"Clear Sans\", \"Helvetica Neue\", Helvetica, Arial, sans-serif; --title-font: \"EB Garamond\", \"Source Sans Pro\", serif; --monospace: Courier, Monospace !important; } /* æ‰“å° */ @media print { html { font-size: 0.9rem; } table, pre { page-break-inside: avoid; } pre { word-wrap: break-word; } #write { max-width: 100%; } @page { size: A2; font-size: 0.2rem; /* PDF output size */ margin-left: 0; margin-right: 0; } } html { font-size: 16px; -webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; text-rendering: optimizelegibility; -webkit-font-smoothing: initial; } body { color: var(--text-color); -webkit-font-smoothing: antialiased; line-height: 1.6; letter-spacing: 0; overflow-x: hidden; } /* é¡µè¾¹è· å’Œ é¡µé¢å¤§å° */ #write { font-family: var(--base-font); /* max-width: 914px; */ margin: 0 auto; padding: 1rem 4rem; padding-bottom: 100px; } #write p { line-height: 1.6rem; word-spacing: 0.05rem; } body\u003e*:first-child { margin-top: 0 !important; } body","date":"2024-04-18","objectID":"/posts/typora-theme/:2:0","tags":["Typora","Theme","Markdown","Software"],"title":"Typora Theme","uri":"/posts/typora-theme/"},{"categories":["Typora","Theme","Markdown","Software"],"content":"Reference Typora Purple ","date":"2024-04-18","objectID":"/posts/typora-theme/:3:0","tags":["Typora","Theme","Markdown","Software"],"title":"Typora Theme","uri":"/posts/typora-theme/"},{"categories":[],"content":"Kyden æºèµ· å¥¥åœ°åˆ©å¿ƒç†å­¦å®¶é˜¿å¾·å‹’æ›¾è¯´ï¼Œå¹¸ç¦çš„äººç”¨ç«¥å¹´æ²»æ„ˆä¸€ç”Ÿï¼Œä¸å¹¸çš„äººç”¨ä¸€ç”Ÿæ²»æ„ˆç«¥å¹´ã€‚ æœ¬äººæ¥è‡ªäºåä¸­åœ°åŒºçš„å°å†œæ‘ï¼Œæ¯‹åº¸ç½®ç–‘æ‹¥æœ‰ä¸€ä¸ªéå¸¸è½»æ¾åŠ æ„‰å¿«çš„ç«¥å¹´ï¼Œè€Œâ€œçº¸é¸¢é£èˆâ€å±äºç«¥å¹´ä¸­çš„è®°å¿†æ·±åˆ»çš„äº‹ç‰©ï¼Œæ•…ä»¥æ­¤ä¸ºä½œä¸ºæ˜µç§°ã€‚ Kyden (çº¸é¸¢é£èˆï¼Œé¸¢èˆ) æ¥è‡ª â€œkiteâ€ å’Œâ€œdanceâ€ ç»„åˆçš„å˜ä½“ â€œKiteDanceã€KyteDanceâ€ã€‚ ","date":"2024-04-18","objectID":"/about/:1:0","tags":[],"title":"About KyteDance (é¸¢èˆ)","uri":"/about/"},{"categories":[],"content":"Special Thanks Thanks to the authors of following resources included in the theme: Hugo LoveIt Gitalk ","date":"2024-04-18","objectID":"/about/:2:0","tags":[],"title":"About KyteDance (é¸¢èˆ)","uri":"/about/"},{"categories":["Linux","Software"],"content":" å¯¼è¯­ è¯¦ç»†ä»‹ç»æ—¥å¸¸ä½¿ç”¨ Arch Linux çš„å„ç§é—®é¢˜ä¸è§£å†³æ–¹æ¡ˆï¼ŒåŒ…æ‹¬ Arch å®‰è£…ã€å¸¸ç”¨è½¯ä»¶æ¨èã€ç³»ç»Ÿä¼˜åŒ–ç­‰. ","date":"2024-04-17","objectID":"/posts/arch-linux/:0:0","tags":["Arch","Linux","Software"],"title":"Arch Linux æŒ‡å—","uri":"/posts/arch-linux/"},{"categories":["Linux","Software"],"content":"I. Install Arch ","date":"2024-04-17","objectID":"/posts/arch-linux/:1:0","tags":["Arch","Linux","Software"],"title":"Arch Linux æŒ‡å—","uri":"/posts/arch-linux/"},{"categories":["Linux","Software"],"content":"1. Download Arch Linux ISO archlinux-x86_64.iso ","date":"2024-04-17","objectID":"/posts/arch-linux/:1:1","tags":["Arch","Linux","Software"],"title":"Arch Linux æŒ‡å—","uri":"/posts/arch-linux/"},{"categories":["Linux","Software"],"content":"2. U ç›˜ ventoy å‡†å¤‡ ventory è¿‡ç¨‹ï¼šç•¥ é€‰æ‹© Arch Linux install medium (x86_64, UEFI) å¯åŠ¨å®‰è£…ç¯å¢ƒ è¿›å…¥ root@archiso åï¼Œéœ€è¦è®¾ç½®äº’è”ç½‘ï¼Œæ¨èä½¿ç”¨ç½‘çº¿è¿æ¥ æ£€æŸ¥ç½‘ç»œæ¥å£æ˜¯å¦å·²ç»å¯ç”¨ ip link # ... 2: enp0s3: \u003cBROADCAST,MULTICAST,UP,LOWER_UP\u003e mtu 1500 ... # ... å°–æ‹¬å·å†…çš„â€œUPâ€ï¼Œè¡¨ç¤ºæ¥å£å·²ç»å¯ç”¨ï¼Œå¦åˆ™ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤ï¼šip link set enp0s3 up è¯·ä½¿ç”¨ ping å‘½ä»¤æµ‹è¯•ç½‘ç»œ: ping www.baidu.com ","date":"2024-04-17","objectID":"/posts/arch-linux/:1:2","tags":["Arch","Linux","Software"],"title":"Arch Linux æŒ‡å—","uri":"/posts/arch-linux/"},{"categories":["Linux","Software"],"content":"3. æ›´æ–°ç³»ç»Ÿæ—¶é’Ÿ åœ¨äº’è”ç½‘è¿æ¥ä¹‹åï¼Œsystemd-timesyncd æœåŠ¡å°†è‡ªåŠ¨æ ¡å‡†ç³»ç»Ÿæ—¶é—´ï¼Œä¾¿äºå®‰è£…è½¯ä»¶åŒ…æ—¶éªŒè¯ç­¾å $ timedatectl ","date":"2024-04-17","objectID":"/posts/arch-linux/:1:3","tags":["Arch","Linux","Software"],"title":"Arch Linux æŒ‡å—","uri":"/posts/arch-linux/"},{"categories":["Linux","Software"],"content":"4. åˆ†åŒºè®¾ç½® $ mkfs.ext4 /dev/nvme1n1p7 #ç”¨ä½œæ ¹åˆ†åŒºï¼ŒæŒ‚è½½åˆ° / # mkfs.fat -F32 /dev/nvme1n1p3 #ç”¨ä½œEFIåˆ†åŒº ï¼ŒæŒ‚è½½åˆ° /boot/efi # å¦‚æœå®‰è£…Windowsæ—¶å·²ç»æœ‰ä¸ªEFIåˆ†åŒºï¼Œå°±æŠŠä¸Šé¢çš„ /dev/nvme1n1p3 æ¢æˆå·²æœ‰çš„EFIåˆ†åŒº $ mkfs.ext4 /dev/nvme1n1p8 # æŒ‚è½½åˆ° /home ç›®å½• # mount $ mount /dev/nvme1n1p7 /mnt $ mkdir -p /mnt/boot/efi $ mount /dev/nvme1n1p1 /mnt/boot/efi $ mount --mkdir /dev/nvme1n1p8 /mnt/home ","date":"2024-04-17","objectID":"/posts/arch-linux/:1:4","tags":["Arch","Linux","Software"],"title":"Arch Linux æŒ‡å—","uri":"/posts/arch-linux/"},{"categories":["Linux","Software"],"content":"5. é€‰æ‹©è½¯ä»¶é•œåƒä»“åº“ æ‰‹åŠ¨ä¿®æ”¹ /etc/pacman.d/mirrorlistï¼Œæ·»åŠ ç›¸å…³é•œåƒ $ vim /etc/pacman.d/mirrorlist Server = https://mirrors.ustc.edu.cn/archlinux/$repo/os/$arch Server = https://mirrors.tuna.tsinghua.edu.cn/archlinux/$repo/os/$arch $ pacman -Sy archlinuxcn-keyring $ pacman -Syyu ","date":"2024-04-17","objectID":"/posts/arch-linux/:1:5","tags":["Arch","Linux","Software"],"title":"Arch Linux æŒ‡å—","uri":"/posts/arch-linux/"},{"categories":["Linux","Software"],"content":"6. å®‰è£…åŸºç¡€åŒ… $ pacstrap /mnt bash base base-devel linux linux-headers linux-firmware neovim xsel # fstab $ genfstab -U -p /mnt \u003e\u003e /mnt/etc/fstab ","date":"2024-04-17","objectID":"/posts/arch-linux/:1:6","tags":["Arch","Linux","Software"],"title":"Arch Linux æŒ‡å—","uri":"/posts/arch-linux/"},{"categories":["Linux","Software"],"content":"7. chroot -\u003e è®¾ç½®ç³»ç»Ÿå±æ€§ åˆ‡æ¢ç³»ç»Ÿ $ arch-chroot /mnt è®¾ç½®æ—¶åŒº $ ln -sf /usr/share/zoneinfo/Asia/Shanghai /etc/localtime $ hwclock --systohc ä¿®æ”¹ hostname $ vim /etc/hostname arch è®¾ç½® locale $ vim /etc/locale.conf `LANG_en_US.UTF-8` $ vim /etc/locale.gen en_US.UTF-8 UTF-8 # å–æ¶ˆæ³¨é‡Š zh_CN.UTF-8 UTF-8 # å–æ¶ˆæ³¨é‡Š $ locale-gen ç½‘ç»œç®¡ç†å™¨ï¼Œè“ç‰™ $ pacman -S networkmanager bluez bluez-utils pulseaudio-bluetooth alsa-utils pulseaudio pulseaudio-alsa sof-firmware $ systemctl enable NetworkManager.service $ systemctl enable bluetooth.service è®¾ç½® password $ passwd å¼•å¯¼ç›¸å…³ # ucode $ cat /proc/cpuinfo | grep \"model name\" $ pacman -S intel-ucode # amd-ucode # å®‰è£…å¼•å¯¼åŠ è½½ç¨‹åº $ pacman -S grub efibootmgr os-prober $ grub-install --target=x86_64-efi --efi-directory=/boot/efi --bootloader-id=GRUB # é…ç½® os-prober $ vim /etc/default/grub GRUB_DISABLE_OS_PROBER=false # å–æ¶ˆæ³¨é‡Š $ grub-mkconfig -o /boot/grub/grub.cfg Create user and usergroup $ useradd -m -G wheel kyden # ä¸ºæ–°ç”¨æˆ· kyden è®¾ç½® passwd # ä¿®æ”¹æƒé™ $ pacman -S sudo man-pages man-db $ vim /etc/sudoers %wheel ALL=(ALL:ALL) ALL # å–æ¶ˆæ³¨é‡Š # åˆ‡æ¢è‡³ kyden ç”¨æˆ· $ su - kyden æ¡Œé¢ç¨‹åº - KDE # KDE $ sudo pacman -S plasma xorg nvidia dolphin konsole fish noto-fonts-cjk noto-fonts-emoji $ sudo systemctl enable sddm # reboot $ exit $ swapoff /mnt/swapfile $ umount -R /mnt $ reboot ","date":"2024-04-17","objectID":"/posts/arch-linux/:1:7","tags":["Arch","Linux","Software"],"title":"Arch Linux æŒ‡å—","uri":"/posts/arch-linux/"},{"categories":["Linux","Software"],"content":"II. Software ","date":"2024-04-17","objectID":"/posts/arch-linux/:2:0","tags":["Arch","Linux","Software"],"title":"Arch Linux æŒ‡å—","uri":"/posts/arch-linux/"},{"categories":["Linux","Software"],"content":"NetworkManager $ ping baidu.com $ systemctl enable NetworkManager ","date":"2024-04-17","objectID":"/posts/arch-linux/:2:1","tags":["Arch","Linux","Software"],"title":"Arch Linux æŒ‡å—","uri":"/posts/arch-linux/"},{"categories":["Linux","Software"],"content":"pacman é•œåƒä¿®æ”¹ $ sudo vim /etc/pacman.conf # Misc options Color ParallelDownloads = 5 [multilib] Include = /etc/pacman.d/mirrorlist # é”®å…¥ï¼š [archlinuxcn] Server = https://mirrors.utsc.edu.cn/archlinuxcn/$arch $ sudo pacman -Syyu $ sudo pacman -S archlinuxcn-keyring ","date":"2024-04-17","objectID":"/posts/arch-linux/:2:2","tags":["Arch","Linux","Software"],"title":"Arch Linux æŒ‡å—","uri":"/posts/arch-linux/"},{"categories":["Linux","Software"],"content":"å¸¸è§é€šç”¨è½¯ä»¶ $ yay -S fish # curl -L https://get.oh-my.fish | fish $ fish_config # å–æ¶ˆé—®å€™è¯­ $ set -U fish_greeting \"\" $ sudo vim /etc/systemd/system/clash.service $ sudo systemctl daemon-reload $ sudo systemctl enable clash $ sudo systemctl start clash $ sudo systemctl status clash $ sudo pacman -S obs-studio è¾“å…¥æ³• fcitx5 $ sudo pacman -S fcitx5 fcitx5-configtool fcitx5-qt fcitx5-gtk fcitx5-chinese-addons fcitx5-material-color fcitx5-pinyin-moegirl fcitx5-pinyin-zhwiki $ sudo vim /etc/environment GTK_IM_MODULE=fcitx QT_IM_MODULE=fcitx XMODIFIERS=\\@im=fcitx # ä¸ºäº†è®©ä¸€äº›ä½¿ç”¨ç‰¹å®šç‰ˆæœ¬ SDL2 åº“çš„æ¸¸æˆèƒ½æ­£å¸¸ä½¿ç”¨è¾“å…¥æ³• SDL_IM_MODULE=fcitx $ yay -S clash-verge-rev-bin $ yay -Sy neofetch google-chrome obs-studio baidunetdisk \\ nutstore-experimental xunlei-bin telegram-desktop \\ gitkraken visual-studio-code-bin typora-free redis \\ net-tools pot-translation translate-shell okular \\ snipaste gwenview kcalc wemeet-bin vlc wget ark \\ shotcut inkscape ninja gnu-netcat tcpdump cmake \\ clang tree python-pip caj2pdf-qt ttf-hack-nerd \\ transmission-gtk gpick speedcrunch drawio-desktop \\ zeal electronic-wechat-uos-bin \\ linuxqq lx-music-desktop gpick: å¯ä»¥ä»æ¡Œé¢ä»»ä½•åœ°æ–¹å–è‰²ï¼Œå¹¶ä¸”å®ƒè¿˜æä¾›ä¸€äº›å…¶å®ƒçš„é«˜çº§ç‰¹æ€§ SpeedCrunch: ä¸€ä¸ªæ¼‚äº®ï¼Œå¼€æºï¼Œé«˜ç²¾åº¦çš„ç§‘å­¦è®¡ç®—å™¨ Snipaste: æˆªå›¾å·¥å…·ï¼Œå¦‚ä¸å¯ç”¨å¯é€‰ç”¨spectacle drawio-desktop: Security-first diagramming for teams zealï¼šç¦»çº¿æ–‡æ¡£æµè§ˆå™¨ trans-shell åŸºç¡€ç”¨æ³• # ç¿»è¯‘åˆ°localeè¯­è¨€ $ trans [Words] # ç¿»è¯‘åˆ°æŒ‡å®šè¯­è¨€ $ trans :zh [word] # ç¿»è¯‘åˆ°å¤šç§ç›®æ ‡è¯­è¨€ $ trans :zh+ja word # ç¿»è¯‘å¥å­å’ŒçŸ­è¯­ $ trans en:zh \"word processor\" $ trans :zh \"To-morrow, and to-morrow, and to-morrow,\" # ç®€æ´æ¨¡å¼ï¼šé»˜è®¤æƒ…å†µä¸‹ï¼ŒTranslate Shell å°½å¯èƒ½å¤šçš„æ˜¾ç¤ºç¿»è¯‘ä¿¡æ¯ã€‚å¦‚æœä½ å¸Œæœ›åªæ˜¾ç¤ºç®€è¦ä¿¡æ¯ï¼Œåªéœ€è¦åŠ ä¸Š -bé€‰é¡¹ã€‚ $ trans -b :zh \"Saluton, Mondo\" $ trans -b :@ja \"Saluton, Mondo\" #æ˜¾ç¤ºå‘éŸ³ç¬¦å·ï¼Œå¦‚æœæœ‰çš„è¯ï¼Œå¦‚æ—¥è¯­ç½—é©¬éŸ³ï¼Œæ±‰è¯­æ‹¼éŸ³ # ç¿»è¯‘æ–‡ä»¶æˆ–ç½‘é¡µ $ trans :zh file://\u003cinput.txt\u003e $ trans :zh https://github.com/kydance/ # è¿›å…¥äº¤äº’æ¨¡å¼ $ trans -shell $ trans -shell en:fr Alais tsbz 'trans -b :zh' tsz 'trans :zh' tsbe 'trans -b :en' tse 'trans :en' office $ yay -S wps-office wps-office-mui-zh-cn ttf-wps-fonts ","date":"2024-04-17","objectID":"/posts/arch-linux/:2:3","tags":["Arch","Linux","Software"],"title":"Arch Linux æŒ‡å—","uri":"/posts/arch-linux/"},{"categories":["Linux","Software"],"content":"è¿œç¨‹å·¥å…· - Remmina $ yay -S remmina freerdp ä½¿ç”¨æ•™ç¨‹ å®‰è£… freerdp æ’ä»¶åï¼Œå¯ä»¥èµ° RDP åè®®è¿œç¨‹ Win10ï¼ˆWin10 ä¸éœ€è¦å…¶ä»–ä»»ä½•è®¾ç½®ï¼‰ ","date":"2024-04-17","objectID":"/posts/arch-linux/:2:4","tags":["Arch","Linux","Software"],"title":"Arch Linux æŒ‡å—","uri":"/posts/arch-linux/"},{"categories":["Linux","Software"],"content":"Git é…ç½® git è®¾ç½®user.nameå’Œuser.emal $ git config --global user.name \"kyden\" $ git config --global user.email xxxxxx@gmail.com # Verify $ git config --list ç”Ÿæˆå¯†é’¥ # è¦æ±‚å¤šæ¬¡è¾“å…¥å¯†ç ï¼Œå¯ä¸è¦è¾“å…¥å¯†ç  $ ssh-keygen -t rsa -C 'xxxxxx@gmail.com' GitHub é…ç½® SSH Keys æ‰“å¼€ç”Ÿæˆçš„ Key æ–‡ä»¶ ~/.ssh/id_rsa.pub: cat ~/.ssh/id_rsa.pub å¤åˆ¶å…¨éƒ¨å†…å®¹ï¼Œåœ¨ Key ä¸­ç²˜è´´ Git å¸¸ç”¨å‘½ä»¤ git status git clone git pull git push git commit -m 'commits' or git commit -m 'commits' kyden.go git add . or git kyden.go git reflog Gitå®ç°ä»æœ¬åœ°æ·»åŠ é¡¹ç›®åˆ°è¿œç¨‹ä»“åº“ Steps: GitHub ä¸Šåˆ›å»ºä¸€ä¸ªæ–°çš„è¿œç¨‹ä»“åº“ - Create a new repo -\u003e Create repository æœ¬åœ°ä»“åº“ï¼šåˆ›å»ºå¹¶åˆå§‹åŒ– -\u003e æ·»åŠ å¾…ä¸Šä¼ åˆ°è¿œç¨‹ä»“åº“çš„é¡¹ç›®æ–‡ä»¶ git init è¿œç¨‹ä»“åº“å’Œæœ¬åœ°ä»“åº“å…³è” git remote add origin git@github.com:kydance/\u003crepository name\u003e é¡¹ç›®æ–‡ä»¶æ·»åŠ ã€æäº¤ã€æ¨é€ ç”±äºè¿œç¨‹åº“æ˜¯ç©ºçš„ï¼Œæˆ‘ä»¬ç¬¬ä¸€æ¬¡ push master åˆ†æ”¯æ—¶ï¼ŒåŠ ä¸Šäº† -u å‚æ•°ï¼ŒGit ä¸ä½†ä¼šæŠŠæœ¬åœ°çš„ master åˆ†æ”¯å†…å®¹æ¨é€çš„è¿œç¨‹æ–°çš„ master åˆ†æ”¯ï¼Œè¿˜ä¼šæŠŠæœ¬åœ°çš„ master åˆ†æ”¯å’Œè¿œç¨‹çš„ master åˆ†æ”¯å…³è”èµ·æ¥ åœ¨ä»¥åçš„ push æˆ–è€… pull æ—¶å°±å¯ä»¥ç®€åŒ–å‘½ä»¤ git add file $ git commit -m '\u003ccommit statements\u003e' file $ git push -u origin master ç”¨ SSH å¯†é’¥åœ¨ä¸€å°æœºå™¨ä¸Šç®¡ç†å¤šä¸ªè´¦æˆ· ","date":"2024-04-17","objectID":"/posts/arch-linux/:2:5","tags":["Arch","Linux","Software"],"title":"Arch Linux æŒ‡å—","uri":"/posts/arch-linux/"},{"categories":["Linux","Software"],"content":"Golang # Download and install go $ sudo pacman -S go $ vim .config/fish/config.sh # Set environment variable in `.config/fish/config.sh` or `/etc/profile` or `~/.profile` GOROOT /usr/lib/go GOPATH /home/kyden/goProj GOBIN /home/kyden/goProj/bin PATH $GOPATH/bin $GOROOT/bin $GOBIN $PATH GOROOTï¼Œè®¾ç½® Golang çš„å®‰è£…ä½ç½® GOBINï¼Œæ‰§è¡Œ go install åç”Ÿæˆå¯æ‰§è¡Œæ–‡ä»¶çš„ç›®å½• GOPATHï¼Œå·¥ä½œç›®å½•ï¼Œä¸€èˆ¬è®¾ç½®åˆ°ç”¨æˆ·ç›®å½•ä¸‹ ","date":"2024-04-17","objectID":"/posts/arch-linux/:2:6","tags":["Arch","Linux","Software"],"title":"Arch Linux æŒ‡å—","uri":"/posts/arch-linux/"},{"categories":["Linux","Software"],"content":"MySQL å¾ˆå¤š Linux å‘è¡Œç‰ˆéƒ½æ”¾å¼ƒäº†å¯¹ MySQL çš„æ”¯æŒï¼ˆåŸå› è‡ªè¡Œ Googleï¼‰è½¬è€Œæ”¯æŒ mariadbï¼ˆMySQLçš„å¦ä¸€ä¸ªåˆ†æ”¯ï¼‰ï¼ŒArch Linuxå°±æ˜¯å…¶ä¸­ä¹‹ä¸€ï¼Œmariadb å…·æœ‰å’Œ MySQL ä¸€æ¨¡ä¸€æ ·çš„æ“ä½œå‘½ä»¤ï¼Œæ‰€ä»¥å®Œå…¨ä¸ç”¨è€ƒè™‘è¿ç§»å…¼å®¹çš„é—®é¢˜ å®‰è£…mariadb: $ sudo pacman -Sy mariadb é…ç½® mariadb å‘½ä»¤ï¼Œåˆ›å»ºæ•°æ®åº“éƒ½åœ¨ /var/lib/mysql/ ç›®å½•ä¸‹é¢: $ sudo mysql_install_db --user=mysql --basedir=/usr --datadir=/var/lib/mysql å¼€å¯mariadb æœåŠ¡: $ systemctl start mariadb åˆå§‹åŒ–å¯†ç ï¼ŒæœŸé—´æœ‰è®©ä½ è®¾ç½®å¯†ç çš„é€‰é¡¹ï¼Œè®¾ç½®ä½ è‡ªå·±çš„å¯†ç å°±è¡Œäº†ï¼Œç„¶åæ ¹æ®è‡ªå·±éœ€è¦ y/n å°±å¯ï¼Œå› ä¸ºå¾ˆå¤šåé¢å¯ä»¥å†ä¿®æ”¹: $ sudo /usr/bin/mysql_secure_installation ç™»å½•mariadb å’Œmysqlå‘½ä»¤æ˜¯ä¸€æ ·çš„: $ mysql -u root -p è®¾ç½®å¼€æœºè‡ªå¯åŠ¨æœåŠ¡: $ systemctl enable mariadb ","date":"2024-04-17","objectID":"/posts/arch-linux/:2:7","tags":["Arch","Linux","Software"],"title":"Arch Linux æŒ‡å—","uri":"/posts/arch-linux/"},{"categories":["Linux","Software"],"content":"æŒ‚è½½å…¶ä»–ç¡¬ç›˜åˆ†åŒº # Get UUID and TYPE $ sudo blkid # eg: # /dev/nvme1n1p3: LABEL=\"Document\" BLOCK_SIZE=\"512\" UUID=\"111915F1111915F1\" TYPE=\"ntfs\" PARTLABEL=\"Basic data partition\" PARTUUID=\"666266ba-233b-11ed-95be-00e04c3656eb\" # Write UUID TYPE ... $ sudo vim /etc/fstab # \u003cdevice\u003e \u003cdir\u003e \u003ctype\u003e \u003coptions\u003e \u003cdump\u003e \u003cfsck\u003e UUID=111915F1111915F1 /home/kyden/doc ntfs3 defaults 0 0 \u003cdevice\u003e æè¿°è¦æŒ‚è½½çš„ç‰¹å®šå—è®¾å¤‡æˆ–è¿œç¨‹æ–‡ä»¶ç³»ç»Ÿ \u003cdir\u003e æè¿°æŒ‚è½½ç›®å½• \u003ctype\u003e æ–‡ä»¶ç³»ç»Ÿç±»å‹ \u003coptions\u003e ç›¸å…³çš„æŒ‚è½½é€‰é¡¹ \u003cdump\u003e ä¼šè¢« dump(8) å·¥å…·æ£€æŸ¥ã€‚è¯¥å­—æ®µé€šå¸¸è®¾ç½®ä¸º 0, ä»¥ç¦ç”¨æ£€æŸ¥ \u003cfsck\u003e è®¾ç½®å¼•å¯¼æ—¶æ–‡ä»¶ç³»ç»Ÿæ£€æŸ¥çš„é¡ºåº; å¯¹äº root è®¾å¤‡è¯¥å­—æ®µåº”è¯¥è®¾ç½®ä¸º 1ã€‚å¯¹äºå…¶å®ƒåˆ†åŒºè¯¥å­—æ®µåº”è¯¥è®¾ç½®ä¸º 2,æˆ–è®¾ç½®ä¸º 0 ä»¥ç¦ç”¨æ£€æŸ¥ NOTE: TYPE ä¸º ntfs æ—¶å¯¼è‡´å¯åŠ¨å¤±è´¥ï¼Œä¿®æ”¹ä¸º ntfs3 åæˆåŠŸæŒ‚è½½ ","date":"2024-04-17","objectID":"/posts/arch-linux/:2:8","tags":["Arch","Linux","Software"],"title":"Arch Linux æŒ‡å—","uri":"/posts/arch-linux/"},{"categories":["Linux","Software"],"content":"Present Windows ","date":"2024-04-17","objectID":"/posts/arch-linux/:2:9","tags":["Arch","Linux","Software"],"title":"Arch Linux æŒ‡å—","uri":"/posts/arch-linux/"},{"categories":["Linux","Software"],"content":"scp: æ–‡ä»¶ä¸Šä¼ ã€ä¸‹è½½ ä¸Šä¼  $ scp ./cifar-10-python.tar.gz kyden@\u003cip\u003e:/home/kyden/ ä¸‹è½½ $ scp kyden@\u003cip\u003e:/var/tmp/a.txt /var ","date":"2024-04-17","objectID":"/posts/arch-linux/:2:10","tags":["Arch","Linux","Software"],"title":"Arch Linux æŒ‡å—","uri":"/posts/arch-linux/"},{"categories":["Linux","Software"],"content":"picgo picgo-core Download and Install PigGo-Core Get token with GitHub Configure NOTEï¼šä½¿ç”¨æ—¶ï¼Œå°†æ³¨é‡Šåˆ æ‰ï¼Œä»¥å…äº§ç”Ÿä¸å¿…è¦çš„éº»çƒ¦ // ~/.picgo/config.json { \"picBed\": { \"current\": \"github\", \"github\": { \"repo\": \"\u003cuserName\u003e/PicBed\", // è®¾å®šä»“åº“åï¼šä¸Šæ–‡åœ¨ GitHub åˆ›å»ºçš„ä»“åº“ `\u003cuserName\u003e/PicBed` \"branch\": \"master\", // è®¾å®šåˆ†æ”¯åï¼š`master` \"token\": \"xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx\", // è®¾å®š Tokenï¼šä¸Šæ–‡ç”Ÿæˆçš„ toke \"path\": \"\", // æŒ‡å®šå­˜å‚¨è·¯å¾„ï¼šä¸ºç©ºçš„è¯ä¼šä¸Šä¼ åˆ°æ ¹ç›®å½•ï¼Œä¹Ÿå¯ä»¥æŒ‡å®šè·¯å¾„ \"customUrl\": \"\" // è®¾å®šè‡ªå®šä¹‰åŸŸåï¼šå¯ä»¥ä¸ºç©º }, \"uploader\": \"github\", \"transformer\": \"path\" }, \"picgoPlugins\": { \"picgo-plugin-github-plus\": true } } ","date":"2024-04-17","objectID":"/posts/arch-linux/:2:11","tags":["Arch","Linux","Software"],"title":"Arch Linux æŒ‡å—","uri":"/posts/arch-linux/"},{"categories":["Linux","Software"],"content":"CUDA \u0026 cuDNN $ yay -S cuda-11.7 cudnn8-cuda11.0 Arch Linux ä¼šå°† CUDA ç›¸å…³æ¡£æ¡ˆå®‰è£…è‡³ /opt/cudaï¼Œæœ‰éœ€è¦çš„è¯å¯ä»¥å°† CUDA çš„ PATH åŠ åˆ° ~/bashrcï¼Œæ­¤è·¯å¾„æ°¸è¿œæŒ‡å‘æœ€æ–°ç‰ˆCUDA # ~/.fish_config set PATH /opt/cuda-11.7/bin $PATH set LD_LIBRARY_PATH /opt/cuda-11.7/lib64/ $PATH pip install torch==1.13.1+cu117 torchvision==0.14.1+cu117 torchaudio==0.13.1 --extra-index-url https://download.pytorch.org/whl/cu117 ","date":"2024-04-17","objectID":"/posts/arch-linux/:2:12","tags":["Arch","Linux","Software"],"title":"Arch Linux æŒ‡å—","uri":"/posts/arch-linux/"},{"categories":["Linux","Software"],"content":"Clash Verge DNS æ³„éœ²é—®é¢˜ DNS æ³„éœ²å…¶å®å¹¶æ²¡æœ‰ä¸€ä¸ªæ˜ç¡®çš„å®šä¹‰ï¼Œä¹Ÿä¸å­˜åœ¨ä¸€ä¸ªå®˜æ–¹è§£é‡Šã€‚ å¤§æ¦‚å°±æ˜¯è¯´ä½ è®¿é—®YouTubeç­‰é»‘åå•ç½‘ç«™çš„æ—¶å€™ï¼Œä½¿ç”¨ä¸­å›½å¤§é™†çš„DNSæœåŠ¡å™¨è¿›è¡Œäº†è§£æï¼Œè¿™å¯èƒ½å¯¼è‡´éšç§é—®é¢˜çš„ã€‚ å¦‚æœåœ¨ DNS Leak Test ã€ipleakè¿™ç§ç½‘ç«™çš„åˆ—è¡¨ä¸­çœ‹åˆ°äº†ä¸­å›½å›½æ——ï¼Œå°±è¦æ„è¯†åˆ°å¯èƒ½å‘ç”Ÿäº†DNSæ³„éœ²ã€‚ è™½ç„¶æ²¡æœ‰äººçŸ¥é“å…·ä½“çš„æ¢æµ‹æœºåˆ¶æ˜¯ä»€ä¹ˆï¼Œä½†å¾ˆå¯èƒ½æ˜¯ä»ç½‘ç»œå±‚é¢è·å–çš„ã€‚åœ¨ä¸€èˆ¬çš„å®¶åº­ç½‘ç»œæ‹“æ‰‘ä¸­ï¼Œwiresharkå¯ä»¥çœ‹åˆ°ä»€ä¹ˆå†…å®¹ï¼Œè¿è¥å•†å°±èƒ½çœ‹è§ä»€ä¹ˆå†…å®¹ï¼Œæ‰€ä»¥ä½ ä½¿ç”¨114.114.114.114ã€223.5.5.5è¿™æ ·çš„DNSè§£æå»è®¿é—®äº†ä»€ä¹ˆç½‘ç«™æ˜¯å¾ˆæ¸…æ™°çš„ã€‚ Clashå¼€å¯TUNæ¨¡å¼ï¼Œå…³é—­ç³»ç»Ÿä»£ç†å»ä½¿ç”¨ï¼šä¸æ™®é€šçš„ç³»ç»Ÿä»£ç†æ¨¡å¼åŒºåˆ«åœ¨äºï¼ŒTUNæ¨¡å¼ä¸‹Clashä¼šåˆ›å»ºä¸€å¼ è™šæ‹Ÿç½‘å¡ï¼Œä»ç½‘ç»œå±‚é¢æ¥ç®¡æ‰€æœ‰çš„ç½‘ç»œæµé‡ã€‚ å¼€å¯TUNæ¨¡å¼ ä½¿ç”¨ç¨³å®šçš„DNS DNSè¿™éƒ¨åˆ†æœ‰äººä¼šæ•™ä½¿ç”¨è¿è¥å•†çš„DNSï¼Œè¿è¥å•†çš„DNSåªé€‚åˆå°ç™½ç”¨æˆ·ï¼Œå› ä¸ºä»–å¯èƒ½è¿åè¯ˆï¼Œæ‰€ä»¥å»ºè®®ä½¿ç”¨å›½å†…å¤§å‚çš„ã€‚ [Optional] å…³é—­æµè§ˆå™¨çš„QUIC, ä¸­å›½å¤§é™†çš„ispæ˜¯é™é€Ÿudpçš„, æ‰€ä»¥å¯¼è‡´QUICè¿™ä¸ªä¼˜ç§€çš„åè®®, åˆ°äº†ä¸­å›½å¤§é™†çš„ç½‘ç»œä¸‹æˆäº†ä¸ªè´Ÿé¢å¢ç›Šæ•ˆæœã€‚ about://flags/#enable-quic è®¾ç½®ä¸ºDisabled (ç‚¹ä¸‹æ–¹å¼¹å‡ºçš„é‡å¯æµè§ˆå™¨ç”Ÿæ•ˆ) å…³é—­æµè§ˆå™¨ä¸­çš„â€œå®‰å…¨DNSâ€ chrome://settings/security åœ¨Clash Vergeçš„ã€Profilesã€‘ä¸­ï¼Œç‚¹å³ä¸Šè§’çš„\"NEW\" -\u003e Typeé€‰æ‹©\"Script\" -\u003e Nameéšæ„å¡«å†™(ä¾‹å¦‚ï¼Œâ€œä¿®æ”¹DNSâ€) å³å‡»æ–°å»ºçš„æ–‡ä»¶ï¼Œç„¶å\"Edit File\"ï¼Œè¾“å…¥ä»¥ä¸‹å†…å®¹åå¯ç”¨ï¼š function main(content) { const isObject = (value) =\u003e { return value !== null \u0026\u0026 typeof value === 'object' } const mergeConfig = (existingConfig, newConfig) =\u003e { if (!isObject(existingConfig)) { existingConfig = {} } if (!isObject(newConfig)) { return existingConfig } return { ...existingConfig, ...newConfig } } const cnDnsList = [ 'tls://223.5.5.5', 'tls://1.12.12.12', ] const trustDnsList = [ 'https://doh.apad.pro/dns-query', 'https://dns.cooluc.com/dns-query', 'https://1.0.0.1/dns-query', ] const notionDns = 'tls://dns.jerryw.cn' const notionUrls = [ 'http-inputs-notion.splunkcloud.com', '+.notion-static.com', '+.notion.com', '+.notion.new', '+.notion.site', '+.notion.so', ] const combinedUrls = notionUrls.join(','); const dnsOptions = { 'enable': true, 'default-nameserver': cnDnsList, // ç”¨äºè§£æDNSæœåŠ¡å™¨ çš„åŸŸå, å¿…é¡»ä¸ºIP, å¯ä¸ºåŠ å¯†DNS 'nameserver-policy': { [combinedUrls]: notionDns, 'geosite:geolocation-!cn': trustDnsList, }, 'nameserver': trustDnsList, // é»˜è®¤çš„åŸŸåè§£ææœåŠ¡å™¨, å¦‚ä¸é…ç½®fallback/proxy-server-nameserver, åˆ™æ‰€æœ‰åŸŸåéƒ½ç”±nameserverè§£æ } // GitHubåŠ é€Ÿå‰ç¼€ const githubPrefix = 'https://ghproxy.lainbo.com/' // GEOæ•°æ®GitHubèµ„æºåŸå§‹ä¸‹è½½åœ°å€ const rawGeoxURLs = { geoip: 'https://github.com/MetaCubeX/meta-rules-dat/releases/download/latest/geoip-lite.dat', geosite: 'https://github.com/MetaCubeX/meta-rules-dat/releases/download/latest/geosite.dat', mmdb: 'https://github.com/MetaCubeX/meta-rules-dat/releases/download/latest/country-lite.mmdb', } // ç”Ÿæˆå¸¦æœ‰åŠ é€Ÿå‰ç¼€çš„GEOæ•°æ®èµ„æºå¯¹è±¡ const accelURLs = Object.fromEntries( Object.entries(rawGeoxURLs).map(([key, githubUrl]) =\u003e [key, `${githubPrefix}${githubUrl}`]), ) const otherOptions = { 'unified-delay': true, 'tcp-concurrent': true, 'profile': { 'store-selected': true, 'store-fake-ip': true, }, 'sniffer': { enable: true, sniff: { TLS: { ports: [443, 8443], }, HTTP: { 'ports': [80, '8080-8880'], 'override-destination': true, }, }, }, 'geodata-mode': true, 'geox-url': accelURLs, } content.dns = mergeConfig(content.dns, dnsOptions) return { ...content, ...otherOptions } } è®¾ç½®å®Œæˆåï¼ŒéªŒè¯DNSè§£æç»“æœæ˜¯å¦éƒ½æ˜¯æ¥è‡ªå›½å¤–çš„Cloudflareå’ŒGoogleçš„DNS, è¿™æ—¶èŠ‚ç‚¹æœåŠ¡å™¨ä¸ç®¡æ‹¿åˆ°äº†ä½ ä¼ è¿‡å»çš„çœŸipè¿˜æ˜¯å‡ipåœ°å€, ä»–éƒ½ä¼šå†å»è¯·æ±‚ä¸€æ¬¡Cloudflare/Googleçš„DNSæœåŠ¡, ç¡®ä¿è§£æçš„æ­£ç¡®æ€§ã€‚ é‡è¦çš„æ˜¯æ²¡æœ‰ä¸­å›½å¤§é™†çš„DNSæœåŠ¡å™¨äº†ï¼Œå¦‚æœè¿˜æ˜¯æœ‰ï¼Œé‚£ä½ åº”è¯¥å¾€å½“å‰è®¾å¤‡çš„æ›´ä¸Šå±‚å¯»æ‰¾é—®é¢˜æ‰€åœ¨ï¼Œæ¯”å¦‚è·¯ç”±å™¨çš„è®¾ç½®ç­‰ã€‚ GEOIPï¼ŒCNé—®é¢˜ ç›®å‰å¸‚é¢ä¸Šç»å¤§å¤šæ•°çš„ä»£ç†å·¥å…·éƒ½ä¾èµ–äº GeoIP2 æ•°æ®åº“åˆ¤æ–­åœ°å€æ‰€å±åœ°ã€‚å®ƒä»¬çš„è§„åˆ™ç»“å°¾éƒ¨åˆ†ä¸€èˆ¬éƒ½ä¼šæœ‰ä¸€æ¡ç±»ä¼¼ GEOIP, CNï¼Œç”¨æ¥æŸ¥è¯¢ç›®çš„ IP åœ°å€æ˜¯å¦å±äºä¸­å›½å¤§é™†ï¼Œä»è€Œåˆ¤æ–­æ˜¯å¦ç›´è¿ã€‚ è¿™äº›ä»£ç†å·¥å…·é€šå¸¸ä½¿ç”¨çš„ GeoIP2 æ•°æ®åº“æ˜¯æ¥è‡ªäº MaxMind çš„ GeoLite2 å…è´¹æ•°æ®åº“ã€‚è¿™ä¸ªæ•°æ®åº“ç›®å‰å­˜åœ¨ä¸€ä¸‹å‡ ä¸ªé—®é¢˜ï¼š è·å–ä¸ä¾¿ï¼šä» 2019 å¹´ 12 æœˆ 30 æ—¥èµ·ï¼Œå¿…é¡»æ³¨å†Œåæ‰èƒ½ä¸‹è½½ æ•°æ®é‡å¤§ï¼šæ•°æ®åº“åºå¤§ï¼ŒåŒ…å«å…¨çƒçš„ IP åœ°å€æ®µï¼Œçº¦ 10 MB å‡†ç¡®åº¦ä½ï¼šå¯¹ä¸­å›½å¤§é™†çš„ IP åœ°å€åˆ¤å®šä¸å‡†ï¼Œå¦‚ï¼šé¦™æ¸¯é˜¿é‡Œäº‘çš„ IP è¢«åˆ¤å®šä¸ºæ–°åŠ å¡ã€ä¸­å›½å¤§é™†ç­‰ã€‚ åºå¤§çš„æ•°æ®é‡å¯¹äºå¤§å¤šæ•°ä¸­å›½å¤§é™†çš„ç”¨æˆ·æ¥è¯´æ˜¯æ²¡æœ‰æ„ä¹‰çš„ï¼Œå› ä¸ºåªä»…éœ€è¦å»åˆ¤æ–­ IP çš„åœ°ç†ä½ç½®æ˜¯å¦å±äºä¸­å›½å¤§é™†å¢ƒå†…ï¼Œå…¶ä»–å›½å®¶çš„ IP ä¸€å¾‹ä»£ç†/ç›´è¿ã€‚è¿‡å¤šçš„æ•°æ®é‡ä¼šå¢åŠ è½½å…¥æ—¶é—´ï¼Œé™ä½æŸ¥è¯¢æ•ˆç‡ã€‚ æˆ‘ä»¬åœ¨ä¹‹å‰åˆ›å»ºçš„Scriptä¸­å·²ç»åŒ…å«äº†ä¸‹è½½æ›´ç²¾ç®€åˆé€‚ä¸­å›½å¤§é™†çš„IPæ•°æ®åº“é“¾æ¥, ç°åœ¨åªéœ€è¦æ‰‹åŠ¨æ“ä½œä¸‹è½½å’Œæ›¿æ¢å³å¯: Update GeoData: Clash Verge Revçš„è®¾ç½®èœå•ä¸­ç‚¹å‡»Update GeoData éªŒè¯ä¸‹è½½: æ‰“å¼€Clash Vergeæ‰˜ç›˜ä¸­çš„APP Dirï¼Œæ‰¾åˆ°geoip.datæ–‡ä»¶ï¼ŒéªŒè¯å…¶å¤§å°æ˜¯å¦ä¸ºå‡ ç™¾KB é‡å¯Clash Vergeï¼šç¡®ä¿æ•°æ®åº“è¢«æ­£ç¡®åº”ç”¨ ","date":"2024-04-17","objectID":"/posts/arch-linux/:2:13","tags":["Arch","Linux","Software"],"title":"Arch Linux æŒ‡å—","uri":"/posts/arch-linux/"},{"categories":["Linux","Software"],"content":"III. å†…æ ¸æ›´æ¢ Install The Desired Kernel $ sudo pacman -S linux-lts linux-lts-headers Editing GRUB Config File $ sudo vim /etc/default/grub GRUB_DISABLE_SUBMENU=y # disables the GRUB submenu, i.e., it enables all the available kernels to be listed on the main GRUB Menu itself instead of the â€œAdvanced option for Arch Linuxâ€ option. GRUB_DEFAULT=saved # saves the last kernel used GRUB_SAVEDEFAULT=true # makes sure that grub uses the last selected kernel is used as default Re-Generate GRUB Configuration file $ sudo grub-mkconfig -o /boot/grub/grub.cfg Choose Kernel From GRUB During Boot. ğŸ¥‚ ","date":"2024-04-17","objectID":"/posts/arch-linux/:3:0","tags":["Arch","Linux","Software"],"title":"Arch Linux æŒ‡å—","uri":"/posts/arch-linux/"},{"categories":["Linux","Software"],"content":"IV. System optimization ","date":"2024-04-17","objectID":"/posts/arch-linux/:4:0","tags":["Arch","Linux","Software"],"title":"Arch Linux æŒ‡å—","uri":"/posts/arch-linux/"},{"categories":["Linux","Software"],"content":"SSD ä¼˜åŒ– TRIM, ä¼šå¸®åŠ©æ¸…ç†SSDä¸­çš„å—ï¼Œä»è€Œå»¶é•¿SSDçš„ä½¿ç”¨å¯¿å‘½ $ sudo systemctl enable fstrim.timer $ sudo systemctl start fstrim.timer ","date":"2024-04-17","objectID":"/posts/arch-linux/:4:1","tags":["Arch","Linux","Software"],"title":"Arch Linux æŒ‡å—","uri":"/posts/arch-linux/"},{"categories":["Linux","Software"],"content":"SWAP è®¾ç½® https://wiki.archlinux.org/title/Swap#Swappiness æŸ¥çœ‹ swap ä½¿ç”¨ç‡ï¼Œä¸€èˆ¬æ˜¯ 60 ï¼Œæ„æ€æ˜¯ 60% çš„æ¦‚ç‡å°†å†…å­˜æ•´ç†åˆ° swap: cat /proc/sys/vm/swappiness ä¿®æ”¹ swap ä½¿ç”¨ç­–ç•¥ä¸º 10%ï¼Œå³ 10% çš„æ¦‚ç‡å°†å†…å­˜æ•´ç†åˆ° swap: sudo sysctl -w vm.swappiness=10 ä¿®æ”¹é…ç½®æ–‡ä»¶ï¼šsudo vim /etc/sysctl.d/99-swappiness.conf åœ¨æ–‡ä»¶æœ«å°¾åŠ ä¸Šä¸‹é¢è¿™è¡Œå†…å®¹ï¼švm.swappiness=10 é‡å¯åå¯æŸ¥çœ‹ swappiness çš„å€¼ ","date":"2024-04-17","objectID":"/posts/arch-linux/:4:2","tags":["Arch","Linux","Software"],"title":"Arch Linux æŒ‡å—","uri":"/posts/arch-linux/"},{"categories":["Linux","Software"],"content":"Systemd journal size limit æ§åˆ¶æ—¥å¿—æœ€å¤§å¯ä½¿ç”¨å¤šå°‘ç£ç›˜ç©ºé—´ï¼Œä¿®æ”¹/etc/systemd/journald.conf ä¸­çš„SystemMaxUseå‚æ•° SystemMaxUse=50M ","date":"2024-04-17","objectID":"/posts/arch-linux/:4:3","tags":["Arch","Linux","Software"],"title":"Arch Linux æŒ‡å—","uri":"/posts/arch-linux/"},{"categories":["Linux","Software"],"content":"V. Problem And Solution ","date":"2024-04-17","objectID":"/posts/arch-linux/:5:0","tags":["Arch","Linux","Software"],"title":"Arch Linux æŒ‡å—","uri":"/posts/arch-linux/"},{"categories":["Linux","Software"],"content":"1. clear command - terminals database is inaccessible è§£å†³æ–¹æ¡ˆï¼š Path for Anaconda3 is set in .bashrc. It is interfering with the clear command. Removing Anaconda path from path solved the issue. $ echo $CONDA_PREFIX /opt/miniconda $sudo mv $CONDA_PREFIX/bin/clear $CONDA_PREFIX/bin/clear_old ","date":"2024-04-17","objectID":"/posts/arch-linux/:5:1","tags":["Arch","Linux","Software"],"title":"Arch Linux æŒ‡å—","uri":"/posts/arch-linux/"},{"categories":["Linux","Software"],"content":"2. tput: unknown terminal \"xterm-256color\" è§£å†³æ–¹æ¡ˆï¼š $ setenv TERMINFO /usr/lib/terminfo ","date":"2024-04-17","objectID":"/posts/arch-linux/:5:2","tags":["Arch","Linux","Software"],"title":"Arch Linux æŒ‡å—","uri":"/posts/arch-linux/"},{"categories":["Linux","Software"],"content":"3. æ›´æ–°å†…æ ¸åï¼ŒåŒå±æ˜¾ç¤ºæ—¶ï¼ŒæŸä¸€ä¸ªå±å¹•é»‘å±ï¼Œä½†é¼ æ ‡èƒ½å¤Ÿç§»åŠ¨è¿‡å»å¹¶æ˜¾ç¤ºï¼Œå¦ä¸€å±å¹•æ­£å¸¸ è§£å†³æ–¹æ¡ˆï¼š xrandr --output HDMI-1-0 --right-of eDP1 --auto å‘½ä»¤è§£é‡Šï¼šé…ç½® HDMI-1-0 è¾“å‡ºï¼Œä½¿å…¶ä½äº eDP1 è¾“å‡ºçš„å³ä¾§ï¼Œå¹¶è‡ªåŠ¨é€‰æ‹©æœ€ä½³çš„åˆ†è¾¨ç‡å’Œåˆ·æ–°ç‡è®¾ç½® $ xrandr --listmonitors Monitors: 2 0: +*eDP1 2560/360x1440/200+0+0 eDP1 1: +HDMI-1-0 1920/479x1080/260+2560+0 HDMI-1-0 $ xrandr --output HDMI-1-0 --right-of eDP1 --auto ","date":"2024-04-17","objectID":"/posts/arch-linux/:5:3","tags":["Arch","Linux","Software"],"title":"Arch Linux æŒ‡å—","uri":"/posts/arch-linux/"},{"categories":["Linux","Software"],"content":"4. zip å‹ç¼©åŒ…è§£å‹ä¹±ç  äº§ç”Ÿè¿™ç§æƒ…å†µçš„åŸå› æ˜¯ï¼Œzip æ ¼å¼æœ¬èº«çš„ç¼ºé™·å¯¼è‡´çš„ï¼š zip æ ¼å¼æ²¡æœ‰æŒ‡å®šæ–‡ä»¶åçš„ç¼–ç æ ¼å¼ï¼Œå› æ­¤åœ¨å‹ç¼©å’Œè§£å‹æ—¶éƒ½ä¼šé‡‡ç”¨æ“ä½œç³»ç»Ÿæœ¬åœ°ç¼–ç ï¼Œ Windows ä¸‹ç®€ä½“ä¸­æ–‡é‡‡ç”¨çš„æ˜¯ GBK/GB312 ç¼–ç ï¼Œè€Œ Linux é‡‡ç”¨çš„æ˜¯ UTF-8 ç¼–ç ï¼Œä¸¤è€…ä¸ä¸€è‡´å¯¼è‡´äº†ä¹±ç çš„äº§ç”Ÿã€‚ è§£å†³æ–¹æ¡ˆ: $ unzip -O GBK xxx.zip ","date":"2024-04-17","objectID":"/posts/arch-linux/:5:4","tags":["Arch","Linux","Software"],"title":"Arch Linux æŒ‡å—","uri":"/posts/arch-linux/"},{"categories":["Linux","Software"],"content":"5. wps-officeå¤§éƒ¨åˆ†å­—ä½“ç²—ä½“å‡ºç°è¿‡ç²—æ— æ³•æ­£å¸¸æ˜¾ç¤ºé—®é¢˜ é—®é¢˜: freetype2 æ›´æ–°è‡³ 2.13.0 ä»¥ä¸Šç‰ˆæœ¬åå‡ºç°çš„é—®é¢˜ï¼Œå¯¼è‡´ wps-office æ–‡æ¡£ç¼–è¾‘æ–‡å­—å¤§éƒ¨åˆ†å­—ä½“è®¾ç½®ç²—ä½“å‡ºç°è¿‡ç²—æ— æ³•æ­£å¸¸æ˜¾ç¤ºã€‚ è§£å†³æ–¹æ¡ˆï¼š freetype2 é™çº§è‡³ 2.13.0 Download freetype2.13.0 é™çº§ sudo pacman -U freetype2-2.13.0-1-x86_64.pkg.tar.zst ä¿®æ”¹ /etc/pacman.conf -\u003e IgnorePkg = freetype2ï¼Œæ’é™¤æ‰è¿™ä¸ªåŒ…ï¼ˆä¸è®©å®ƒæ›´æ–°ï¼‰ freetype2: ignoring package upgrade (2.13.0-1 =\u003e 2.13.2-1) $ env LD_LIBRARY_PATH=/usr/local/freetype2-2.13.0-1-x86_64/usr/lib $ update-desktop-database ~/.local/share/applications ","date":"2024-04-17","objectID":"/posts/arch-linux/:5:5","tags":["Arch","Linux","Software"],"title":"Arch Linux æŒ‡å—","uri":"/posts/arch-linux/"},{"categories":["Linux","Software"],"content":"6. wpspdf æ— æ³•æ‰“å¼€ PDF æ–‡ä»¶ wpspdf ä¾èµ–äº libtiff5.so.5 ä»¥æ”¯æ’‘å…¶ PDF åŠŸèƒ½ã€‚ è€Œç³»ç»Ÿæ›´æ–°åï¼ŒArch Linux æä¾›çš„æ˜¯ libtiff.so.6 æˆ–æ›´æ–°ç‰ˆæœ¬ï¼Œå¯¼è‡´å…¶æ— æ³•æ­£å¸¸å·¥ä½œã€‚ è§£å†³æ–¹æ¡ˆï¼š å®‰è£… libtiff5 ","date":"2024-04-17","objectID":"/posts/arch-linux/:5:6","tags":["Arch","Linux","Software"],"title":"Arch Linux æŒ‡å—","uri":"/posts/arch-linux/"},{"categories":["Linux","Software"],"content":"7. WPS æ— æ³•è¾“å…¥ä¸­æ–‡ è§£å†³æ–¹æ¡ˆ - wpp wpspdf wpp et ","date":"2024-04-17","objectID":"/posts/arch-linux/:5:7","tags":["Arch","Linux","Software"],"title":"Arch Linux æŒ‡å—","uri":"/posts/arch-linux/"},{"categories":["Linux","Software"],"content":"8. lx-music æ•°æ®åŒæ­¥å¤±è´¥ è§£å†³æ–¹æ¡ˆ ç¡®ä¿PCç«¯çš„åŒæ­¥æœåŠ¡å·²å¯ç”¨æˆåŠŸ: è‹¥è¿æ¥ç ã€åŒæ­¥æœåŠ¡åœ°å€æ²¡æœ‰å†…å®¹ï¼Œåˆ™è¯æ˜æœåŠ¡å¯åŠ¨å¤±è´¥ï¼Œæ­¤æ—¶çœ‹å¯ç”¨åŒæ­¥åŠŸèƒ½å¤é€‰æ¡†åé¢çš„é”™è¯¯ä¿¡æ¯è‡ªè¡Œè§£å†³ åœ¨æ‰‹æœºæµè§ˆå™¨åœ°å€æ è¾“å…¥http://x.x.x.x:5963/helloåå›è½¦ï¼Œè‹¥æ­¤åœ°å€å¯ä»¥æ‰“å¼€å¹¶æ˜¾ç¤º Hello~::^-^::v4ï¼Œåˆ™è¯æ˜ç§»åŠ¨ç«¯ä¸PCç«¯ç½‘ç»œå·²äº’é€šï¼Œ è‹¥ç§»åŠ¨ç«¯æ— æ³•æ‰“å¼€ç¬¬2æ­¥çš„åœ°å€ï¼Œåˆ™åœ¨PCç«¯çš„æµè§ˆå™¨åœ°å€æ è¾“å…¥å¹¶æ‰“å¼€è¯¥åœ°å€ï¼Œè‹¥å¯ä»¥æ‰“å¼€ï¼Œåˆ™å¯èƒ½æ€§å¦‚ä¸‹ï¼š LX Music PCç«¯è¢«ç”µè„‘é˜²ç«å¢™æ‹¦æˆª PCç«¯ä¸ç§»åŠ¨ç«¯ä¸åœ¨åŒä¸€ä¸ªç½‘ç»œä¸‹ï¼Œ è·¯ç”±å™¨å¼€å¯äº†APéš”ç¦»ï¼ˆä¸€èˆ¬åœ¨å…¬å…±ç½‘ç»œä¸‹ä¼šå‡ºç°è¿™ç§æƒ…å†µï¼‰ è¦éªŒè¯åŒæ–¹æ˜¯å¦åœ¨åŒä¸€ä¸ªç½‘ç»œæˆ–æ˜¯å¦å¼€å¯APéš”ç¦»ï¼Œå¯ä»¥åœ¨ç”µè„‘æ‰“å¼€cmdä½¿ç”¨pingå‘½ä»¤pingç§»åŠ¨ç«¯æ˜¾ç¤ºçš„ipåœ°å€ï¼Œè‹¥å¯ä»¥é€šåˆ™è¯´æ˜ç½‘ç»œæ­£å¸¸ ","date":"2024-04-17","objectID":"/posts/arch-linux/:5:8","tags":["Arch","Linux","Software"],"title":"Arch Linux æŒ‡å—","uri":"/posts/arch-linux/"},{"categories":["Github Pages","Hugo","åšå®¢","Linux"],"content":" å¯¼è¯­ å€ŸåŠ©äº Github Pages æä¾›çš„é™æ€ç½‘ç«™æ‰˜ç®¡æœåŠ¡ï¼Œå¹¶é‡‡ç”¨äº† Hugo è¿™ä¸€å¼€æºé¡¹ç›®ï¼ŒåŠ å¿«äº†å»ºç«™æµç¨‹ï¼Œè€Œä¸”æœ‰å¤šç§å¼€æºç½‘ç«™ä¸»é¢˜å¯ä¾›é€‰æ‹©. ","date":"2024-04-17","objectID":"/posts/build-blog/:0:0","tags":["Github Pages","Hugo","åšå®¢","Linux"],"title":"å»ºç«™æŒ‡å—(GitHub Pages + Hugo)","uri":"/posts/build-blog/"},{"categories":["Github Pages","Hugo","åšå®¢","Linux"],"content":"I. å‰è¨€ åœ¨åšå®¢ç½‘ç«™æ­å»ºå®Œæˆä¹‹åï¼Œæœ‰å……åˆ†çš„ç†ç”±ç›¸ä¿¡ï¼Œè‡ªå·±åœ¨æœªæ¥å¾ˆé•¿ä¸€æ®µæ—¶é—´å†…å°†ä¸ä¼šå†æ¬¡é‡å¤å»ºç«™ã€‚ å¸¸è¨€é“å¤©æœ‰ä¸æµ‹é£äº‘ï¼Œä¸ºäº†é˜²æ­¢å„ç§æ„å¤–æƒ…å†µå‘ç”Ÿï¼Œå¯¼è‡´æœ¬åšå®¢ç½‘ç«™æ— æ³•æ­£å¸¸ä½¿ç”¨ï¼ŒåŒæ—¶é˜²æ­¢è‡ªå·±å¿˜è®°æ­å»ºæµç¨‹ï¼Œè®°å½•äºæ­¤ã€‚ ","date":"2024-04-17","objectID":"/posts/build-blog/:1:0","tags":["Github Pages","Hugo","åšå®¢","Linux"],"title":"å»ºç«™æŒ‡å—(GitHub Pages + Hugo)","uri":"/posts/build-blog/"},{"categories":["Github Pages","Hugo","åšå®¢","Linux"],"content":"II. æ•ˆæœ ","date":"2024-04-17","objectID":"/posts/build-blog/:2:0","tags":["Github Pages","Hugo","åšå®¢","Linux"],"title":"å»ºç«™æŒ‡å—(GitHub Pages + Hugo)","uri":"/posts/build-blog/"},{"categories":["Github Pages","Hugo","åšå®¢","Linux"],"content":"III. ç›¸å…³çŸ¥è¯†ç®€ä»‹ ","date":"2024-04-17","objectID":"/posts/build-blog/:3:0","tags":["Github Pages","Hugo","åšå®¢","Linux"],"title":"å»ºç«™æŒ‡å—(GitHub Pages + Hugo)","uri":"/posts/build-blog/"},{"categories":["Github Pages","Hugo","åšå®¢","Linux"],"content":"Github Pages GitHub Pages æ˜¯ä¸€ä¸ªå…è´¹çš„é™æ€ç½‘ç«™æ‰˜ç®¡æœåŠ¡ï¼Œå®ƒå…è®¸ç”¨æˆ·é€šè¿‡ GitHub å­˜å‚¨åº“æ¥æ‰˜ç®¡å’Œå‘å¸ƒç½‘é¡µï¼Œå¯ä»¥ä½¿ç”¨å®ƒæ¥å±•ç¤ºé¡¹ç›®æ–‡æ¡£ã€åšå®¢æˆ–ä¸ªäººç®€å†ã€‚ ç°é˜¶æ®µï¼ŒGithub Pages æ”¯æŒå…¬å…±å­˜å‚¨åº“çš„å…è´¹çš„æ‰˜ç®¡ï¼›å¯¹äºç§æœ‰ä»“åº“ï¼Œéœ€è¦è¿›è¡Œç¼´è´¹ã€‚ ","date":"2024-04-17","objectID":"/posts/build-blog/:3:1","tags":["Github Pages","Hugo","åšå®¢","Linux"],"title":"å»ºç«™æŒ‡å—(GitHub Pages + Hugo)","uri":"/posts/build-blog/"},{"categories":["Github Pages","Hugo","åšå®¢","Linux"],"content":"Hugo å®˜æ–¹å·ç§°ï¼ŒHugo æ˜¯ä¸–ç•Œä¸Šæœ€å¿«çš„ç½‘ç«™å»ºè®¾æ¡†æ¶(The worldâ€™s fastest framework for building websites)ã€‚ ","date":"2024-04-17","objectID":"/posts/build-blog/:3:2","tags":["Github Pages","Hugo","åšå®¢","Linux"],"title":"å»ºç«™æŒ‡å—(GitHub Pages + Hugo)","uri":"/posts/build-blog/"},{"categories":["Github Pages","Hugo","åšå®¢","Linux"],"content":"IV. Steps ","date":"2024-04-17","objectID":"/posts/build-blog/:4:0","tags":["Github Pages","Hugo","åšå®¢","Linux"],"title":"å»ºç«™æŒ‡å—(GitHub Pages + Hugo)","uri":"/posts/build-blog/"},{"categories":["Github Pages","Hugo","åšå®¢","Linux"],"content":"1. Github ä»“åº“åˆ›å»º éœ€è¦åˆ›å»ºä¸¤ä¸ªä»“åº“ï¼Œä¸€ä¸ªç”¨äºç½‘ç«™æºç ç®¡ç†(A)ï¼Œä¸€ä¸ªç”¨äºç½‘ç«™éƒ¨ç½²(B): A å¯ä»¥æ˜¯ publicï¼Œä¹Ÿå¯ä»¥æ˜¯ privateï¼› B ä»“åº“çš„åç§°å¿…é¡»æ˜¯ \u003cusername\u003e.github.ioï¼ˆusername æ˜¯ Github Accout ä¸­usernameï¼Œä¸æ˜¯ profile ä¸­çš„ Nameï¼‰ï¼ŒåŒæ—¶è¿˜éœ€è¦æ·»åŠ  README.mdï¼Œä¾‹å¦‚ï¼škydance.github.io. ","date":"2024-04-17","objectID":"/posts/build-blog/:4:1","tags":["Github Pages","Hugo","åšå®¢","Linux"],"title":"å»ºç«™æŒ‡å—(GitHub Pages + Hugo)","uri":"/posts/build-blog/"},{"categories":["Github Pages","Hugo","åšå®¢","Linux"],"content":"2. ä½¿ç”¨ Hugo åˆ›å»ºç½‘ç«™ é¦–å…ˆï¼Œä½¿ç”¨ Git å°† A æ‹‰å–ä¸‹æ¥: $ git clone git@github.com:kydance/blog.git ç„¶åï¼Œè¿›å…¥æœ¬åœ°çš„ A ç›®å½•ï¼ˆå³ï¼Œblogï¼‰ä¸‹ï¼Œä½¿ç”¨ hugo å»ºç«™ï¼š # Linux: Install Hugo $ sudo pacman -S hugo # Verify $ hugo version # å»ºç«™ï¼Œç„¶åå°†ç”Ÿæˆçš„å†…å®¹å¤åˆ¶åˆ° `A` ä»“åº“ä¸­ $ hugo new blog $ mv blog/ . $ rm -rf blog ","date":"2024-04-17","objectID":"/posts/build-blog/:4:2","tags":["Github Pages","Hugo","åšå®¢","Linux"],"title":"å»ºç«™æŒ‡å—(GitHub Pages + Hugo)","uri":"/posts/build-blog/"},{"categories":["Github Pages","Hugo","åšå®¢","Linux"],"content":"3. Hugo è®¾ç½®ç½‘ç«™ä¸»é¢˜ å¯ä»¥ä» Hugo Themes æŒ‘é€‰åˆé€‚çš„ä¸»é¢˜è¿›è¡Œåº”ç”¨ï¼š $ cd themes $ git clone https://github.com/kakawait/hugo-tranquilpeak-theme.git tranquilpeak å®‰è£… Hugo ä¸»é¢˜åï¼Œæ ¹æ®ä¸ªäººæƒ…å†µä¿®æ”¹ç›¸åº”çš„é…ç½®æ–‡ä»¶å³å¯ï¼› ","date":"2024-04-17","objectID":"/posts/build-blog/:4:3","tags":["Github Pages","Hugo","åšå®¢","Linux"],"title":"å»ºç«™æŒ‡å—(GitHub Pages + Hugo)","uri":"/posts/build-blog/"},{"categories":["Github Pages","Hugo","åšå®¢","Linux"],"content":"4. æ–‡ç« ç®¡ç† å¯åŠ¨ Hugo server å¯åŠ¨æœ¬åœ° serverï¼š $ hugo server -D æµè§ˆå™¨æ‰“å¼€ http://localhost:1313/ è¿›è¡Œé¢„è§ˆï¼› æ–°å»ºæ–‡ç«  # `post/Golang/Go.md` è¡¨æ˜ markdown çš„è·¯å¾„ $ hugo new content `post/Golang/Go.md` ä¸€é”®åˆ›å»ºæ–‡ç« : ./new-blog.sh \u003cname\u003e #!/bin/bash CONTENT_PATH=posts/ # Welcome to the new-blog.sh script! echo -e \"\\033[0;32mCreating new blog post...\\033[0m\" # Check if the user has provided an argument if [ $# -ne 1 ] then echo -e \"\\033[0;31mMissing one argument, Usage: new-blog.sh \u003cblog-name\u003e\\033[0m\"; exit; fi # Get the blog name from the user CONTENT_PATH=$CONTENT_PATH$1/$1.md echo -e \"\\033[0;32mBlog path: $CONTENT_PATH\\033[0m\" # Create the new blog post hugo new content $CONTENT_PATH # Success echo -e \"\\033[0;32mCreate new blog post $CONTENT_PATH successful.\\033[0m\" éƒ¨ç½²æ–‡ç«  æ„å»º Hugo ç½‘ç«™ç›¸å…³é™æ€æ–‡ä»¶ Hugo å°†æ„å»ºå®Œæˆçš„é™æ€å†…å®¹ä¿å­˜åˆ° A ä»“åº“ä¸­çš„ public æ–‡ä»¶å¤¹ä¸­ï¼› $ hugo éƒ¨ç½² è¿›å…¥ public ç›®å½•ï¼Œåˆ©ç”¨ Git è¿›è¡Œç®¡ç†è¯¥æ–‡ä»¶å¤¹ï¼Œå¹¶æ¨é€åˆ°è¿œç¨‹ B ä»“åº“ä¸­ï¼š $ git init $ git commit -m \"first commit\" $ git branch -M master $ git remote add origin https://github.com/kydance/kydance.github.io.git $ git push -u origin master è‡ªåŠ¨åŒ–ä¸€é”®éƒ¨ç½²ï¼šdeploy.sh #!/bin/bash echo -e \"\\033[0;32mDeploying updates to GitHub...\\033[0m\" # Build the project. hugo # if using a theme, replace with hugo -t # Go To Public folder cd public # Add changes to git. git add . # Commit changes. msg=\"rebuilding site `date` \" echo -e \"\\033[0;32m$msg\\033[0m\" if [ $# -eq 1 ] then msg=\"$1\" fi git commit -m \"$msg\" # Push source and build repos. git push origin master # Come Back up to the Project Root cd .. åˆ é™¤æ–‡ç«  è¿›å…¥ blog/posts/ ç›®å½•ä¸­ï¼Œåˆ é™¤ï¼Œç›®æ ‡æ–‡ä»¶å¤¹ï¼ˆåŒ…å«ç›¸å…³æ–‡ç« èµ„æºï¼‰å³å¯ï¼› NOTEï¼šblog/public ä¸­ç›¸å…³æ–‡ä»¶å¯ä»¥åˆ é™¤ï¼Œä¹Ÿå¯ä»¥ä¸åˆ é™¤ï¼Œæ¨èåˆ é™¤ï¼› ","date":"2024-04-17","objectID":"/posts/build-blog/:4:4","tags":["Github Pages","Hugo","åšå®¢","Linux"],"title":"å»ºç«™æŒ‡å—(GitHub Pages + Hugo)","uri":"/posts/build-blog/"},{"categories":["Github Pages","Hugo","åšå®¢","Linux"],"content":"5. ç½‘ç«™å›¾æ ‡ æŠŠ: apple-touch-icon.png (180x180) favicon-32x32.png (32x32) favicon-16x16.png (16x16) mstile-150x150.png (150x150) android-chrome-192x192.png (192x192) android-chrome-512x512.png (512x512) æ”¾åœ¨ /static ç›®å½•. åˆ©ç”¨ realfavicongenerator å¯ä»¥å¾ˆå®¹æ˜“åœ°ç”Ÿæˆè¿™äº›æ–‡ä»¶. å¯ä»¥è‡ªå®šä¹‰ browserconfig.xml å’Œ site.webmanifest æ–‡ä»¶æ¥è®¾ç½® theme-color å’Œ background-color. avatarå¤´åƒ åœ¨ gavatar ç½‘ç«™æ³¨å†Œå¹¶ä¸Šä¼ å›¾ç‰‡å³å¯ ","date":"2024-04-17","objectID":"/posts/build-blog/:4:5","tags":["Github Pages","Hugo","åšå®¢","Linux"],"title":"å»ºç«™æŒ‡å—(GitHub Pages + Hugo)","uri":"/posts/build-blog/"},{"categories":["Github Pages","Hugo","åšå®¢","Linux"],"content":"6. Google Analytics é¦–å…ˆï¼Œåœ¨ Google Analytics ç½‘ç«™ä¸­æ³¨å†Œã€è®¾ç½®å®Œæˆç›¸åº”é€‰é¡¹ï¼Œå³å¯è·å– IDï¼šG-XXXXXXXXXXï¼› ç„¶ååœ¨ layout/_default/baseof.html æ–‡ä»¶ä¸­æ·»åŠ ä»¥ä¸‹ä»£ç å³å¯ï¼š \u003c!-- Google tag (gtag.js) --\u003e \u003cscript async src=\"https://www.googletagmanager.com/gtag/js?id=G-XXXXXXXXXX\"\u003e\u003c/script\u003e \u003cscript\u003e window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'G-XXXXXXXXXX'); \u003c/script\u003e è¯¥æ®µä»£ç è·å–æ–¹æ³•å¦‚ä¸‹ï¼š Google Analytics -\u003e ç®¡ç† -\u003e â€œåª’ä½“èµ„æºè®¾ç½®\"åˆ—ä¸­çš„æ•°æ®æµ -\u003e ç½‘ç«™ -\u003e å¯¹åº”çš„æ•°æ®æµ -\u003e â€œGoogle ä»£ç â€ ä¸‹çš„æŸ¥çœ‹ä»£ç è¯´æ˜ -\u003e â€œå®‰è£…è¯´æ˜â€ é€‰æ‹©æ‰‹åŠ¨æ·»åŠ . å»ºè®®æ·»åŠ å®Œæˆåï¼Œåœ¨ Google Analytics åˆ†æä¸­è¿›è¡Œæµ‹è¯•ï¼Œç¡®ä¿ç”Ÿæ•ˆ ","date":"2024-04-17","objectID":"/posts/build-blog/:4:6","tags":["Github Pages","Hugo","åšå®¢","Linux"],"title":"å»ºç«™æŒ‡å—(GitHub Pages + Hugo)","uri":"/posts/build-blog/"},{"categories":["Github Pages","Hugo","åšå®¢","Linux"],"content":"7. Gitalk è¯„è®ºç³»ç»Ÿ Gitalk çš„è¯„è®ºé‡‡ç”¨çš„æ˜¯ PR/Issue çš„æ–¹å¼å­˜å‚¨è¯„è®ºï¼Œå› æ­¤ï¼Œä¸€èˆ¬éœ€è¦æ–°å»ºä¸€ä¸ªä¸“é—¨çš„ Repoï¼Œä¾‹å¦‚kydance/gitalk. GitHub ç”³è¯·æ³¨å†Œæ–°åº”ç”¨ï¼Œå¹¶å¡«å†™ä»¥ä¸‹ç›¸å…³å†…å®¹ï¼š Application name: éšæ„ Homepage URL: åŒ…å« http/https å‰ç¼€ï¼Œä¾‹å¦‚https://kydance.github.io Authorization callback URL: å’Œä¸Šé¢ Homepage URL ä¿æŒä¸€è‡´å°±è¡Œ æ³¨å†Œå®Œæˆåï¼Œæ‰‹åŠ¨ç”Ÿæˆ Client secrets(åªä¼šå‡ºç°ä¸€æ¬¡)ï¼ŒåŒæ—¶è·å¾— Client ID. æœ€åï¼Œåœ¨ä¸»é¢˜è®¾ç½®ä¸­å¡«å†™ç›¸åº”ä¿¡æ¯å³å¯ï¼Œä¾‹å¦‚ LoveIt ä¸­çš„ config.toml: [params.page.comment] enable = true [params.page.comment.gitalk] enable = true owner = \"lutianen\" repo = \"gitalk\" clientId = \"xxxxxxxxxxxxxxxxxxxx\" clientSecret = \"xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx\" ","date":"2024-04-17","objectID":"/posts/build-blog/:4:7","tags":["Github Pages","Hugo","åšå®¢","Linux"],"title":"å»ºç«™æŒ‡å—(GitHub Pages + Hugo)","uri":"/posts/build-blog/"},{"categories":["Github Pages","Hugo","åšå®¢","Linux"],"content":"8. ç½‘ç«™è¿è¡Œæ—¶é—´ç»Ÿè®¡ åœ¨ footer.html åŠ å…¥ä»¥ä¸‹å†…å®¹å³å¯ï¼š {{- /* runtime */ -}} \u003c/br\u003e\u003cscript\u003e function siteTime() { var seconds = 1000; var minutes = seconds * 60; var hours = minutes * 60; var days = hours * 24; var years = days * 365; var today = new Date(); var startYear = 2024; var startMonth = 4; var startDate = 18; var startHour = 12; var startMinute = 57; var startSecond = 2; var todayYear = today.getFullYear(); var todayMonth = today.getMonth() + 1; var todayDate = today.getDate(); var todayHour = today.getHours(); var todayMinute = today.getMinutes(); var todaySecond = today.getSeconds(); var t1 = Date.UTC(startYear, startMonth, startDate, startHour, startMinute, startSecond); var t2 = Date.UTC(todayYear, todayMonth, todayDate, todayHour, todayMinute, todaySecond); var diff = t2 - t1; var diffYears = Math.floor(diff / years); var diffDays = Math.floor((diff / days) - diffYears * 365); var diffHours = Math.floor((diff - (diffYears * 365 + diffDays) * days) / hours); var diffMinutes = Math.floor((diff - (diffYears * 365 + diffDays) * days - diffHours * hours) / minutes); var diffSeconds = Math.floor((diff - (diffYears * 365 + diffDays) * days - diffHours * hours - diffMinutes * minutes) / seconds); if (startYear == todayYear) { document.getElementById(\"sitetime\").innerHTML = \"å·²å®‰å…¨è¿è¡Œ \" + diffDays + \" å¤© \" + diffHours + \" å°æ—¶ \" + diffMinutes + \" åˆ†é’Ÿ \" + diffSeconds + \" ç§’\"; } else { document.getElementById(\"sitetime\").innerHTML = \"å·²å®‰å…¨è¿è¡Œ \" + diffYears + \" å¹´ \" + diffDays + \" å¤© \" + diffHours + \" å°æ—¶ \" + diffMinutes + \" åˆ†é’Ÿ \" + diffSeconds + \" ç§’\"; } } setInterval(siteTime, 1000); \u003c/script\u003e \u003cspan id=\"sitetime\"\u003eè½½å…¥è¿è¡Œæ—¶é—´...\u003c/span\u003e ","date":"2024-04-17","objectID":"/posts/build-blog/:4:8","tags":["Github Pages","Hugo","åšå®¢","Linux"],"title":"å»ºç«™æŒ‡å—(GitHub Pages + Hugo)","uri":"/posts/build-blog/"},{"categories":["Github Pages","Hugo","åšå®¢","Linux"],"content":"V. è§†é¢‘åµŒå…¥ ","date":"2024-04-17","objectID":"/posts/build-blog/:5:0","tags":["Github Pages","Hugo","åšå®¢","Linux"],"title":"å»ºç«™æŒ‡å—(GitHub Pages + Hugo)","uri":"/posts/build-blog/"},{"categories":["Github Pages","Hugo","åšå®¢","Linux"],"content":"VI. Problem And Solution ","date":"2024-04-17","objectID":"/posts/build-blog/:6:0","tags":["Github Pages","Hugo","åšå®¢","Linux"],"title":"å»ºç«™æŒ‡å—(GitHub Pages + Hugo)","uri":"/posts/build-blog/"},{"categories":["Github Pages","Hugo","åšå®¢","Linux"],"content":"æ·»åŠ å›¾ç‰‡ä¸æ˜¾ç¤º Hugo çš„é…ç½®æ–‡ä»¶å’Œæ–‡ç« ä¸­çš„å¼•ç”¨å›¾ç‰‡éƒ½æ˜¯ä»¥ static ä½œä¸ºæ ¹ç›®å½•ï¼Œå› æ­¤å›¾ç‰‡æ— æ³•æ˜¾ç¤ºçš„è§£å†³æ–¹æ¡ˆå¦‚ä¸‹ï¼š å°†å›¾ç‰‡æ”¾å…¥ static/img ç›®å½•ä¸‹ åœ¨æ–‡ç« ä¸­çš„å›¾ç‰‡å¼•ç”¨æ–¹å¼ä¸ºï¼š/img/xxx.png æ— æ³•é‡‡ç”¨ Typora ç­‰è½¯ä»¶è¿›è¡Œé¢„è§ˆï¼Œéœ€è¦åœ¨ç½‘é¡µä¸­è¿›è¡Œé¢„è§ˆ: http://localhost:1313/ ","date":"2024-04-17","objectID":"/posts/build-blog/:6:1","tags":["Github Pages","Hugo","åšå®¢","Linux"],"title":"å»ºç«™æŒ‡å—(GitHub Pages + Hugo)","uri":"/posts/build-blog/"},{"categories":["Github Pages","Hugo","åšå®¢","Linux"],"content":"æ–‡ç« ç¼©ç•¥ å¦‚æœæƒ³è¦æ–‡ç« åœ¨æŸä¸ªåœ°æ–¹ç¼©ç•¥ï¼Œåªéœ€è¦åœ¨è¯¥ä½ç½®åŠ å…¥ \u003c!--more--\u003e å³å¯ã€‚ ","date":"2024-04-17","objectID":"/posts/build-blog/:6:2","tags":["Github Pages","Hugo","åšå®¢","Linux"],"title":"å»ºç«™æŒ‡å—(GitHub Pages + Hugo)","uri":"/posts/build-blog/"},{"categories":["Github Pages","Hugo","åšå®¢","Linux"],"content":"VII. References Abot Github Pages Hugo Gitalk è¯„è®ºç³»ç»Ÿå®‰è£… å‚è€ƒæ–‡ç«  ","date":"2024-04-17","objectID":"/posts/build-blog/:7:0","tags":["Github Pages","Hugo","åšå®¢","Linux"],"title":"å»ºç«™æŒ‡å—(GitHub Pages + Hugo)","uri":"/posts/build-blog/"}]